<!DOCTYPE html><html>
<head>
<title>A Visual Representation for Editing Face Images</title>
<!--Generated on Mon Jul  1 18:52:39 2019 by LaTeXML (version 0.8.4) http://dlmf.nist.gov/LaTeXML/.-->

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="keywords" lang="en" content="face visual representation,  face editing,  face relighting,  makeup,  appearance editing,  transfer,  detail map">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">A Visual Representation for Editing Face Images</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jiajun Lu<sup id="id1" class="ltx_sup">1</sup>
</span><span class="ltx_author_notes"><span><sup id="id7.1" class="ltx_sup">1</sup>University of Illinois at Urbana Champaign, <sup id="id7.2" class="ltx_sup">2</sup>Adobe Research
<br class="ltx_break"><span id="id7.3" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span><sup id="id7.3.1" class="ltx_sup">1</sup>{jlu23, daf}@illinois.edu</span></span></span>, <span id="id7.4" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span><sup id="id7.4.1" class="ltx_sup">2</sup>{sunkaval, ncarr, hadap}@adobe.com</span></span></span>
<br class="ltx_break"></span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Kalyan Sunkavalli<sup id="id2" class="ltx_sup">2</sup>
</span><span class="ltx_author_notes"><span><sup id="id8" class="ltx_sup">1</sup>University of Illinois at Urbana Champaign, <sup id="id9" class="ltx_sup">2</sup>Adobe Research
<br class="ltx_break"><span id="id10" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span><sup id="id10.2" class="ltx_sup">1</sup>{jlu23, daf}@illinois.edu</span></span></span>, <span id="id11" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span><sup id="id11.2" class="ltx_sup">2</sup>{sunkaval, ncarr, hadap}@adobe.com</span></span></span>
<br class="ltx_break"></span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Nathan Carr<sup id="id3" class="ltx_sup">2</sup>
</span><span class="ltx_author_notes"><span><sup id="id12" class="ltx_sup">1</sup>University of Illinois at Urbana Champaign, <sup id="id13" class="ltx_sup">2</sup>Adobe Research
<br class="ltx_break"><span id="id14" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span><sup id="id14.2" class="ltx_sup">1</sup>{jlu23, daf}@illinois.edu</span></span></span>, <span id="id15" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span><sup id="id15.2" class="ltx_sup">2</sup>{sunkaval, ncarr, hadap}@adobe.com</span></span></span>
<br class="ltx_break"></span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> Sunil Hadap<sup id="id4" class="ltx_sup">2</sup>
</span><span class="ltx_author_notes"><span><sup id="id16" class="ltx_sup">1</sup>University of Illinois at Urbana Champaign, <sup id="id17" class="ltx_sup">2</sup>Adobe Research
<br class="ltx_break"><span id="id18" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span><sup id="id18.2" class="ltx_sup">1</sup>{jlu23, daf}@illinois.edu</span></span></span>, <span id="id19" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span><sup id="id19.2" class="ltx_sup">2</sup>{sunkaval, ncarr, hadap}@adobe.com</span></span></span>
<br class="ltx_break"></span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"> David Forsyth<sup id="id5" class="ltx_sup">1</sup>
</span><span class="ltx_author_notes"><span><sup id="id20" class="ltx_sup">1</sup>University of Illinois at Urbana Champaign, <sup id="id21" class="ltx_sup">2</sup>Adobe Research
<br class="ltx_break"><span id="id22" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span><sup id="id22.2" class="ltx_sup">1</sup>{jlu23, daf}@illinois.edu</span></span></span>, <span id="id23" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span><sup id="id23.2" class="ltx_sup">2</sup>{sunkaval, ncarr, hadap}@adobe.com</span></span></span>
<br class="ltx_break"></span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id6" class="ltx_p">We propose a new approach for editing face images, which enables numerous exciting applications
including face relighting, makeup transfer and face detail editing. Our face edits are based on a
visual representation, which includes geometry, face segmentation, albedo, illumination and detail map.
To recover our visual representation, we start by estimating geometry using a morphable face model,
then decompose the face image to recover the albedo, and then shade the geometry with the albedo and
illumination. The residual between our shaded geometry and the input image produces our detail map,
which carries high frequency information that is either insufficiently or incorrectly captured by
our shading process. By manipulating the detail map, we can edit face images with
reality and identity preserved. Our representation allows various applications. First, it allows a user to
directly manipulate various illumination. Second, it allows non-parametric makeup transfer
with input face’s distinctive identity features preserved. Third, it allows non-parametric modifications to the
face appearance by transferring details. For face relighting and detail editing, we evaluate via a user
study and our method outperforms other methods. For makeup transfer, we evaluate via an online attractiveness evaluation
system, and can reliably make people look younger and more attractive. We also show extensive
qualitative comparisons to existing methods, and have significant improvements over previous techniques.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords:</h6>face visual representation, face editing, face relighting, makeup, appearance editing, transfer, detail map
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Post-capture editing of lighting, makeup and face appearance is an important component of photographic retouching, visual effects, and image compositing. However, it is a very
challenging problem because realistic editing usually requires precise estimates of scene geometry, material properties, and lighting. This is especially true for faces where even
small artifacts lead to perceptually implausible results.
</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering" width="634" height="162" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Our paper proposes a visual representation to automatically relight a single face image with face details preserved (A), edit face detail by transferring detail maps from a
different subject (B,C), and transfer face makeup from a reference (lower right inset) image to an input (lower left inset) image (D,E).
Our method keeps the image’s realism during all three operations, and preserves the input face’s identity (detail around nose, eyes and mouth) while transferring makeup. <span id="S1.F1.2" class="ltx_text ltx_font_italic">Best viewed at high resolution, in color.</span> </figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Our representation exposes natural “hooks” for image editing. We align a morphable face model to the face in an image, then
recover albedo and shading maps for the image, which are used in conjunction with the registered face model to estimate scene illumination.
We render the appearance of the face given the estimated geometry, lighting, and albedo using Lambertian shading.
However, current technology does not allow recovering a face geometry up to the scale of wrinkles, pores, etc. These small details are
important parts of what make a face individual (for exmaple, careful preservation of detail around eyes, nose and mouth ensures that changing
face makeup by editing albedo does not change the input’s identity). Thus we compute a detail map
containing image information not represented by recovered albedo, shading and geometry. The idea behind our method is that editing operations
enabled by such a detail map can be made reasonably robust against the accuracy of the models used to produce the detail map.
We demonstrate three types of face editing tasks: relighting, makeup transfer(we take
makeup from a reference and place it on an input) and detail editing (we change surface detail on a face), see Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">We evaluate our method by: qualitative evaluations of result images; qualitative comparisons to the results of existing methods;
quantitative results of a user study, where we compare the ability of persons to distinguish between edited faces and untouched images;
quantitative results of an online system to evaluate the effect of makeup on age and attractiveness.
These experiments show that our technique is able to produce results that have significant improvements over previous techniques in terms of perceptual realism.
For relighting and detail transfer, our results are hardest to distinguish. For makeup transfer, we can reasonably make people look younger and more attractive.</p>
</div>
<div id="S1.p4" class="ltx_para ltx_noindent">
<p id="S1.p4.1" class="ltx_p"><span id="S1.p4.1.1" class="ltx_text ltx_font_bold">Contributions:</span></p>
</div>
<div id="S1.p5" class="ltx_para">
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose an effective visual representation for face (with face detail maps related to face realism and face identity) that can realistically and reliably perform multiple tasks
automatically, including face relighting, makeup transfer and face detail editing. Previous methods are usually effective only on a single task.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Our model is the first model that allows interactive relighting of a whole single face image. We propose the first visual quality based quantitative
way to evaluate face relighting results, and our method produces state of the art face relighting results.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Our makeup transfer preserves the person’s identity and creates realistic results with various makeup images ( such as normal makeup, unusual makeup, etc),
which previous methods have problems dealing with. Even for normal makeup, we create state of the art results.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">Our model also enables us to edit face details to achieve various effects, such as making the person look younger or older, changing skin properties and fine-scale geometric
details. By grouping and choosing appropriate source images, we can control tons of editing operations to create desired images. Compared to previous method,
we support a larger variety of tasks, and perform as well or better.</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>

<div id="S2.p1" class="ltx_para ltx_noindent">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Face relighting:</span> Ratio image <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> is a standard method to relight face images.
Numerous variants are available to: improve performance under extreme lighting conditions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>; sew together local ratio estimates to resolve
difficulties created by small errors in registration <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>; relax the requirement that reference images are registered <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>;
allow expression transfer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>; relight temporal sequences, using a large database of reference images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">The requirement for two reference face images can be relaxed in ratio image methods. Wen et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> describe a method that replaces the reference face images with
reference spheres. Chen et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> describe a method that requires one reference face, in the target illumination.
Li et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> estimate low spatial frequency components using logarithmic total variation. Wang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> relight single images by recovering face geometry.
Each method is demonstrated only on masked faces. Chai et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> focus on accurate geometric reconstruction
of face and hair, which is used to relight portraits. In contrast to our method, there is no explicit detail map representation that captures rendering errors for the inferred model.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">For the methods described, evaluation is by qualitative comparison, and (for <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>) by quantitative studies of face recognition results (the
percentage recognition accuracy improved by relighting). In contrast, our quantitative evaluation tests whether people are fooled into thinking that relit faces are real images.</p>
</div>
<div id="S2.p4" class="ltx_para ltx_noindent">
<p id="S2.p4.1" class="ltx_p"><span id="S2.p4.1.1" class="ltx_text ltx_font_bold">Makeup transfer:</span> Analyzing and modifying images to improve perceived beauty is an active area (review in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>).
A variety of methods allow interactively applying makeup to the input face. By recovering and then editing multiple reflectance layers,
makeup can be successfully simulated <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. TAAZ allows users to apply chosen makeup components to face images
interactively (<a href="www.taaz.com" title="" class="ltx_ref">www.taaz.com</a>). In contrast, our method allows automatic transfer of makeup from reference to input image.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">Automated makeup transfer methods typically use 2D face models. Tong et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> transfer makeup using a ratio image.
Guo et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> transfer makeup by decomposing images into several layers, then blend layers and recomposite.
Their detail layer is obtained by image filtering. Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> register facial components independently, and synthesize made-up faces using database.
Liang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> enhance facial skin by suppressing a detail layer, estimated using image filtering.
Shih et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> adjust face image subband energies to match the makeup.
Scherbaum et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> suggest makeup for a 3D morphable face model based on a collection of 3D example morphable face models.
In contrast, our detail layer is obtained from rendering residual, and contains material and identity information; we only need 2D images and allow relighting;
we offer various makeup types and larger number of evaluation images.</p>
</div>
<div id="S2.p6" class="ltx_para ltx_noindent">
<p id="S2.p6.1" class="ltx_p"><span id="S2.p6.1.1" class="ltx_text ltx_font_bold">Appearance editing:</span> Face expression editing is possible using ratio images, and produces good results <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.
Bitouk et al. achieve expression and illumination transfer by replacing a face image with a similar image (with appropriate expression and illumination parameters) from an
enormous collection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Yang et al. warp local face components from other images to transfer expression <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>.
Kemelmacher-Shlizerman et al. combine models of illumination subspaces of faces at various ages <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.
In contrast, our editing is achieved by warping and applying detail maps.</p>
</div>
<div id="S2.p7" class="ltx_para ltx_noindent">
<p id="S2.p7.1" class="ltx_p"><span id="S2.p7.1.1" class="ltx_text ltx_font_bold">Detail maps:</span> Fine relief on surfaces creates small shadows that appear to be strong material cues to human viewers (eg. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>).
Representations of this detail can be used to slightly improve albedo estimates and material classifiers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.
Liao et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> demonstrated that residual map can help relight some objects, because convincing
material appearance is more important to human subjects than physical accurate shading fields.
Boyadzhiev et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> edit surface material (e.g. skin oilness or blemishes on faces) by adjusting selected image bands typically at high
spatial frequencies. In contrast, for relighting we preserve those bands and adjust low spatial frequencies; for makeup and detail transfer we use a
non-parametric model of those bands.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Recovering a Visual Representation</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We need to recover our visual representation of faces to build our various face editing pipelines.
Let <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="F" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1c">italic-F</annotation><annotation encoding="application/x-tex" id="S3.p1.1.m1.1d">F</annotation></semantics></math> define the aligned 3D face geometry, which allows us to build coherent face coordinates, and estimate face normals.
Let <math id="S3.p1.1.m2.1" class="ltx_Math" alttext="s(x)" display="inline"><semantics id="S3.p1.1.m2.1a"><mrow id="S3.p1.1.m2.1.5" xref="S3.p1.1.m2.1.5.cmml"><mi id="S3.p1.1.m2.1.1" xref="S3.p1.1.m2.1.1.cmml">s</mi><mo id="S3.p1.1.m2.1.5.1" xref="S3.p1.1.m2.1.5.1.cmml">⁢</mo><mrow id="S3.p1.1.m2.1.5.2" xref="S3.p1.1.m2.1.5.cmml"><mo stretchy="false" id="S3.p1.1.m2.1.2" xref="S3.p1.1.m2.1.5.cmml">(</mo><mi id="S3.p1.1.m2.1.3" xref="S3.p1.1.m2.1.3.cmml">x</mi><mo stretchy="false" id="S3.p1.1.m2.1.4" xref="S3.p1.1.m2.1.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m2.1b"><apply id="S3.p1.1.m2.1.5.cmml" xref="S3.p1.1.m2.1.5"><times id="S3.p1.1.m2.1.5.1.cmml" xref="S3.p1.1.m2.1.5.1"></times><ci id="S3.p1.1.m2.1.1.cmml" xref="S3.p1.1.m2.1.1">𝑠</ci><ci id="S3.p1.1.m2.1.3.cmml" xref="S3.p1.1.m2.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p1.1.m2.1c">italic-s OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p1.1.m2.1d">s(x)</annotation></semantics></math> and <math id="S3.p1.1.m3.1" class="ltx_Math" alttext="\rho(x)" display="inline"><semantics id="S3.p1.1.m3.1a"><mrow id="S3.p1.1.m3.1.5" xref="S3.p1.1.m3.1.5.cmml"><mi id="S3.p1.1.m3.1.1" xref="S3.p1.1.m3.1.1.cmml">ρ</mi><mo id="S3.p1.1.m3.1.5.1" xref="S3.p1.1.m3.1.5.1.cmml">⁢</mo><mrow id="S3.p1.1.m3.1.5.2" xref="S3.p1.1.m3.1.5.cmml"><mo stretchy="false" id="S3.p1.1.m3.1.2" xref="S3.p1.1.m3.1.5.cmml">(</mo><mi id="S3.p1.1.m3.1.3" xref="S3.p1.1.m3.1.3.cmml">x</mi><mo stretchy="false" id="S3.p1.1.m3.1.4" xref="S3.p1.1.m3.1.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m3.1b"><apply id="S3.p1.1.m3.1.5.cmml" xref="S3.p1.1.m3.1.5"><times id="S3.p1.1.m3.1.5.1.cmml" xref="S3.p1.1.m3.1.5.1"></times><ci id="S3.p1.1.m3.1.1.cmml" xref="S3.p1.1.m3.1.1">𝜌</ci><ci id="S3.p1.1.m3.1.3.cmml" xref="S3.p1.1.m3.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p1.1.m3.1c">italic-rho OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p1.1.m3.1d">\rho(x)</annotation></semantics></math> define image shading and albedo, which are recovered by some intrinsic image process.
Let <math id="S3.p1.1.m4.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.p1.1.m4.1a"><mi id="S3.p1.1.m4.1.1" xref="S3.p1.1.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m4.1b"><ci id="S3.p1.1.m4.1.1.cmml" xref="S3.p1.1.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p1.1.m4.1c">italic-theta</annotation><annotation encoding="application/x-tex" id="S3.p1.1.m4.1d">\theta</annotation></semantics></math> represent the image illumination, which can include luminares such as spherical lighting and point light source.
Finally, we define a detail map <math id="S3.p1.1.m5.1" class="ltx_Math" alttext="I_{d}(x)" display="inline"><semantics id="S3.p1.1.m5.1a"><mrow id="S3.p1.1.m5.1.6" xref="S3.p1.1.m5.1.6.cmml"><msub id="S3.p1.1.m5.1.6.2" xref="S3.p1.1.m5.1.6.2.cmml"><mi id="S3.p1.1.m5.1.1" xref="S3.p1.1.m5.1.1.cmml">I</mi><mi id="S3.p1.1.m5.1.2.1" xref="S3.p1.1.m5.1.2.1.cmml">d</mi></msub><mo id="S3.p1.1.m5.1.6.1" xref="S3.p1.1.m5.1.6.1.cmml">⁢</mo><mrow id="S3.p1.1.m5.1.6.3" xref="S3.p1.1.m5.1.6.cmml"><mo stretchy="false" id="S3.p1.1.m5.1.3" xref="S3.p1.1.m5.1.6.cmml">(</mo><mi id="S3.p1.1.m5.1.4" xref="S3.p1.1.m5.1.4.cmml">x</mi><mo stretchy="false" id="S3.p1.1.m5.1.5" xref="S3.p1.1.m5.1.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m5.1b"><apply id="S3.p1.1.m5.1.6.cmml" xref="S3.p1.1.m5.1.6"><times id="S3.p1.1.m5.1.6.1.cmml" xref="S3.p1.1.m5.1.6.1"></times><apply id="S3.p1.1.m5.1.6.2.cmml" xref="S3.p1.1.m5.1.6.2"><csymbol cd="ambiguous" id="S3.p1.1.m5.1.6.2.1.cmml" xref="S3.p1.1.m5.1.6.2">subscript</csymbol><ci id="S3.p1.1.m5.1.1.cmml" xref="S3.p1.1.m5.1.1">𝐼</ci><ci id="S3.p1.1.m5.1.2.1.cmml" xref="S3.p1.1.m5.1.2.1">𝑑</ci></apply><ci id="S3.p1.1.m5.1.4.cmml" xref="S3.p1.1.m5.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p1.1.m5.1c">italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p1.1.m5.1d">I_{d}(x)</annotation></semantics></math>, which carries identity and finer scale geometry.
We render a representation <math id="S3.p1.1.m6.1" class="ltx_Math" alttext="(\rho,F,\theta,I_{d})" display="inline"><semantics id="S3.p1.1.m6.1a"><mrow id="S3.p1.1.m6.1.11" xref="S3.p1.1.m6.1.11.1.cmml"><mo stretchy="false" id="S3.p1.1.m6.1.1" xref="S3.p1.1.m6.1.11.1.cmml">(</mo><mi id="S3.p1.1.m6.1.2" xref="S3.p1.1.m6.1.2.cmml">ρ</mi><mo id="S3.p1.1.m6.1.3" xref="S3.p1.1.m6.1.11.1.cmml">,</mo><mi id="S3.p1.1.m6.1.4" xref="S3.p1.1.m6.1.4.cmml">F</mi><mo id="S3.p1.1.m6.1.5" xref="S3.p1.1.m6.1.11.1.cmml">,</mo><mi id="S3.p1.1.m6.1.6" xref="S3.p1.1.m6.1.6.cmml">θ</mi><mo id="S3.p1.1.m6.1.7" xref="S3.p1.1.m6.1.11.1.cmml">,</mo><msub id="S3.p1.1.m6.1.11.2" xref="S3.p1.1.m6.1.11.2.cmml"><mi id="S3.p1.1.m6.1.8" xref="S3.p1.1.m6.1.8.cmml">I</mi><mi id="S3.p1.1.m6.1.9.1" xref="S3.p1.1.m6.1.9.1.cmml">d</mi></msub><mo stretchy="false" id="S3.p1.1.m6.1.10" xref="S3.p1.1.m6.1.11.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m6.1b"><vector id="S3.p1.1.m6.1.11.1.cmml" xref="S3.p1.1.m6.1.11"><ci id="S3.p1.1.m6.1.2.cmml" xref="S3.p1.1.m6.1.2">𝜌</ci><ci id="S3.p1.1.m6.1.4.cmml" xref="S3.p1.1.m6.1.4">𝐹</ci><ci id="S3.p1.1.m6.1.6.cmml" xref="S3.p1.1.m6.1.6">𝜃</ci><apply id="S3.p1.1.m6.1.11.2.cmml" xref="S3.p1.1.m6.1.11.2"><csymbol cd="ambiguous" id="S3.p1.1.m6.1.11.2.1.cmml" xref="S3.p1.1.m6.1.11.2">subscript</csymbol><ci id="S3.p1.1.m6.1.8.cmml" xref="S3.p1.1.m6.1.8">𝐼</ci><ci id="S3.p1.1.m6.1.9.1.cmml" xref="S3.p1.1.m6.1.9.1">𝑑</ci></apply></vector></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p1.1.m6.1c">OPEN:( italic-rho PUNCT:, italic-F PUNCT:, italic-theta PUNCT:, italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p1.1.m6.1d">(\rho,F,\theta,I_{d})</annotation></semantics></math> to produce a new image by the rule</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="I(x)=\mathrm{render}(\rho(x),F,\theta)+I_{d}(x)" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.28" xref="S3.E1.m1.1.28.cmml"><mrow id="S3.E1.m1.1.28.1" xref="S3.E1.m1.1.28.1.cmml"><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">I</mi><mo id="S3.E1.m1.1.28.1.1" xref="S3.E1.m1.1.28.1.1.cmml">⁢</mo><mrow id="S3.E1.m1.1.28.1.2" xref="S3.E1.m1.1.28.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.2" xref="S3.E1.m1.1.28.1.cmml">(</mo><mi id="S3.E1.m1.1.3" xref="S3.E1.m1.1.3.cmml">x</mi><mo stretchy="false" id="S3.E1.m1.1.4" xref="S3.E1.m1.1.28.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.5" xref="S3.E1.m1.1.5.cmml">=</mo><mrow id="S3.E1.m1.1.28.2" xref="S3.E1.m1.1.28.2.cmml"><mrow id="S3.E1.m1.1.28.2.1" xref="S3.E1.m1.1.28.2.1.cmml"><mi id="S3.E1.m1.1.11" xref="S3.E1.m1.1.11.cmml">render</mi><mo id="S3.E1.m1.1.28.2.1.1" xref="S3.E1.m1.1.28.2.1.1.cmml">⁢</mo><mrow id="S3.E1.m1.1.28.2.1.2" xref="S3.E1.m1.1.28.2.1.2.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.12" xref="S3.E1.m1.1.28.2.1.2.1.cmml">(</mo><mrow id="S3.E1.m1.1.28.2.1.2.2" xref="S3.E1.m1.1.28.2.1.2.2.cmml"><mi id="S3.E1.m1.1.13" xref="S3.E1.m1.1.13.cmml">ρ</mi><mo id="S3.E1.m1.1.28.2.1.2.2.1" xref="S3.E1.m1.1.28.2.1.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.1.28.2.1.2.2.2" xref="S3.E1.m1.1.28.2.1.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.14" xref="S3.E1.m1.1.28.2.1.2.2.cmml">(</mo><mi id="S3.E1.m1.1.15" xref="S3.E1.m1.1.15.cmml">x</mi><mo stretchy="false" id="S3.E1.m1.1.16" xref="S3.E1.m1.1.28.2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.17" xref="S3.E1.m1.1.28.2.1.2.1.cmml">,</mo><mi id="S3.E1.m1.1.18" xref="S3.E1.m1.1.18.cmml">F</mi><mo id="S3.E1.m1.1.19" xref="S3.E1.m1.1.28.2.1.2.1.cmml">,</mo><mi id="S3.E1.m1.1.20" xref="S3.E1.m1.1.20.cmml">θ</mi><mo stretchy="false" id="S3.E1.m1.1.21" xref="S3.E1.m1.1.28.2.1.2.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.1.22" xref="S3.E1.m1.1.22.cmml">+</mo><mrow id="S3.E1.m1.1.28.2.2" xref="S3.E1.m1.1.28.2.2.cmml"><msub id="S3.E1.m1.1.28.2.2.2" xref="S3.E1.m1.1.28.2.2.2.cmml"><mi id="S3.E1.m1.1.23" xref="S3.E1.m1.1.23.cmml">I</mi><mi id="S3.E1.m1.1.24.1" xref="S3.E1.m1.1.24.1.cmml">d</mi></msub><mo id="S3.E1.m1.1.28.2.2.1" xref="S3.E1.m1.1.28.2.2.1.cmml">⁢</mo><mrow id="S3.E1.m1.1.28.2.2.3" xref="S3.E1.m1.1.28.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.25" xref="S3.E1.m1.1.28.2.2.cmml">(</mo><mi id="S3.E1.m1.1.26" xref="S3.E1.m1.1.26.cmml">x</mi><mo stretchy="false" id="S3.E1.m1.1.27" xref="S3.E1.m1.1.28.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.28.cmml" xref="S3.E1.m1.1.28"><eq id="S3.E1.m1.1.5.cmml" xref="S3.E1.m1.1.5"></eq><apply id="S3.E1.m1.1.28.1.cmml" xref="S3.E1.m1.1.28.1"><times id="S3.E1.m1.1.28.1.1.cmml" xref="S3.E1.m1.1.28.1.1"></times><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝐼</ci><ci id="S3.E1.m1.1.3.cmml" xref="S3.E1.m1.1.3">𝑥</ci></apply><apply id="S3.E1.m1.1.28.2.cmml" xref="S3.E1.m1.1.28.2"><plus id="S3.E1.m1.1.22.cmml" xref="S3.E1.m1.1.22"></plus><apply id="S3.E1.m1.1.28.2.1.cmml" xref="S3.E1.m1.1.28.2.1"><times id="S3.E1.m1.1.28.2.1.1.cmml" xref="S3.E1.m1.1.28.2.1.1"></times><ci id="S3.E1.m1.1.11.cmml" xref="S3.E1.m1.1.11">render</ci><vector id="S3.E1.m1.1.28.2.1.2.1.cmml" xref="S3.E1.m1.1.28.2.1.2"><apply id="S3.E1.m1.1.28.2.1.2.2.cmml" xref="S3.E1.m1.1.28.2.1.2.2"><times id="S3.E1.m1.1.28.2.1.2.2.1.cmml" xref="S3.E1.m1.1.28.2.1.2.2.1"></times><ci id="S3.E1.m1.1.13.cmml" xref="S3.E1.m1.1.13">𝜌</ci><ci id="S3.E1.m1.1.15.cmml" xref="S3.E1.m1.1.15">𝑥</ci></apply><ci id="S3.E1.m1.1.18.cmml" xref="S3.E1.m1.1.18">𝐹</ci><ci id="S3.E1.m1.1.20.cmml" xref="S3.E1.m1.1.20">𝜃</ci></vector></apply><apply id="S3.E1.m1.1.28.2.2.cmml" xref="S3.E1.m1.1.28.2.2"><times id="S3.E1.m1.1.28.2.2.1.cmml" xref="S3.E1.m1.1.28.2.2.1"></times><apply id="S3.E1.m1.1.28.2.2.2.cmml" xref="S3.E1.m1.1.28.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.28.2.2.2.1.cmml" xref="S3.E1.m1.1.28.2.2.2">subscript</csymbol><ci id="S3.E1.m1.1.23.cmml" xref="S3.E1.m1.1.23">𝐼</ci><ci id="S3.E1.m1.1.24.1.cmml" xref="S3.E1.m1.1.24.1">𝑑</ci></apply><ci id="S3.E1.m1.1.26.cmml" xref="S3.E1.m1.1.26">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.E1.m1.1c">italic-I OPEN:( italic-x CLOSE:) RELOP:equals render OPEN:( italic-rho OPEN:( italic-x CLOSE:) PUNCT:, italic-F PUNCT:, italic-theta CLOSE:) ADDOP:plus italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.E1.m1.1d">I(x)=\mathrm{render}(\rho(x),F,\theta)+I_{d}(x)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr>
</table>
<p id="S3.p1.2" class="ltx_p">where <math id="S3.p1.2.m1.1" class="ltx_Math" alttext="\mathrm{render}()" display="inline"><semantics id="S3.p1.2.m1.1a"><mrow id="S3.p1.2.m1.1.9" xref="S3.p1.2.m1.1.9.cmml"><mi id="S3.p1.2.m1.1.6" xref="S3.p1.2.m1.1.6.cmml">render</mi><mo id="S3.p1.2.m1.1.9.1" xref="S3.p1.2.m1.1.9.1.cmml">⁢</mo><mrow id="S3.p1.2.m1.1.9.2" xref="S3.p1.2.m1.1.9.cmml"><mo stretchy="false" id="S3.p1.2.m1.1.7" xref="S3.p1.2.m1.1.9.2.1.cmml">(</mo><mo stretchy="false" id="S3.p1.2.m1.1.8" xref="S3.p1.2.m1.1.9.2.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m1.1b"><apply id="S3.p1.2.m1.1.9.cmml" xref="S3.p1.2.m1.1.9"><times id="S3.p1.2.m1.1.9.1.cmml" xref="S3.p1.2.m1.1.9.1"></times><ci id="S3.p1.2.m1.1.6.cmml" xref="S3.p1.2.m1.1.6">render</ci><list id="S3.p1.2.m1.1.9.2.1.cmml" xref="S3.p1.2.m1.1.7"></list></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p1.2.m1.1c">render OPEN:( CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p1.2.m1.1d">\mathrm{render}()</annotation></semantics></math> denotes any reasonable modern 3D rendering process.
Next, we will talk about recovering each component in detail, and example components can be found in makeup transfer pipeline in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2 Makeup Transfer ‣ 4 Face Editing ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.1" class="ltx_p"><span id="S3.p2.1.1" class="ltx_text ltx_font_bold">Face geometry:</span> We reconstruct the geometry of the face in the input image using a morphable face
model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> built from the FaceWarehouse data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>.
The model produces a 3D face mesh <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="{\bf F}(\omega_{i},\omega_{e})" display="inline"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.9" xref="S3.p2.1.m1.1.9.cmml"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">𝐅</mi><mo id="S3.p2.1.m1.1.9.1" xref="S3.p2.1.m1.1.9.1.cmml">⁢</mo><mrow id="S3.p2.1.m1.1.9.2" xref="S3.p2.1.m1.1.9.2.1.cmml"><mo stretchy="false" id="S3.p2.1.m1.1.2" xref="S3.p2.1.m1.1.9.2.1.cmml">(</mo><msub id="S3.p2.1.m1.1.9.2.2" xref="S3.p2.1.m1.1.9.2.2.cmml"><mi id="S3.p2.1.m1.1.3" xref="S3.p2.1.m1.1.3.cmml">ω</mi><mi id="S3.p2.1.m1.1.4.1" xref="S3.p2.1.m1.1.4.1.cmml">i</mi></msub><mo id="S3.p2.1.m1.1.5" xref="S3.p2.1.m1.1.9.2.1.cmml">,</mo><msub id="S3.p2.1.m1.1.9.2.3" xref="S3.p2.1.m1.1.9.2.3.cmml"><mi id="S3.p2.1.m1.1.6" xref="S3.p2.1.m1.1.6.cmml">ω</mi><mi id="S3.p2.1.m1.1.7.1" xref="S3.p2.1.m1.1.7.1.cmml">e</mi></msub><mo stretchy="false" id="S3.p2.1.m1.1.8" xref="S3.p2.1.m1.1.9.2.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.9.cmml" xref="S3.p2.1.m1.1.9"><times id="S3.p2.1.m1.1.9.1.cmml" xref="S3.p2.1.m1.1.9.1"></times><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝐅</ci><interval closure="open" id="S3.p2.1.m1.1.9.2.1.cmml" xref="S3.p2.1.m1.1.9.2"><apply id="S3.p2.1.m1.1.9.2.2.cmml" xref="S3.p2.1.m1.1.9.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.9.2.2.1.cmml" xref="S3.p2.1.m1.1.9.2.2">subscript</csymbol><ci id="S3.p2.1.m1.1.3.cmml" xref="S3.p2.1.m1.1.3">𝜔</ci><ci id="S3.p2.1.m1.1.4.1.cmml" xref="S3.p2.1.m1.1.4.1">𝑖</ci></apply><apply id="S3.p2.1.m1.1.9.2.3.cmml" xref="S3.p2.1.m1.1.9.2.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.9.2.3.1.cmml" xref="S3.p2.1.m1.1.9.2.3">subscript</csymbol><ci id="S3.p2.1.m1.1.6.cmml" xref="S3.p2.1.m1.1.6">𝜔</ci><ci id="S3.p2.1.m1.1.7.1.cmml" xref="S3.p2.1.m1.1.7.1">𝑒</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.1c">bold-F OPEN:( italic-omega POSTSUBSCRIPT:start italic-i POSTSUBSCRIPT:end PUNCT:, italic-omega POSTSUBSCRIPT:start italic-e POSTSUBSCRIPT:end CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p2.1.m1.1d">{\bf F}(\omega_{i},\omega_{e})</annotation></semantics></math> that is a function of identity parameters, <math id="S3.p2.1.m2.1" class="ltx_Math" alttext="\omega_{i}" display="inline"><semantics id="S3.p2.1.m2.1a"><msub id="S3.p2.1.m2.1.3" xref="S3.p2.1.m2.1.3.cmml"><mi id="S3.p2.1.m2.1.1" xref="S3.p2.1.m2.1.1.cmml">ω</mi><mi id="S3.p2.1.m2.1.2.1" xref="S3.p2.1.m2.1.2.1.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m2.1b"><apply id="S3.p2.1.m2.1.3.cmml" xref="S3.p2.1.m2.1.3"><csymbol cd="ambiguous" id="S3.p2.1.m2.1.3.1.cmml" xref="S3.p2.1.m2.1.3">subscript</csymbol><ci id="S3.p2.1.m2.1.1.cmml" xref="S3.p2.1.m2.1.1">𝜔</ci><ci id="S3.p2.1.m2.1.2.1.cmml" xref="S3.p2.1.m2.1.2.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p2.1.m2.1c">italic-omega POSTSUBSCRIPT:start italic-i POSTSUBSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S3.p2.1.m2.1d">\omega_{i}</annotation></semantics></math>, and
expression parameters, <math id="S3.p2.1.m3.1" class="ltx_Math" alttext="\omega_{e}" display="inline"><semantics id="S3.p2.1.m3.1a"><msub id="S3.p2.1.m3.1.3" xref="S3.p2.1.m3.1.3.cmml"><mi id="S3.p2.1.m3.1.1" xref="S3.p2.1.m3.1.1.cmml">ω</mi><mi id="S3.p2.1.m3.1.2.1" xref="S3.p2.1.m3.1.2.1.cmml">e</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m3.1b"><apply id="S3.p2.1.m3.1.3.cmml" xref="S3.p2.1.m3.1.3"><csymbol cd="ambiguous" id="S3.p2.1.m3.1.3.1.cmml" xref="S3.p2.1.m3.1.3">subscript</csymbol><ci id="S3.p2.1.m3.1.1.cmml" xref="S3.p2.1.m3.1.1">𝜔</ci><ci id="S3.p2.1.m3.1.2.1.cmml" xref="S3.p2.1.m3.1.2.1">𝑒</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p2.1.m3.1c">italic-omega POSTSUBSCRIPT:start italic-e POSTSUBSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S3.p2.1.m3.1d">\omega_{e}</annotation></semantics></math>. FaceTracker <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> is used to detect landmarks <math id="S3.p2.1.m4.1" class="ltx_Math" alttext="l_{i}" display="inline"><semantics id="S3.p2.1.m4.1a"><msub id="S3.p2.1.m4.1.3" xref="S3.p2.1.m4.1.3.cmml"><mi id="S3.p2.1.m4.1.1" xref="S3.p2.1.m4.1.1.cmml">l</mi><mi id="S3.p2.1.m4.1.2.1" xref="S3.p2.1.m4.1.2.1.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.1.m4.1b"><apply id="S3.p2.1.m4.1.3.cmml" xref="S3.p2.1.m4.1.3"><csymbol cd="ambiguous" id="S3.p2.1.m4.1.3.1.cmml" xref="S3.p2.1.m4.1.3">subscript</csymbol><ci id="S3.p2.1.m4.1.1.cmml" xref="S3.p2.1.m4.1.1">𝑙</ci><ci id="S3.p2.1.m4.1.2.1.cmml" xref="S3.p2.1.m4.1.2.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p2.1.m4.1c">italic-l POSTSUBSCRIPT:start italic-i POSTSUBSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S3.p2.1.m4.1d">l_{i}</annotation></semantics></math> on the face,
then we recover parameters and pose of the face mesh by minimizing the distance between the projected landmark vertices and their
corresponding landmark locations on the image plane. We propose a Gaussian Mixture Model as a regularizer. The GMM fits to the
values of these parameters for the FaceWarehouse data, and a scaled negative probability density value is used as our regularizer.
Our morphable face model gives us vertex-to-vertex correspondences between all face meshes. By projecting image pixels to the
face meshes (via barycentric coordinates), we get pixel-to-pixel correspondence between all images, see Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Recovering a Visual Representation ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering" width="669" height="106" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The reconstructed face geometry registered to images, and face masks in face segmentation. </figcaption>
</figure>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.1" class="ltx_p"><span id="S3.p3.1.1" class="ltx_text ltx_font_bold">Face segmentation:</span> Accurate face segmentation masks are essential. We use the aligned face mesh as a cue to
segment the input image into hair, face (including neck and ears) and background regions (<math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\Omega_{h}" display="inline"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.3" xref="S3.p3.1.m1.1.3.cmml"><mi mathvariant="normal" id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">Ω</mi><mi id="S3.p3.1.m1.1.2.1" xref="S3.p3.1.m1.1.2.1.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.3.cmml" xref="S3.p3.1.m1.1.3"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.3.1.cmml" xref="S3.p3.1.m1.1.3">subscript</csymbol><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">Ω</ci><ci id="S3.p3.1.m1.1.2.1.cmml" xref="S3.p3.1.m1.1.2.1">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1c">Omega POSTSUBSCRIPT:start italic-h POSTSUBSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S3.p3.1.m1.1d">\Omega_{h}</annotation></semantics></math>, <math id="S3.p3.1.m2.1" class="ltx_Math" alttext="\Omega_{f}" display="inline"><semantics id="S3.p3.1.m2.1a"><msub id="S3.p3.1.m2.1.3" xref="S3.p3.1.m2.1.3.cmml"><mi mathvariant="normal" id="S3.p3.1.m2.1.1" xref="S3.p3.1.m2.1.1.cmml">Ω</mi><mi id="S3.p3.1.m2.1.2.1" xref="S3.p3.1.m2.1.2.1.cmml">f</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m2.1b"><apply id="S3.p3.1.m2.1.3.cmml" xref="S3.p3.1.m2.1.3"><csymbol cd="ambiguous" id="S3.p3.1.m2.1.3.1.cmml" xref="S3.p3.1.m2.1.3">subscript</csymbol><ci id="S3.p3.1.m2.1.1.cmml" xref="S3.p3.1.m2.1.1">Ω</ci><ci id="S3.p3.1.m2.1.2.1.cmml" xref="S3.p3.1.m2.1.2.1">𝑓</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p3.1.m2.1c">Omega POSTSUBSCRIPT:start italic-f POSTSUBSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S3.p3.1.m2.1d">\Omega_{f}</annotation></semantics></math>, and <math id="S3.p3.1.m3.1" class="ltx_Math" alttext="\Omega_{b}" display="inline"><semantics id="S3.p3.1.m3.1a"><msub id="S3.p3.1.m3.1.3" xref="S3.p3.1.m3.1.3.cmml"><mi mathvariant="normal" id="S3.p3.1.m3.1.1" xref="S3.p3.1.m3.1.1.cmml">Ω</mi><mi id="S3.p3.1.m3.1.2.1" xref="S3.p3.1.m3.1.2.1.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m3.1b"><apply id="S3.p3.1.m3.1.3.cmml" xref="S3.p3.1.m3.1.3"><csymbol cd="ambiguous" id="S3.p3.1.m3.1.3.1.cmml" xref="S3.p3.1.m3.1.3">subscript</csymbol><ci id="S3.p3.1.m3.1.1.cmml" xref="S3.p3.1.m3.1.1">Ω</ci><ci id="S3.p3.1.m3.1.2.1.cmml" xref="S3.p3.1.m3.1.2.1">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p3.1.m3.1c">Omega POSTSUBSCRIPT:start italic-b POSTSUBSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S3.p3.1.m3.1d">\Omega_{b}</annotation></semantics></math> respectively).
We first project the aligned face geometry onto the image plane and construct three masks – a conservative face mask
(strictly corresponding to face), a normal face mask (approximately face and head) and an aggressive face mask
(expansion of the normal mask), see Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Recovering a Visual Representation ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">Hair is typically present at the top of the head; therefore we train a GMM-based hair detector from the pixels at the
top of the normal face mask.
The hair detector response, intersected with the normal face mask, yields a hair region.
Pixels inside the conservative face mask are assigned
the face label. Pixels outside the aggressive face mask and are not detected by the hair detector, are initially given
the background label. There might be pixels in the image that are not assigned any label. For each of these
labels, we learn a GMM-based classifier specific to that input image using color and MR8 features, and re-classify the
image. Finally, we use matting Laplacian <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> to correct the face mask.</p>
</div>
<div id="S3.p5" class="ltx_para ltx_noindent">
<p id="S3.p5.1" class="ltx_p"><span id="S3.p5.1.1" class="ltx_text ltx_font_bold">Intrinsic images:</span> The intrinsic image algorithm has a significant qualitative effect on our results.
We estimate <math id="S3.p5.1.m1.1" class="ltx_Math" alttext="s(x)=\mbox{Intensity}(x)" display="inline"><semantics id="S3.p5.1.m1.1a"><mrow id="S3.p5.1.m1.1.10" xref="S3.p5.1.m1.1.10.cmml"><mrow id="S3.p5.1.m1.1.10.1" xref="S3.p5.1.m1.1.10.1.cmml"><mi id="S3.p5.1.m1.1.1" xref="S3.p5.1.m1.1.1.cmml">s</mi><mo id="S3.p5.1.m1.1.10.1.1" xref="S3.p5.1.m1.1.10.1.1.cmml">⁢</mo><mrow id="S3.p5.1.m1.1.10.1.2" xref="S3.p5.1.m1.1.10.1.cmml"><mo stretchy="false" id="S3.p5.1.m1.1.2" xref="S3.p5.1.m1.1.10.1.cmml">(</mo><mi id="S3.p5.1.m1.1.3" xref="S3.p5.1.m1.1.3.cmml">x</mi><mo stretchy="false" id="S3.p5.1.m1.1.4" xref="S3.p5.1.m1.1.10.1.cmml">)</mo></mrow></mrow><mo id="S3.p5.1.m1.1.5" xref="S3.p5.1.m1.1.5.cmml">=</mo><mrow id="S3.p5.1.m1.1.10.2" xref="S3.p5.1.m1.1.10.2.cmml"><mtext id="S3.p5.1.m1.1.6" xref="S3.p5.1.m1.1.6a.cmml">Intensity</mtext><mo id="S3.p5.1.m1.1.10.2.1" xref="S3.p5.1.m1.1.10.2.1.cmml">⁢</mo><mrow id="S3.p5.1.m1.1.10.2.2" xref="S3.p5.1.m1.1.10.2.cmml"><mo stretchy="false" id="S3.p5.1.m1.1.7" xref="S3.p5.1.m1.1.10.2.cmml">(</mo><mi id="S3.p5.1.m1.1.8" xref="S3.p5.1.m1.1.8.cmml">x</mi><mo stretchy="false" id="S3.p5.1.m1.1.9" xref="S3.p5.1.m1.1.10.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.1.m1.1b"><apply id="S3.p5.1.m1.1.10.cmml" xref="S3.p5.1.m1.1.10"><eq id="S3.p5.1.m1.1.5.cmml" xref="S3.p5.1.m1.1.5"></eq><apply id="S3.p5.1.m1.1.10.1.cmml" xref="S3.p5.1.m1.1.10.1"><times id="S3.p5.1.m1.1.10.1.1.cmml" xref="S3.p5.1.m1.1.10.1.1"></times><ci id="S3.p5.1.m1.1.1.cmml" xref="S3.p5.1.m1.1.1">𝑠</ci><ci id="S3.p5.1.m1.1.3.cmml" xref="S3.p5.1.m1.1.3">𝑥</ci></apply><apply id="S3.p5.1.m1.1.10.2.cmml" xref="S3.p5.1.m1.1.10.2"><times id="S3.p5.1.m1.1.10.2.1.cmml" xref="S3.p5.1.m1.1.10.2.1"></times><ci id="S3.p5.1.m1.1.6a.cmml" xref="S3.p5.1.m1.1.6"><mtext id="S3.p5.1.m1.1.6.cmml" xref="S3.p5.1.m1.1.6">Intensity</mtext></ci><ci id="S3.p5.1.m1.1.8.cmml" xref="S3.p5.1.m1.1.8">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p5.1.m1.1c">italic-s OPEN:( italic-x CLOSE:) RELOP:equals ATOM:Intensity OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p5.1.m1.1d">s(x)=\mbox{Intensity}(x)</annotation></semantics></math> and <math id="S3.p5.1.m2.1" class="ltx_Math" alttext="\rho(x)={\cal I}(x)/s(x)" display="inline"><semantics id="S3.p5.1.m2.1a"><mrow id="S3.p5.1.m2.1.15" xref="S3.p5.1.m2.1.15.cmml"><mrow id="S3.p5.1.m2.1.15.1" xref="S3.p5.1.m2.1.15.1.cmml"><mi id="S3.p5.1.m2.1.1" xref="S3.p5.1.m2.1.1.cmml">ρ</mi><mo id="S3.p5.1.m2.1.15.1.1" xref="S3.p5.1.m2.1.15.1.1.cmml">⁢</mo><mrow id="S3.p5.1.m2.1.15.1.2" xref="S3.p5.1.m2.1.15.1.cmml"><mo stretchy="false" id="S3.p5.1.m2.1.2" xref="S3.p5.1.m2.1.15.1.cmml">(</mo><mi id="S3.p5.1.m2.1.3" xref="S3.p5.1.m2.1.3.cmml">x</mi><mo stretchy="false" id="S3.p5.1.m2.1.4" xref="S3.p5.1.m2.1.15.1.cmml">)</mo></mrow></mrow><mo id="S3.p5.1.m2.1.5" xref="S3.p5.1.m2.1.5.cmml">=</mo><mrow id="S3.p5.1.m2.1.15.2" xref="S3.p5.1.m2.1.15.2.cmml"><mrow id="S3.p5.1.m2.1.15.2.2" xref="S3.p5.1.m2.1.15.2.2.cmml"><mrow id="S3.p5.1.m2.1.15.2.2.1" xref="S3.p5.1.m2.1.15.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p5.1.m2.1.6" xref="S3.p5.1.m2.1.6.cmml">ℐ</mi><mo id="S3.p5.1.m2.1.15.2.2.1.1" xref="S3.p5.1.m2.1.15.2.2.1.1.cmml">⁢</mo><mrow id="S3.p5.1.m2.1.15.2.2.1.2" xref="S3.p5.1.m2.1.15.2.2.1.cmml"><mo stretchy="false" id="S3.p5.1.m2.1.7" xref="S3.p5.1.m2.1.15.2.2.1.cmml">(</mo><mi id="S3.p5.1.m2.1.8" xref="S3.p5.1.m2.1.8.cmml">x</mi><mo stretchy="false" id="S3.p5.1.m2.1.9" xref="S3.p5.1.m2.1.15.2.2.1.cmml">)</mo></mrow></mrow><mo id="S3.p5.1.m2.1.10" xref="S3.p5.1.m2.1.10.cmml">/</mo><mi id="S3.p5.1.m2.1.11" xref="S3.p5.1.m2.1.11.cmml">s</mi></mrow><mo id="S3.p5.1.m2.1.15.2.1" xref="S3.p5.1.m2.1.15.2.1.cmml">⁢</mo><mrow id="S3.p5.1.m2.1.15.2.3" xref="S3.p5.1.m2.1.15.2.cmml"><mo stretchy="false" id="S3.p5.1.m2.1.12" xref="S3.p5.1.m2.1.15.2.cmml">(</mo><mi id="S3.p5.1.m2.1.13" xref="S3.p5.1.m2.1.13.cmml">x</mi><mo stretchy="false" id="S3.p5.1.m2.1.14" xref="S3.p5.1.m2.1.15.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p5.1.m2.1b"><apply id="S3.p5.1.m2.1.15.cmml" xref="S3.p5.1.m2.1.15"><eq id="S3.p5.1.m2.1.5.cmml" xref="S3.p5.1.m2.1.5"></eq><apply id="S3.p5.1.m2.1.15.1.cmml" xref="S3.p5.1.m2.1.15.1"><times id="S3.p5.1.m2.1.15.1.1.cmml" xref="S3.p5.1.m2.1.15.1.1"></times><ci id="S3.p5.1.m2.1.1.cmml" xref="S3.p5.1.m2.1.1">𝜌</ci><ci id="S3.p5.1.m2.1.3.cmml" xref="S3.p5.1.m2.1.3">𝑥</ci></apply><apply id="S3.p5.1.m2.1.15.2.cmml" xref="S3.p5.1.m2.1.15.2"><times id="S3.p5.1.m2.1.15.2.1.cmml" xref="S3.p5.1.m2.1.15.2.1"></times><apply id="S3.p5.1.m2.1.15.2.2.cmml" xref="S3.p5.1.m2.1.15.2.2"><divide id="S3.p5.1.m2.1.10.cmml" xref="S3.p5.1.m2.1.10"></divide><apply id="S3.p5.1.m2.1.15.2.2.1.cmml" xref="S3.p5.1.m2.1.15.2.2.1"><times id="S3.p5.1.m2.1.15.2.2.1.1.cmml" xref="S3.p5.1.m2.1.15.2.2.1.1"></times><ci id="S3.p5.1.m2.1.6.cmml" xref="S3.p5.1.m2.1.6">ℐ</ci><ci id="S3.p5.1.m2.1.8.cmml" xref="S3.p5.1.m2.1.8">𝑥</ci></apply><ci id="S3.p5.1.m2.1.11.cmml" xref="S3.p5.1.m2.1.11">𝑠</ci></apply><ci id="S3.p5.1.m2.1.13.cmml" xref="S3.p5.1.m2.1.13">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p5.1.m2.1c">italic-rho OPEN:( italic-x CLOSE:) RELOP:equals caligraphic-I OPEN:( italic-x CLOSE:) MULOP:divide italic-s OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p5.1.m2.1d">\rho(x)={\cal I}(x)/s(x)</annotation></semantics></math>.
Our approach (assume small dark patches are likely shadow) will result in significant errors on current evaluation
protocols, but for the tasks we focused on, our method reliably produces better results.
A much better albedo recovery algorithm, such as Bell et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> produces significantly worse makeup transfer (Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.2 Makeup Transfer ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>,
discussion below). Similar problems occur with Retinex <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.</p>
</div>
<div id="S3.p6" class="ltx_para ltx_noindent">
<p id="S3.p6.1" class="ltx_p"><span id="S3.p6.1.1" class="ltx_text ltx_font_bold">Face illumination:</span> We represent the illumination in the image using a Spherical Harmonic (SH)
model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. Per-pixel normal <math id="S3.p6.1.m1.1" class="ltx_Math" alttext="n(x)" display="inline"><semantics id="S3.p6.1.m1.1a"><mrow id="S3.p6.1.m1.1.5" xref="S3.p6.1.m1.1.5.cmml"><mi id="S3.p6.1.m1.1.1" xref="S3.p6.1.m1.1.1.cmml">n</mi><mo id="S3.p6.1.m1.1.5.1" xref="S3.p6.1.m1.1.5.1.cmml">⁢</mo><mrow id="S3.p6.1.m1.1.5.2" xref="S3.p6.1.m1.1.5.cmml"><mo stretchy="false" id="S3.p6.1.m1.1.2" xref="S3.p6.1.m1.1.5.cmml">(</mo><mi id="S3.p6.1.m1.1.3" xref="S3.p6.1.m1.1.3.cmml">x</mi><mo stretchy="false" id="S3.p6.1.m1.1.4" xref="S3.p6.1.m1.1.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.1.m1.1b"><apply id="S3.p6.1.m1.1.5.cmml" xref="S3.p6.1.m1.1.5"><times id="S3.p6.1.m1.1.5.1.cmml" xref="S3.p6.1.m1.1.5.1"></times><ci id="S3.p6.1.m1.1.1.cmml" xref="S3.p6.1.m1.1.1">𝑛</ci><ci id="S3.p6.1.m1.1.3.cmml" xref="S3.p6.1.m1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p6.1.m1.1c">italic-n OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p6.1.m1.1d">n(x)</annotation></semantics></math> is got by projecting the face mesh onto the image. We
then estimate the first-order SH light coefficients <math id="S3.p6.1.m2.1" class="ltx_Math" alttext="\theta_{s}" display="inline"><semantics id="S3.p6.1.m2.1a"><msub id="S3.p6.1.m2.1.3" xref="S3.p6.1.m2.1.3.cmml"><mi id="S3.p6.1.m2.1.1" xref="S3.p6.1.m2.1.1.cmml">θ</mi><mi id="S3.p6.1.m2.1.2.1" xref="S3.p6.1.m2.1.2.1.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p6.1.m2.1b"><apply id="S3.p6.1.m2.1.3.cmml" xref="S3.p6.1.m2.1.3"><csymbol cd="ambiguous" id="S3.p6.1.m2.1.3.1.cmml" xref="S3.p6.1.m2.1.3">subscript</csymbol><ci id="S3.p6.1.m2.1.1.cmml" xref="S3.p6.1.m2.1.1">𝜃</ci><ci id="S3.p6.1.m2.1.2.1.cmml" xref="S3.p6.1.m2.1.2.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p6.1.m2.1c">italic-theta POSTSUBSCRIPT:start italic-s POSTSUBSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S3.p6.1.m2.1d">\theta_{s}</annotation></semantics></math>, as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\theta_{s}=\arg\min_{\theta}\sum_{x\in\Omega_{f}}(s(x)-\mathrm{SH}(n(x),\theta%
))^{2}," display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.28" xref="S3.E2.m1.1.28.2.cmml"><mrow id="S3.E2.m1.1.28.2" xref="S3.E2.m1.1.28.2.cmml"><msub id="S3.E2.m1.1.28.2.1" xref="S3.E2.m1.1.28.2.1.cmml"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">θ</mi><mi id="S3.E2.m1.1.2.1" xref="S3.E2.m1.1.2.1.cmml">s</mi></msub><mo id="S3.E2.m1.1.3" xref="S3.E2.m1.1.3.cmml">=</mo><mrow id="S3.E2.m1.1.28.2.2" xref="S3.E2.m1.1.28.2.2.cmml"><mrow id="S3.E2.m1.1.28.2.2.2" xref="S3.E2.m1.1.28.2.2.2.cmml"><mi id="S3.E2.m1.1.4" xref="S3.E2.m1.1.4.cmml">arg</mi><mo id="S3.E2.m1.1.28.2.2.2a" xref="S3.E2.m1.1.28.2.2.2.cmml">⁡</mo><munder id="S3.E2.m1.1.28.2.2.2.1" xref="S3.E2.m1.1.28.2.2.2.1.cmml"><mi id="S3.E2.m1.1.5" xref="S3.E2.m1.1.5.cmml">min</mi><mi id="S3.E2.m1.1.6.1" xref="S3.E2.m1.1.6.1.cmml">θ</mi></munder></mrow><mo id="S3.E2.m1.1.28.2.2.1" xref="S3.E2.m1.1.28.2.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.1.28.2.2.3" xref="S3.E2.m1.1.28.2.2.3.cmml"><munder id="S3.E2.m1.1.28.2.2.3.1" xref="S3.E2.m1.1.28.2.2.3.1.cmml"><mo largeop="true" movablelimits="false" symmetric="true" id="S3.E2.m1.1.7" xref="S3.E2.m1.1.7.cmml">∑</mo><mrow id="S3.E2.m1.1.8.1" xref="S3.E2.m1.1.8.1.cmml"><mi id="S3.E2.m1.1.8.1.1" xref="S3.E2.m1.1.8.1.1.cmml">x</mi><mo id="S3.E2.m1.1.8.1.2" xref="S3.E2.m1.1.8.1.2.cmml">∈</mo><msub id="S3.E2.m1.1.8.1.5" xref="S3.E2.m1.1.8.1.5.cmml"><mi mathvariant="normal" id="S3.E2.m1.1.8.1.3" xref="S3.E2.m1.1.8.1.3.cmml">Ω</mi><mi id="S3.E2.m1.1.8.1.4.1" xref="S3.E2.m1.1.8.1.4.1.cmml">f</mi></msub></mrow></munder><msup id="S3.E2.m1.1.28.2.2.3.2" xref="S3.E2.m1.1.28.2.2.3.2.cmml"><mrow id="S3.E2.m1.1.28.2.2.3.2.2" xref="S3.E2.m1.1.28.2.2.3.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.9" xref="S3.E2.m1.1.28.2.2.3.2.2.2.cmml">(</mo><mrow id="S3.E2.m1.1.28.2.2.3.2.2.2" xref="S3.E2.m1.1.28.2.2.3.2.2.2.cmml"><mrow id="S3.E2.m1.1.28.2.2.3.2.2.2.1" xref="S3.E2.m1.1.28.2.2.3.2.2.2.1.cmml"><mi id="S3.E2.m1.1.10" xref="S3.E2.m1.1.10.cmml">s</mi><mo id="S3.E2.m1.1.28.2.2.3.2.2.2.1.1" xref="S3.E2.m1.1.28.2.2.3.2.2.2.1.1.cmml">⁢</mo><mrow id="S3.E2.m1.1.28.2.2.3.2.2.2.1.2" xref="S3.E2.m1.1.28.2.2.3.2.2.2.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.11" xref="S3.E2.m1.1.28.2.2.3.2.2.2.1.cmml">(</mo><mi id="S3.E2.m1.1.12" xref="S3.E2.m1.1.12.cmml">x</mi><mo stretchy="false" id="S3.E2.m1.1.13" xref="S3.E2.m1.1.28.2.2.3.2.2.2.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.1.14" xref="S3.E2.m1.1.14.cmml">-</mo><mrow id="S3.E2.m1.1.28.2.2.3.2.2.2.2" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.cmml"><mi id="S3.E2.m1.1.16" xref="S3.E2.m1.1.16.cmml">SH</mi><mo id="S3.E2.m1.1.28.2.2.3.2.2.2.2.1" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.1.28.2.2.3.2.2.2.2.2" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.17" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.1.cmml">(</mo><mrow id="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.1.18" xref="S3.E2.m1.1.18.cmml">n</mi><mo id="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2.1" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2.2" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.19" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2.cmml">(</mo><mi id="S3.E2.m1.1.20" xref="S3.E2.m1.1.20.cmml">x</mi><mo stretchy="false" id="S3.E2.m1.1.21" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.1.22" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.1.cmml">,</mo><mi id="S3.E2.m1.1.23" xref="S3.E2.m1.1.23.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.1.24" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.E2.m1.1.25" xref="S3.E2.m1.1.28.2.2.3.2.2.2.cmml">)</mo></mrow><mn id="S3.E2.m1.1.26.1" xref="S3.E2.m1.1.26.1.cmml">2</mn></msup></mrow></mrow></mrow><mo id="S3.E2.m1.1.27" xref="S3.E2.m1.1.28.2.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.28.2.cmml" xref="S3.E2.m1.1.28"><eq id="S3.E2.m1.1.3.cmml" xref="S3.E2.m1.1.3"></eq><apply id="S3.E2.m1.1.28.2.1.cmml" xref="S3.E2.m1.1.28.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.28.2.1.1.cmml" xref="S3.E2.m1.1.28.2.1">subscript</csymbol><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">𝜃</ci><ci id="S3.E2.m1.1.2.1.cmml" xref="S3.E2.m1.1.2.1">𝑠</ci></apply><apply id="S3.E2.m1.1.28.2.2.cmml" xref="S3.E2.m1.1.28.2.2"><times id="S3.E2.m1.1.28.2.2.1.cmml" xref="S3.E2.m1.1.28.2.2.1"></times><apply id="S3.E2.m1.1.28.2.2.2.cmml" xref="S3.E2.m1.1.28.2.2.2"><arg id="S3.E2.m1.1.4.cmml" xref="S3.E2.m1.1.4"></arg><apply id="S3.E2.m1.1.28.2.2.2.1.cmml" xref="S3.E2.m1.1.28.2.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.28.2.2.2.1.1.cmml" xref="S3.E2.m1.1.28.2.2.2.1">subscript</csymbol><min id="S3.E2.m1.1.5.cmml" xref="S3.E2.m1.1.5"></min><ci id="S3.E2.m1.1.6.1.cmml" xref="S3.E2.m1.1.6.1">𝜃</ci></apply></apply><apply id="S3.E2.m1.1.28.2.2.3.cmml" xref="S3.E2.m1.1.28.2.2.3"><apply id="S3.E2.m1.1.28.2.2.3.1.cmml" xref="S3.E2.m1.1.28.2.2.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.28.2.2.3.1.1.cmml" xref="S3.E2.m1.1.28.2.2.3.1">subscript</csymbol><sum id="S3.E2.m1.1.7.cmml" xref="S3.E2.m1.1.7"></sum><apply id="S3.E2.m1.1.8.1.cmml" xref="S3.E2.m1.1.8.1"><in id="S3.E2.m1.1.8.1.2.cmml" xref="S3.E2.m1.1.8.1.2"></in><ci id="S3.E2.m1.1.8.1.1.cmml" xref="S3.E2.m1.1.8.1.1">𝑥</ci><apply id="S3.E2.m1.1.8.1.5.cmml" xref="S3.E2.m1.1.8.1.5"><csymbol cd="ambiguous" id="S3.E2.m1.1.8.1.5.1.cmml" xref="S3.E2.m1.1.8.1.5">subscript</csymbol><ci id="S3.E2.m1.1.8.1.3.cmml" xref="S3.E2.m1.1.8.1.3">Ω</ci><ci id="S3.E2.m1.1.8.1.4.1.cmml" xref="S3.E2.m1.1.8.1.4.1">𝑓</ci></apply></apply></apply><apply id="S3.E2.m1.1.28.2.2.3.2.cmml" xref="S3.E2.m1.1.28.2.2.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.28.2.2.3.2.1.cmml" xref="S3.E2.m1.1.28.2.2.3.2">superscript</csymbol><apply id="S3.E2.m1.1.28.2.2.3.2.2.2.cmml" xref="S3.E2.m1.1.28.2.2.3.2.2"><minus id="S3.E2.m1.1.14.cmml" xref="S3.E2.m1.1.14"></minus><apply id="S3.E2.m1.1.28.2.2.3.2.2.2.1.cmml" xref="S3.E2.m1.1.28.2.2.3.2.2.2.1"><times id="S3.E2.m1.1.28.2.2.3.2.2.2.1.1.cmml" xref="S3.E2.m1.1.28.2.2.3.2.2.2.1.1"></times><ci id="S3.E2.m1.1.10.cmml" xref="S3.E2.m1.1.10">𝑠</ci><ci id="S3.E2.m1.1.12.cmml" xref="S3.E2.m1.1.12">𝑥</ci></apply><apply id="S3.E2.m1.1.28.2.2.3.2.2.2.2.cmml" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2"><times id="S3.E2.m1.1.28.2.2.3.2.2.2.2.1.cmml" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.1"></times><ci id="S3.E2.m1.1.16.cmml" xref="S3.E2.m1.1.16">SH</ci><interval closure="open" id="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.1.cmml" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2"><apply id="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2.cmml" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2"><times id="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.1.28.2.2.3.2.2.2.2.2.2.1"></times><ci id="S3.E2.m1.1.18.cmml" xref="S3.E2.m1.1.18">𝑛</ci><ci id="S3.E2.m1.1.20.cmml" xref="S3.E2.m1.1.20">𝑥</ci></apply><ci id="S3.E2.m1.1.23.cmml" xref="S3.E2.m1.1.23">𝜃</ci></interval></apply></apply><cn type="integer" id="S3.E2.m1.1.26.1.cmml" xref="S3.E2.m1.1.26.1">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.E2.m1.1c">italic-theta POSTSUBSCRIPT:start italic-s POSTSUBSCRIPT:end RELOP:equals OPFUNCTION:argument OPFUNCTION:minimum POSTSUBSCRIPT:start italic-theta POSTSUBSCRIPT:end SUMOP:sum POSTSUBSCRIPT:start italic-x RELOP:element-of Omega POSTSUBSCRIPT:start italic-f POSTSUBSCRIPT:end POSTSUBSCRIPT:end OPEN:( italic-s OPEN:( italic-x CLOSE:) ADDOP:minus SH OPEN:( italic-n OPEN:( italic-x CLOSE:) PUNCT:, italic-theta CLOSE:) CLOSE:) POSTSUPERSCRIPT:start NUMBER:2 POSTSUPERSCRIPT:end PUNCT:,</annotation><annotation encoding="application/x-tex" id="S3.E2.m1.1d">\theta_{s}=\arg\min_{\theta}\sum_{x\in\Omega_{f}}(s(x)-\mathrm{SH}(n(x),\theta%
))^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr>
</table>
<p id="S3.p6.2" class="ltx_p">where <math id="S3.p6.2.m1.1" class="ltx_Math" alttext="s(x)" display="inline"><semantics id="S3.p6.2.m1.1a"><mrow id="S3.p6.2.m1.1.5" xref="S3.p6.2.m1.1.5.cmml"><mi id="S3.p6.2.m1.1.1" xref="S3.p6.2.m1.1.1.cmml">s</mi><mo id="S3.p6.2.m1.1.5.1" xref="S3.p6.2.m1.1.5.1.cmml">⁢</mo><mrow id="S3.p6.2.m1.1.5.2" xref="S3.p6.2.m1.1.5.cmml"><mo stretchy="false" id="S3.p6.2.m1.1.2" xref="S3.p6.2.m1.1.5.cmml">(</mo><mi id="S3.p6.2.m1.1.3" xref="S3.p6.2.m1.1.3.cmml">x</mi><mo stretchy="false" id="S3.p6.2.m1.1.4" xref="S3.p6.2.m1.1.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.2.m1.1b"><apply id="S3.p6.2.m1.1.5.cmml" xref="S3.p6.2.m1.1.5"><times id="S3.p6.2.m1.1.5.1.cmml" xref="S3.p6.2.m1.1.5.1"></times><ci id="S3.p6.2.m1.1.1.cmml" xref="S3.p6.2.m1.1.1">𝑠</ci><ci id="S3.p6.2.m1.1.3.cmml" xref="S3.p6.2.m1.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p6.2.m1.1c">italic-s OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p6.2.m1.1d">s(x)</annotation></semantics></math> is the shading computed using our intrinsic method, <math id="S3.p6.2.m2.1" class="ltx_Math" alttext="\mathrm{SH}()" display="inline"><semantics id="S3.p6.2.m2.1a"><mrow id="S3.p6.2.m2.1.5" xref="S3.p6.2.m2.1.5.cmml"><mi id="S3.p6.2.m2.1.2" xref="S3.p6.2.m2.1.2.cmml">SH</mi><mo id="S3.p6.2.m2.1.5.1" xref="S3.p6.2.m2.1.5.1.cmml">⁢</mo><mrow id="S3.p6.2.m2.1.5.2" xref="S3.p6.2.m2.1.5.cmml"><mo stretchy="false" id="S3.p6.2.m2.1.3" xref="S3.p6.2.m2.1.5.2.1.cmml">(</mo><mo stretchy="false" id="S3.p6.2.m2.1.4" xref="S3.p6.2.m2.1.5.2.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.2.m2.1b"><apply id="S3.p6.2.m2.1.5.cmml" xref="S3.p6.2.m2.1.5"><times id="S3.p6.2.m2.1.5.1.cmml" xref="S3.p6.2.m2.1.5.1"></times><ci id="S3.p6.2.m2.1.2.cmml" xref="S3.p6.2.m2.1.2">SH</ci><list id="S3.p6.2.m2.1.5.2.1.cmml" xref="S3.p6.2.m2.1.3"></list></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p6.2.m2.1c">SH OPEN:( CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p6.2.m2.1d">\mathrm{SH}()</annotation></semantics></math> denotes the SH-based rendering of the normals <math id="S3.p6.2.m3.1" class="ltx_Math" alttext="n(x)" display="inline"><semantics id="S3.p6.2.m3.1a"><mrow id="S3.p6.2.m3.1.5" xref="S3.p6.2.m3.1.5.cmml"><mi id="S3.p6.2.m3.1.1" xref="S3.p6.2.m3.1.1.cmml">n</mi><mo id="S3.p6.2.m3.1.5.1" xref="S3.p6.2.m3.1.5.1.cmml">⁢</mo><mrow id="S3.p6.2.m3.1.5.2" xref="S3.p6.2.m3.1.5.cmml"><mo stretchy="false" id="S3.p6.2.m3.1.2" xref="S3.p6.2.m3.1.5.cmml">(</mo><mi id="S3.p6.2.m3.1.3" xref="S3.p6.2.m3.1.3.cmml">x</mi><mo stretchy="false" id="S3.p6.2.m3.1.4" xref="S3.p6.2.m3.1.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.2.m3.1b"><apply id="S3.p6.2.m3.1.5.cmml" xref="S3.p6.2.m3.1.5"><times id="S3.p6.2.m3.1.5.1.cmml" xref="S3.p6.2.m3.1.5.1"></times><ci id="S3.p6.2.m3.1.1.cmml" xref="S3.p6.2.m3.1.1">𝑛</ci><ci id="S3.p6.2.m3.1.3.cmml" xref="S3.p6.2.m3.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p6.2.m3.1c">italic-n OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p6.2.m3.1d">n(x)</annotation></semantics></math> with the lighting coefficients <math id="S3.p6.2.m4.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.p6.2.m4.1a"><mi id="S3.p6.2.m4.1.1" xref="S3.p6.2.m4.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p6.2.m4.1b"><ci id="S3.p6.2.m4.1.1.cmml" xref="S3.p6.2.m4.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p6.2.m4.1c">italic-theta</annotation><annotation encoding="application/x-tex" id="S3.p6.2.m4.1d">\theta</annotation></semantics></math>, and <math id="S3.p6.2.m5.1" class="ltx_Math" alttext="x\in\Omega_{f}" display="inline"><semantics id="S3.p6.2.m5.1a"><mrow id="S3.p6.2.m5.1.5" xref="S3.p6.2.m5.1.5.cmml"><mi id="S3.p6.2.m5.1.1" xref="S3.p6.2.m5.1.1.cmml">x</mi><mo id="S3.p6.2.m5.1.2" xref="S3.p6.2.m5.1.2.cmml">∈</mo><msub id="S3.p6.2.m5.1.5.1" xref="S3.p6.2.m5.1.5.1.cmml"><mi mathvariant="normal" id="S3.p6.2.m5.1.3" xref="S3.p6.2.m5.1.3.cmml">Ω</mi><mi id="S3.p6.2.m5.1.4.1" xref="S3.p6.2.m5.1.4.1.cmml">f</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.p6.2.m5.1b"><apply id="S3.p6.2.m5.1.5.cmml" xref="S3.p6.2.m5.1.5"><in id="S3.p6.2.m5.1.2.cmml" xref="S3.p6.2.m5.1.2"></in><ci id="S3.p6.2.m5.1.1.cmml" xref="S3.p6.2.m5.1.1">𝑥</ci><apply id="S3.p6.2.m5.1.5.1.cmml" xref="S3.p6.2.m5.1.5.1"><csymbol cd="ambiguous" id="S3.p6.2.m5.1.5.1.1.cmml" xref="S3.p6.2.m5.1.5.1">subscript</csymbol><ci id="S3.p6.2.m5.1.3.cmml" xref="S3.p6.2.m5.1.3">Ω</ci><ci id="S3.p6.2.m5.1.4.1.cmml" xref="S3.p6.2.m5.1.4.1">𝑓</ci></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p6.2.m5.1c">italic-x RELOP:element-of Omega POSTSUBSCRIPT:start italic-f POSTSUBSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S3.p6.2.m5.1d">x\in\Omega_{f}</annotation></semantics></math> restricts this optimization to the face pixels.</p>
</div>
<div id="S3.p7" class="ltx_para ltx_noindent">
<p id="S3.p7.1" class="ltx_p"><span id="S3.p7.1.1" class="ltx_text ltx_font_bold">Face detail map:</span> Given our estimates of face geometry, albedo, and scene illumination, we can reconstruct the image as:</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="I_{e}(x)=\mathrm{render}(\rho(x),F,\theta_{s})=\rho(x)\;\mathrm{SH}(n(x),%
\theta_{s})" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.41" xref="S3.E3.m1.1.41.cmml"><mrow id="S3.E3.m1.1.41.2" xref="S3.E3.m1.1.41.2.cmml"><msub id="S3.E3.m1.1.41.2.2" xref="S3.E3.m1.1.41.2.2.cmml"><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">I</mi><mi id="S3.E3.m1.1.2.1" xref="S3.E3.m1.1.2.1.cmml">e</mi></msub><mo id="S3.E3.m1.1.41.2.1" xref="S3.E3.m1.1.41.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.1.41.2.3" xref="S3.E3.m1.1.41.2.cmml"><mo stretchy="false" id="S3.E3.m1.1.3" xref="S3.E3.m1.1.41.2.cmml">(</mo><mi id="S3.E3.m1.1.4" xref="S3.E3.m1.1.4.cmml">x</mi><mo stretchy="false" id="S3.E3.m1.1.5" xref="S3.E3.m1.1.41.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.6" xref="S3.E3.m1.1.6.cmml">=</mo><mrow id="S3.E3.m1.1.41.3" xref="S3.E3.m1.1.41.3.cmml"><mi id="S3.E3.m1.1.12" xref="S3.E3.m1.1.12.cmml">render</mi><mo id="S3.E3.m1.1.41.3.1" xref="S3.E3.m1.1.41.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.1.41.3.2" xref="S3.E3.m1.1.41.3.2.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.13" xref="S3.E3.m1.1.41.3.2.1.cmml">(</mo><mrow id="S3.E3.m1.1.41.3.2.2" xref="S3.E3.m1.1.41.3.2.2.cmml"><mi id="S3.E3.m1.1.14" xref="S3.E3.m1.1.14.cmml">ρ</mi><mo id="S3.E3.m1.1.41.3.2.2.1" xref="S3.E3.m1.1.41.3.2.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.1.41.3.2.2.2" xref="S3.E3.m1.1.41.3.2.2.cmml"><mo stretchy="false" id="S3.E3.m1.1.15" xref="S3.E3.m1.1.41.3.2.2.cmml">(</mo><mi id="S3.E3.m1.1.16" xref="S3.E3.m1.1.16.cmml">x</mi><mo stretchy="false" id="S3.E3.m1.1.17" xref="S3.E3.m1.1.41.3.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.18" xref="S3.E3.m1.1.41.3.2.1.cmml">,</mo><mi id="S3.E3.m1.1.19" xref="S3.E3.m1.1.19.cmml">F</mi><mo id="S3.E3.m1.1.20" xref="S3.E3.m1.1.41.3.2.1.cmml">,</mo><msub id="S3.E3.m1.1.41.3.2.3" xref="S3.E3.m1.1.41.3.2.3.cmml"><mi id="S3.E3.m1.1.21" xref="S3.E3.m1.1.21.cmml">θ</mi><mi id="S3.E3.m1.1.22.1" xref="S3.E3.m1.1.22.1.cmml">s</mi></msub><mo stretchy="false" id="S3.E3.m1.1.23" xref="S3.E3.m1.1.41.3.2.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.24" xref="S3.E3.m1.1.24.cmml">=</mo><mrow id="S3.E3.m1.1.41.4" xref="S3.E3.m1.1.41.4.cmml"><mi id="S3.E3.m1.1.25" xref="S3.E3.m1.1.25.cmml">ρ</mi><mo id="S3.E3.m1.1.41.4.1" xref="S3.E3.m1.1.41.4.1.cmml">⁢</mo><mrow id="S3.E3.m1.1.41.4.2" xref="S3.E3.m1.1.41.4.cmml"><mo stretchy="false" id="S3.E3.m1.1.26" xref="S3.E3.m1.1.41.4.cmml">(</mo><mi id="S3.E3.m1.1.27" xref="S3.E3.m1.1.27.cmml">x</mi><mo rspace="5.3pt" stretchy="false" id="S3.E3.m1.1.28" xref="S3.E3.m1.1.41.4.cmml">)</mo></mrow><mo id="S3.E3.m1.1.41.4.1a" xref="S3.E3.m1.1.41.4.1.cmml">⁢</mo><mi id="S3.E3.m1.1.31" xref="S3.E3.m1.1.31.cmml">SH</mi><mo id="S3.E3.m1.1.41.4.1b" xref="S3.E3.m1.1.41.4.1.cmml">⁢</mo><mrow id="S3.E3.m1.1.41.4.3" xref="S3.E3.m1.1.41.4.3.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.32" xref="S3.E3.m1.1.41.4.3.1.cmml">(</mo><mrow id="S3.E3.m1.1.41.4.3.2" xref="S3.E3.m1.1.41.4.3.2.cmml"><mi id="S3.E3.m1.1.33" xref="S3.E3.m1.1.33.cmml">n</mi><mo id="S3.E3.m1.1.41.4.3.2.1" xref="S3.E3.m1.1.41.4.3.2.1.cmml">⁢</mo><mrow id="S3.E3.m1.1.41.4.3.2.2" xref="S3.E3.m1.1.41.4.3.2.cmml"><mo stretchy="false" id="S3.E3.m1.1.34" xref="S3.E3.m1.1.41.4.3.2.cmml">(</mo><mi id="S3.E3.m1.1.35" xref="S3.E3.m1.1.35.cmml">x</mi><mo stretchy="false" id="S3.E3.m1.1.36" xref="S3.E3.m1.1.41.4.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.1.37" xref="S3.E3.m1.1.41.4.3.1.cmml">,</mo><msub id="S3.E3.m1.1.41.4.3.3" xref="S3.E3.m1.1.41.4.3.3.cmml"><mi id="S3.E3.m1.1.38" xref="S3.E3.m1.1.38.cmml">θ</mi><mi id="S3.E3.m1.1.39.1" xref="S3.E3.m1.1.39.1.cmml">s</mi></msub><mo stretchy="false" id="S3.E3.m1.1.40" xref="S3.E3.m1.1.41.4.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.41.cmml" xref="S3.E3.m1.1.41"><and id="S3.E3.m1.1.41a.cmml" xref="S3.E3.m1.1.41"></and><apply id="S3.E3.m1.1.41b.cmml" xref="S3.E3.m1.1.41"><eq id="S3.E3.m1.1.6.cmml" xref="S3.E3.m1.1.6"></eq><apply id="S3.E3.m1.1.41.2.cmml" xref="S3.E3.m1.1.41.2"><times id="S3.E3.m1.1.41.2.1.cmml" xref="S3.E3.m1.1.41.2.1"></times><apply id="S3.E3.m1.1.41.2.2.cmml" xref="S3.E3.m1.1.41.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.41.2.2.1.cmml" xref="S3.E3.m1.1.41.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝐼</ci><ci id="S3.E3.m1.1.2.1.cmml" xref="S3.E3.m1.1.2.1">𝑒</ci></apply><ci id="S3.E3.m1.1.4.cmml" xref="S3.E3.m1.1.4">𝑥</ci></apply><apply id="S3.E3.m1.1.41.3.cmml" xref="S3.E3.m1.1.41.3"><times id="S3.E3.m1.1.41.3.1.cmml" xref="S3.E3.m1.1.41.3.1"></times><ci id="S3.E3.m1.1.12.cmml" xref="S3.E3.m1.1.12">render</ci><vector id="S3.E3.m1.1.41.3.2.1.cmml" xref="S3.E3.m1.1.41.3.2"><apply id="S3.E3.m1.1.41.3.2.2.cmml" xref="S3.E3.m1.1.41.3.2.2"><times id="S3.E3.m1.1.41.3.2.2.1.cmml" xref="S3.E3.m1.1.41.3.2.2.1"></times><ci id="S3.E3.m1.1.14.cmml" xref="S3.E3.m1.1.14">𝜌</ci><ci id="S3.E3.m1.1.16.cmml" xref="S3.E3.m1.1.16">𝑥</ci></apply><ci id="S3.E3.m1.1.19.cmml" xref="S3.E3.m1.1.19">𝐹</ci><apply id="S3.E3.m1.1.41.3.2.3.cmml" xref="S3.E3.m1.1.41.3.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.41.3.2.3.1.cmml" xref="S3.E3.m1.1.41.3.2.3">subscript</csymbol><ci id="S3.E3.m1.1.21.cmml" xref="S3.E3.m1.1.21">𝜃</ci><ci id="S3.E3.m1.1.22.1.cmml" xref="S3.E3.m1.1.22.1">𝑠</ci></apply></vector></apply></apply><apply id="S3.E3.m1.1.41c.cmml" xref="S3.E3.m1.1.41"><eq id="S3.E3.m1.1.24.cmml" xref="S3.E3.m1.1.24"></eq><share href="#S3.E3.m1.1.41.3.cmml" id="S3.E3.m1.1.41d.cmml" xref="S3.E3.m1.1.41"></share><apply id="S3.E3.m1.1.41.4.cmml" xref="S3.E3.m1.1.41.4"><times id="S3.E3.m1.1.41.4.1.cmml" xref="S3.E3.m1.1.41.4.1"></times><ci id="S3.E3.m1.1.25.cmml" xref="S3.E3.m1.1.25">𝜌</ci><ci id="S3.E3.m1.1.27.cmml" xref="S3.E3.m1.1.27">𝑥</ci><ci id="S3.E3.m1.1.31.cmml" xref="S3.E3.m1.1.31">SH</ci><interval closure="open" id="S3.E3.m1.1.41.4.3.1.cmml" xref="S3.E3.m1.1.41.4.3"><apply id="S3.E3.m1.1.41.4.3.2.cmml" xref="S3.E3.m1.1.41.4.3.2"><times id="S3.E3.m1.1.41.4.3.2.1.cmml" xref="S3.E3.m1.1.41.4.3.2.1"></times><ci id="S3.E3.m1.1.33.cmml" xref="S3.E3.m1.1.33">𝑛</ci><ci id="S3.E3.m1.1.35.cmml" xref="S3.E3.m1.1.35">𝑥</ci></apply><apply id="S3.E3.m1.1.41.4.3.3.cmml" xref="S3.E3.m1.1.41.4.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.41.4.3.3.1.cmml" xref="S3.E3.m1.1.41.4.3.3">subscript</csymbol><ci id="S3.E3.m1.1.38.cmml" xref="S3.E3.m1.1.38">𝜃</ci><ci id="S3.E3.m1.1.39.1.cmml" xref="S3.E3.m1.1.39.1">𝑠</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.E3.m1.1c">italic-I POSTSUBSCRIPT:start italic-e POSTSUBSCRIPT:end OPEN:( italic-x CLOSE:) RELOP:equals render OPEN:( italic-rho OPEN:( italic-x CLOSE:) PUNCT:, italic-F PUNCT:, italic-theta POSTSUBSCRIPT:start italic-s POSTSUBSCRIPT:end CLOSE:) RELOP:equals italic-rho OPEN:( italic-x CLOSE:) SH OPEN:( italic-n OPEN:( italic-x CLOSE:) PUNCT:, italic-theta POSTSUBSCRIPT:start italic-s POSTSUBSCRIPT:end CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.E3.m1.1d">I_{e}(x)=\mathrm{render}(\rho(x),F,\theta_{s})=\rho(x)\;\mathrm{SH}(n(x),%
\theta_{s})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr>
</table>
<p id="S3.p7.2" class="ltx_p">Under ideal circumstances, this reconstruction will approximate the input image, i.e., <math id="S3.p7.2.m1.1" class="ltx_Math" alttext="I_{e}(x)\approx I(x),\forall x" display="inline"><semantics id="S3.p7.2.m1.1a"><mrow id="S3.p7.2.m1.1.14" xref="S3.p7.2.m1.1.14.cmml"><mrow id="S3.p7.2.m1.1.14.1" xref="S3.p7.2.m1.1.14.1.cmml"><msub id="S3.p7.2.m1.1.14.1.2" xref="S3.p7.2.m1.1.14.1.2.cmml"><mi id="S3.p7.2.m1.1.1" xref="S3.p7.2.m1.1.1.cmml">I</mi><mi id="S3.p7.2.m1.1.2.1" xref="S3.p7.2.m1.1.2.1.cmml">e</mi></msub><mo id="S3.p7.2.m1.1.14.1.1" xref="S3.p7.2.m1.1.14.1.1.cmml">⁢</mo><mrow id="S3.p7.2.m1.1.14.1.3" xref="S3.p7.2.m1.1.14.1.cmml"><mo stretchy="false" id="S3.p7.2.m1.1.3" xref="S3.p7.2.m1.1.14.1.cmml">(</mo><mi id="S3.p7.2.m1.1.4" xref="S3.p7.2.m1.1.4.cmml">x</mi><mo stretchy="false" id="S3.p7.2.m1.1.5" xref="S3.p7.2.m1.1.14.1.cmml">)</mo></mrow></mrow><mo id="S3.p7.2.m1.1.6" xref="S3.p7.2.m1.1.6.cmml">≈</mo><mrow id="S3.p7.2.m1.1.14.2" xref="S3.p7.2.m1.1.14.2.1.cmml"><mrow id="S3.p7.2.m1.1.14.2.2" xref="S3.p7.2.m1.1.14.2.2.cmml"><mi id="S3.p7.2.m1.1.7" xref="S3.p7.2.m1.1.7.cmml">I</mi><mo id="S3.p7.2.m1.1.14.2.2.1" xref="S3.p7.2.m1.1.14.2.2.1.cmml">⁢</mo><mrow id="S3.p7.2.m1.1.14.2.2.2" xref="S3.p7.2.m1.1.14.2.2.cmml"><mo stretchy="false" id="S3.p7.2.m1.1.8" xref="S3.p7.2.m1.1.14.2.2.cmml">(</mo><mi id="S3.p7.2.m1.1.9" xref="S3.p7.2.m1.1.9.cmml">x</mi><mo stretchy="false" id="S3.p7.2.m1.1.10" xref="S3.p7.2.m1.1.14.2.2.cmml">)</mo></mrow></mrow><mo id="S3.p7.2.m1.1.11" xref="S3.p7.2.m1.1.14.2.1.cmml">,</mo><mrow id="S3.p7.2.m1.1.14.2.3" xref="S3.p7.2.m1.1.14.2.3.cmml"><mo id="S3.p7.2.m1.1.12" xref="S3.p7.2.m1.1.12.cmml">∀</mo><mi id="S3.p7.2.m1.1.13" xref="S3.p7.2.m1.1.13.cmml">x</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.2.m1.1b"><apply id="S3.p7.2.m1.1.14.cmml" xref="S3.p7.2.m1.1.14"><approx id="S3.p7.2.m1.1.6.cmml" xref="S3.p7.2.m1.1.6"></approx><apply id="S3.p7.2.m1.1.14.1.cmml" xref="S3.p7.2.m1.1.14.1"><times id="S3.p7.2.m1.1.14.1.1.cmml" xref="S3.p7.2.m1.1.14.1.1"></times><apply id="S3.p7.2.m1.1.14.1.2.cmml" xref="S3.p7.2.m1.1.14.1.2"><csymbol cd="ambiguous" id="S3.p7.2.m1.1.14.1.2.1.cmml" xref="S3.p7.2.m1.1.14.1.2">subscript</csymbol><ci id="S3.p7.2.m1.1.1.cmml" xref="S3.p7.2.m1.1.1">𝐼</ci><ci id="S3.p7.2.m1.1.2.1.cmml" xref="S3.p7.2.m1.1.2.1">𝑒</ci></apply><ci id="S3.p7.2.m1.1.4.cmml" xref="S3.p7.2.m1.1.4">𝑥</ci></apply><list id="S3.p7.2.m1.1.14.2.1.cmml" xref="S3.p7.2.m1.1.14.2"><apply id="S3.p7.2.m1.1.14.2.2.cmml" xref="S3.p7.2.m1.1.14.2.2"><times id="S3.p7.2.m1.1.14.2.2.1.cmml" xref="S3.p7.2.m1.1.14.2.2.1"></times><ci id="S3.p7.2.m1.1.7.cmml" xref="S3.p7.2.m1.1.7">𝐼</ci><ci id="S3.p7.2.m1.1.9.cmml" xref="S3.p7.2.m1.1.9">𝑥</ci></apply><apply id="S3.p7.2.m1.1.14.2.3.cmml" xref="S3.p7.2.m1.1.14.2.3"><csymbol cd="latexml" id="S3.p7.2.m1.1.12.cmml" xref="S3.p7.2.m1.1.12">for-all</csymbol><ci id="S3.p7.2.m1.1.13.cmml" xref="S3.p7.2.m1.1.13">𝑥</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p7.2.m1.1c">italic-I POSTSUBSCRIPT:start italic-e POSTSUBSCRIPT:end OPEN:( italic-x CLOSE:) RELOP:approximately-equals italic-I OPEN:( italic-x CLOSE:) PUNCT:, BIGOP:for-all italic-x</annotation><annotation encoding="application/x-tex" id="S3.p7.2.m1.1d">I_{e}(x)\approx I(x),\forall x</annotation></semantics></math>.
However, the geometric model cannot represent fine-scale spatial structure on the face (for example:
detailed folds on eyelids; small grooves and wrinkles; facial blemishes; the wrinkles on lip tissue; the folds around the outside of the lower end of the nose; and so on).
These details are typically the results of shading effects.
The intrinsic image algorithm we used produces an albedo map that cannot account for these details, but represents the albedo as large blotches of constant color. As a result,
<math id="S3.p7.2.m2.1" class="ltx_Math" alttext="I_{e}(x)" display="inline"><semantics id="S3.p7.2.m2.1a"><mrow id="S3.p7.2.m2.1.6" xref="S3.p7.2.m2.1.6.cmml"><msub id="S3.p7.2.m2.1.6.2" xref="S3.p7.2.m2.1.6.2.cmml"><mi id="S3.p7.2.m2.1.1" xref="S3.p7.2.m2.1.1.cmml">I</mi><mi id="S3.p7.2.m2.1.2.1" xref="S3.p7.2.m2.1.2.1.cmml">e</mi></msub><mo id="S3.p7.2.m2.1.6.1" xref="S3.p7.2.m2.1.6.1.cmml">⁢</mo><mrow id="S3.p7.2.m2.1.6.3" xref="S3.p7.2.m2.1.6.cmml"><mo stretchy="false" id="S3.p7.2.m2.1.3" xref="S3.p7.2.m2.1.6.cmml">(</mo><mi id="S3.p7.2.m2.1.4" xref="S3.p7.2.m2.1.4.cmml">x</mi><mo stretchy="false" id="S3.p7.2.m2.1.5" xref="S3.p7.2.m2.1.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p7.2.m2.1b"><apply id="S3.p7.2.m2.1.6.cmml" xref="S3.p7.2.m2.1.6"><times id="S3.p7.2.m2.1.6.1.cmml" xref="S3.p7.2.m2.1.6.1"></times><apply id="S3.p7.2.m2.1.6.2.cmml" xref="S3.p7.2.m2.1.6.2"><csymbol cd="ambiguous" id="S3.p7.2.m2.1.6.2.1.cmml" xref="S3.p7.2.m2.1.6.2">subscript</csymbol><ci id="S3.p7.2.m2.1.1.cmml" xref="S3.p7.2.m2.1.1">𝐼</ci><ci id="S3.p7.2.m2.1.2.1.cmml" xref="S3.p7.2.m2.1.2.1">𝑒</ci></apply><ci id="S3.p7.2.m2.1.4.cmml" xref="S3.p7.2.m2.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p7.2.m2.1c">italic-I POSTSUBSCRIPT:start italic-e POSTSUBSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S3.p7.2.m2.1d">I_{e}(x)</annotation></semantics></math> lacks these details. These details are represented by computing a <em id="S3.p7.2.1" class="ltx_emph ltx_font_italic">face detail map</em>, <math id="S3.p7.2.m3.1" class="ltx_Math" alttext="I_{d}" display="inline"><semantics id="S3.p7.2.m3.1a"><msub id="S3.p7.2.m3.1.3" xref="S3.p7.2.m3.1.3.cmml"><mi id="S3.p7.2.m3.1.1" xref="S3.p7.2.m3.1.1.cmml">I</mi><mi id="S3.p7.2.m3.1.2.1" xref="S3.p7.2.m3.1.2.1.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p7.2.m3.1b"><apply id="S3.p7.2.m3.1.3.cmml" xref="S3.p7.2.m3.1.3"><csymbol cd="ambiguous" id="S3.p7.2.m3.1.3.1.cmml" xref="S3.p7.2.m3.1.3">subscript</csymbol><ci id="S3.p7.2.m3.1.1.cmml" xref="S3.p7.2.m3.1.1">𝐼</ci><ci id="S3.p7.2.m3.1.2.1.cmml" xref="S3.p7.2.m3.1.2.1">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.p7.2.m3.1c">italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S3.p7.2.m3.1d">I_{d}</annotation></semantics></math>:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="I_{d}(x)=I(x)-\mathrm{render}(\rho(x),F,\theta_{s})," display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.30" xref="S3.E4.m1.1.30.2.cmml"><mrow id="S3.E4.m1.1.30.2" xref="S3.E4.m1.1.30.2.cmml"><mrow id="S3.E4.m1.1.30.2.1" xref="S3.E4.m1.1.30.2.1.cmml"><msub id="S3.E4.m1.1.30.2.1.2" xref="S3.E4.m1.1.30.2.1.2.cmml"><mi id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">I</mi><mi id="S3.E4.m1.1.2.1" xref="S3.E4.m1.1.2.1.cmml">d</mi></msub><mo id="S3.E4.m1.1.30.2.1.1" xref="S3.E4.m1.1.30.2.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.1.30.2.1.3" xref="S3.E4.m1.1.30.2.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.3" xref="S3.E4.m1.1.30.2.1.cmml">(</mo><mi id="S3.E4.m1.1.4" xref="S3.E4.m1.1.4.cmml">x</mi><mo stretchy="false" id="S3.E4.m1.1.5" xref="S3.E4.m1.1.30.2.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.6" xref="S3.E4.m1.1.6.cmml">=</mo><mrow id="S3.E4.m1.1.30.2.2" xref="S3.E4.m1.1.30.2.2.cmml"><mrow id="S3.E4.m1.1.30.2.2.1" xref="S3.E4.m1.1.30.2.2.1.cmml"><mi id="S3.E4.m1.1.7" xref="S3.E4.m1.1.7.cmml">I</mi><mo id="S3.E4.m1.1.30.2.2.1.1" xref="S3.E4.m1.1.30.2.2.1.1.cmml">⁢</mo><mrow id="S3.E4.m1.1.30.2.2.1.2" xref="S3.E4.m1.1.30.2.2.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.8" xref="S3.E4.m1.1.30.2.2.1.cmml">(</mo><mi id="S3.E4.m1.1.9" xref="S3.E4.m1.1.9.cmml">x</mi><mo stretchy="false" id="S3.E4.m1.1.10" xref="S3.E4.m1.1.30.2.2.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.11" xref="S3.E4.m1.1.11.cmml">-</mo><mrow id="S3.E4.m1.1.30.2.2.2" xref="S3.E4.m1.1.30.2.2.2.cmml"><mi id="S3.E4.m1.1.17" xref="S3.E4.m1.1.17.cmml">render</mi><mo id="S3.E4.m1.1.30.2.2.2.1" xref="S3.E4.m1.1.30.2.2.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.1.30.2.2.2.2" xref="S3.E4.m1.1.30.2.2.2.2.1.cmml"><mo stretchy="false" id="S3.E4.m1.1.18" xref="S3.E4.m1.1.30.2.2.2.2.1.cmml">(</mo><mrow id="S3.E4.m1.1.30.2.2.2.2.2" xref="S3.E4.m1.1.30.2.2.2.2.2.cmml"><mi id="S3.E4.m1.1.19" xref="S3.E4.m1.1.19.cmml">ρ</mi><mo id="S3.E4.m1.1.30.2.2.2.2.2.1" xref="S3.E4.m1.1.30.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S3.E4.m1.1.30.2.2.2.2.2.2" xref="S3.E4.m1.1.30.2.2.2.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.1.20" xref="S3.E4.m1.1.30.2.2.2.2.2.cmml">(</mo><mi id="S3.E4.m1.1.21" xref="S3.E4.m1.1.21.cmml">x</mi><mo stretchy="false" id="S3.E4.m1.1.22" xref="S3.E4.m1.1.30.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.1.23" xref="S3.E4.m1.1.30.2.2.2.2.1.cmml">,</mo><mi id="S3.E4.m1.1.24" xref="S3.E4.m1.1.24.cmml">F</mi><mo id="S3.E4.m1.1.25" xref="S3.E4.m1.1.30.2.2.2.2.1.cmml">,</mo><msub id="S3.E4.m1.1.30.2.2.2.2.3" xref="S3.E4.m1.1.30.2.2.2.2.3.cmml"><mi id="S3.E4.m1.1.26" xref="S3.E4.m1.1.26.cmml">θ</mi><mi id="S3.E4.m1.1.27.1" xref="S3.E4.m1.1.27.1.cmml">s</mi></msub><mo stretchy="false" id="S3.E4.m1.1.28" xref="S3.E4.m1.1.30.2.2.2.2.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.1.29" xref="S3.E4.m1.1.30.2.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.30.2.cmml" xref="S3.E4.m1.1.30"><eq id="S3.E4.m1.1.6.cmml" xref="S3.E4.m1.1.6"></eq><apply id="S3.E4.m1.1.30.2.1.cmml" xref="S3.E4.m1.1.30.2.1"><times id="S3.E4.m1.1.30.2.1.1.cmml" xref="S3.E4.m1.1.30.2.1.1"></times><apply id="S3.E4.m1.1.30.2.1.2.cmml" xref="S3.E4.m1.1.30.2.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.30.2.1.2.1.cmml" xref="S3.E4.m1.1.30.2.1.2">subscript</csymbol><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝐼</ci><ci id="S3.E4.m1.1.2.1.cmml" xref="S3.E4.m1.1.2.1">𝑑</ci></apply><ci id="S3.E4.m1.1.4.cmml" xref="S3.E4.m1.1.4">𝑥</ci></apply><apply id="S3.E4.m1.1.30.2.2.cmml" xref="S3.E4.m1.1.30.2.2"><minus id="S3.E4.m1.1.11.cmml" xref="S3.E4.m1.1.11"></minus><apply id="S3.E4.m1.1.30.2.2.1.cmml" xref="S3.E4.m1.1.30.2.2.1"><times id="S3.E4.m1.1.30.2.2.1.1.cmml" xref="S3.E4.m1.1.30.2.2.1.1"></times><ci id="S3.E4.m1.1.7.cmml" xref="S3.E4.m1.1.7">𝐼</ci><ci id="S3.E4.m1.1.9.cmml" xref="S3.E4.m1.1.9">𝑥</ci></apply><apply id="S3.E4.m1.1.30.2.2.2.cmml" xref="S3.E4.m1.1.30.2.2.2"><times id="S3.E4.m1.1.30.2.2.2.1.cmml" xref="S3.E4.m1.1.30.2.2.2.1"></times><ci id="S3.E4.m1.1.17.cmml" xref="S3.E4.m1.1.17">render</ci><vector id="S3.E4.m1.1.30.2.2.2.2.1.cmml" xref="S3.E4.m1.1.30.2.2.2.2"><apply id="S3.E4.m1.1.30.2.2.2.2.2.cmml" xref="S3.E4.m1.1.30.2.2.2.2.2"><times id="S3.E4.m1.1.30.2.2.2.2.2.1.cmml" xref="S3.E4.m1.1.30.2.2.2.2.2.1"></times><ci id="S3.E4.m1.1.19.cmml" xref="S3.E4.m1.1.19">𝜌</ci><ci id="S3.E4.m1.1.21.cmml" xref="S3.E4.m1.1.21">𝑥</ci></apply><ci id="S3.E4.m1.1.24.cmml" xref="S3.E4.m1.1.24">𝐹</ci><apply id="S3.E4.m1.1.30.2.2.2.2.3.cmml" xref="S3.E4.m1.1.30.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.30.2.2.2.2.3.1.cmml" xref="S3.E4.m1.1.30.2.2.2.2.3">subscript</csymbol><ci id="S3.E4.m1.1.26.cmml" xref="S3.E4.m1.1.26">𝜃</ci><ci id="S3.E4.m1.1.27.1.cmml" xref="S3.E4.m1.1.27.1">𝑠</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S3.E4.m1.1c">italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end OPEN:( italic-x CLOSE:) RELOP:equals italic-I OPEN:( italic-x CLOSE:) ADDOP:minus render OPEN:( italic-rho OPEN:( italic-x CLOSE:) PUNCT:, italic-F PUNCT:, italic-theta POSTSUBSCRIPT:start italic-s POSTSUBSCRIPT:end CLOSE:) PUNCT:,</annotation><annotation encoding="application/x-tex" id="S3.E4.m1.1d">I_{d}(x)=I(x)-\mathrm{render}(\rho(x),F,\theta_{s}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr>
</table>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Face Editing</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">As can be seen from Eqn. <a href="#S3.E1" title="(1) ‣ 3 Recovering a Visual Representation ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, our model allows us to manipulate face appearance in three ways. We can change the illumination in the scene by rendering the
face under a new set of lights; we can edit the face appearance by editing the albedo layer; we can also edit the fine-scale details of the face by manipulating the detail map.
The novel face image is then given by:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.1" class="ltx_Math" alttext="I^{(n)}(x)=\mathrm{render}(\rho^{(n)}(x),F,\theta^{(n)})+I^{(n)}_{d}(x)," display="block"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.33" xref="S4.E5.m1.1.33.2.cmml"><mrow id="S4.E5.m1.1.33.2" xref="S4.E5.m1.1.33.2.cmml"><mrow id="S4.E5.m1.1.33.2.1" xref="S4.E5.m1.1.33.2.1.cmml"><msup id="S4.E5.m1.1.33.2.1.2" xref="S4.E5.m1.1.33.2.1.2.cmml"><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">I</mi><mrow id="S4.E5.m1.1.2.1" xref="S4.E5.m1.1.33.2.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.2.1.1" xref="S4.E5.m1.1.33.2.1.2.cmml">(</mo><mi id="S4.E5.m1.1.2.1.2" xref="S4.E5.m1.1.2.1.2.cmml">n</mi><mo stretchy="false" id="S4.E5.m1.1.2.1.3" xref="S4.E5.m1.1.33.2.1.2.cmml">)</mo></mrow></msup><mo id="S4.E5.m1.1.33.2.1.1" xref="S4.E5.m1.1.33.2.1.1.cmml">⁢</mo><mrow id="S4.E5.m1.1.33.2.1.3" xref="S4.E5.m1.1.33.2.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.3" xref="S4.E5.m1.1.33.2.1.cmml">(</mo><mi id="S4.E5.m1.1.4" xref="S4.E5.m1.1.4.cmml">x</mi><mo stretchy="false" id="S4.E5.m1.1.5" xref="S4.E5.m1.1.33.2.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.1.6" xref="S4.E5.m1.1.6.cmml">=</mo><mrow id="S4.E5.m1.1.33.2.2" xref="S4.E5.m1.1.33.2.2.cmml"><mrow id="S4.E5.m1.1.33.2.2.1" xref="S4.E5.m1.1.33.2.2.1.cmml"><mi id="S4.E5.m1.1.12" xref="S4.E5.m1.1.12.cmml">render</mi><mo id="S4.E5.m1.1.33.2.2.1.1" xref="S4.E5.m1.1.33.2.2.1.1.cmml">⁢</mo><mrow id="S4.E5.m1.1.33.2.2.1.2" xref="S4.E5.m1.1.33.2.2.1.2.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.13" xref="S4.E5.m1.1.33.2.2.1.2.1.cmml">(</mo><mrow id="S4.E5.m1.1.33.2.2.1.2.2" xref="S4.E5.m1.1.33.2.2.1.2.2.cmml"><msup id="S4.E5.m1.1.33.2.2.1.2.2.2" xref="S4.E5.m1.1.33.2.2.1.2.2.2.cmml"><mi id="S4.E5.m1.1.14" xref="S4.E5.m1.1.14.cmml">ρ</mi><mrow id="S4.E5.m1.1.15.1" xref="S4.E5.m1.1.33.2.2.1.2.2.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.15.1.1" xref="S4.E5.m1.1.33.2.2.1.2.2.2.cmml">(</mo><mi id="S4.E5.m1.1.15.1.2" xref="S4.E5.m1.1.15.1.2.cmml">n</mi><mo stretchy="false" id="S4.E5.m1.1.15.1.3" xref="S4.E5.m1.1.33.2.2.1.2.2.2.cmml">)</mo></mrow></msup><mo id="S4.E5.m1.1.33.2.2.1.2.2.1" xref="S4.E5.m1.1.33.2.2.1.2.2.1.cmml">⁢</mo><mrow id="S4.E5.m1.1.33.2.2.1.2.2.3" xref="S4.E5.m1.1.33.2.2.1.2.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.16" xref="S4.E5.m1.1.33.2.2.1.2.2.cmml">(</mo><mi id="S4.E5.m1.1.17" xref="S4.E5.m1.1.17.cmml">x</mi><mo stretchy="false" id="S4.E5.m1.1.18" xref="S4.E5.m1.1.33.2.2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.1.19" xref="S4.E5.m1.1.33.2.2.1.2.1.cmml">,</mo><mi id="S4.E5.m1.1.20" xref="S4.E5.m1.1.20.cmml">F</mi><mo id="S4.E5.m1.1.21" xref="S4.E5.m1.1.33.2.2.1.2.1.cmml">,</mo><msup id="S4.E5.m1.1.33.2.2.1.2.3" xref="S4.E5.m1.1.33.2.2.1.2.3.cmml"><mi id="S4.E5.m1.1.22" xref="S4.E5.m1.1.22.cmml">θ</mi><mrow id="S4.E5.m1.1.23.1" xref="S4.E5.m1.1.33.2.2.1.2.3.cmml"><mo stretchy="false" id="S4.E5.m1.1.23.1.1" xref="S4.E5.m1.1.33.2.2.1.2.3.cmml">(</mo><mi id="S4.E5.m1.1.23.1.2" xref="S4.E5.m1.1.23.1.2.cmml">n</mi><mo stretchy="false" id="S4.E5.m1.1.23.1.3" xref="S4.E5.m1.1.33.2.2.1.2.3.cmml">)</mo></mrow></msup><mo stretchy="false" id="S4.E5.m1.1.24" xref="S4.E5.m1.1.33.2.2.1.2.1.cmml">)</mo></mrow></mrow><mo id="S4.E5.m1.1.25" xref="S4.E5.m1.1.25.cmml">+</mo><mrow id="S4.E5.m1.1.33.2.2.2" xref="S4.E5.m1.1.33.2.2.2.cmml"><msubsup id="S4.E5.m1.1.33.2.2.2.2" xref="S4.E5.m1.1.33.2.2.2.2.cmml"><mi id="S4.E5.m1.1.26" xref="S4.E5.m1.1.26.cmml">I</mi><mi id="S4.E5.m1.1.28.1" xref="S4.E5.m1.1.28.1.cmml">d</mi><mrow id="S4.E5.m1.1.27.1" xref="S4.E5.m1.1.33.2.2.2.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.27.1.1" xref="S4.E5.m1.1.33.2.2.2.2.cmml">(</mo><mi id="S4.E5.m1.1.27.1.2" xref="S4.E5.m1.1.27.1.2.cmml">n</mi><mo stretchy="false" id="S4.E5.m1.1.27.1.3" xref="S4.E5.m1.1.33.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S4.E5.m1.1.33.2.2.2.1" xref="S4.E5.m1.1.33.2.2.2.1.cmml">⁢</mo><mrow id="S4.E5.m1.1.33.2.2.2.3" xref="S4.E5.m1.1.33.2.2.2.cmml"><mo stretchy="false" id="S4.E5.m1.1.29" xref="S4.E5.m1.1.33.2.2.2.cmml">(</mo><mi id="S4.E5.m1.1.30" xref="S4.E5.m1.1.30.cmml">x</mi><mo stretchy="false" id="S4.E5.m1.1.31" xref="S4.E5.m1.1.33.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S4.E5.m1.1.32" xref="S4.E5.m1.1.33.2.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.33.2.cmml" xref="S4.E5.m1.1.33"><eq id="S4.E5.m1.1.6.cmml" xref="S4.E5.m1.1.6"></eq><apply id="S4.E5.m1.1.33.2.1.cmml" xref="S4.E5.m1.1.33.2.1"><times id="S4.E5.m1.1.33.2.1.1.cmml" xref="S4.E5.m1.1.33.2.1.1"></times><apply id="S4.E5.m1.1.33.2.1.2.cmml" xref="S4.E5.m1.1.33.2.1.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.33.2.1.2.1.cmml" xref="S4.E5.m1.1.33.2.1.2">superscript</csymbol><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝐼</ci><ci id="S4.E5.m1.1.2.1.2.cmml" xref="S4.E5.m1.1.2.1.2">𝑛</ci></apply><ci id="S4.E5.m1.1.4.cmml" xref="S4.E5.m1.1.4">𝑥</ci></apply><apply id="S4.E5.m1.1.33.2.2.cmml" xref="S4.E5.m1.1.33.2.2"><plus id="S4.E5.m1.1.25.cmml" xref="S4.E5.m1.1.25"></plus><apply id="S4.E5.m1.1.33.2.2.1.cmml" xref="S4.E5.m1.1.33.2.2.1"><times id="S4.E5.m1.1.33.2.2.1.1.cmml" xref="S4.E5.m1.1.33.2.2.1.1"></times><ci id="S4.E5.m1.1.12.cmml" xref="S4.E5.m1.1.12">render</ci><vector id="S4.E5.m1.1.33.2.2.1.2.1.cmml" xref="S4.E5.m1.1.33.2.2.1.2"><apply id="S4.E5.m1.1.33.2.2.1.2.2.cmml" xref="S4.E5.m1.1.33.2.2.1.2.2"><times id="S4.E5.m1.1.33.2.2.1.2.2.1.cmml" xref="S4.E5.m1.1.33.2.2.1.2.2.1"></times><apply id="S4.E5.m1.1.33.2.2.1.2.2.2.cmml" xref="S4.E5.m1.1.33.2.2.1.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.33.2.2.1.2.2.2.1.cmml" xref="S4.E5.m1.1.33.2.2.1.2.2.2">superscript</csymbol><ci id="S4.E5.m1.1.14.cmml" xref="S4.E5.m1.1.14">𝜌</ci><ci id="S4.E5.m1.1.15.1.2.cmml" xref="S4.E5.m1.1.15.1.2">𝑛</ci></apply><ci id="S4.E5.m1.1.17.cmml" xref="S4.E5.m1.1.17">𝑥</ci></apply><ci id="S4.E5.m1.1.20.cmml" xref="S4.E5.m1.1.20">𝐹</ci><apply id="S4.E5.m1.1.33.2.2.1.2.3.cmml" xref="S4.E5.m1.1.33.2.2.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.33.2.2.1.2.3.1.cmml" xref="S4.E5.m1.1.33.2.2.1.2.3">superscript</csymbol><ci id="S4.E5.m1.1.22.cmml" xref="S4.E5.m1.1.22">𝜃</ci><ci id="S4.E5.m1.1.23.1.2.cmml" xref="S4.E5.m1.1.23.1.2">𝑛</ci></apply></vector></apply><apply id="S4.E5.m1.1.33.2.2.2.cmml" xref="S4.E5.m1.1.33.2.2.2"><times id="S4.E5.m1.1.33.2.2.2.1.cmml" xref="S4.E5.m1.1.33.2.2.2.1"></times><apply id="S4.E5.m1.1.33.2.2.2.2.cmml" xref="S4.E5.m1.1.33.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.33.2.2.2.2.1.cmml" xref="S4.E5.m1.1.33.2.2.2.2">subscript</csymbol><apply id="S4.E5.m1.1.33.2.2.2.2.2.cmml" xref="S4.E5.m1.1.33.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.33.2.2.2.2.2.1.cmml" xref="S4.E5.m1.1.33.2.2.2.2">superscript</csymbol><ci id="S4.E5.m1.1.26.cmml" xref="S4.E5.m1.1.26">𝐼</ci><ci id="S4.E5.m1.1.27.1.2.cmml" xref="S4.E5.m1.1.27.1.2">𝑛</ci></apply><ci id="S4.E5.m1.1.28.1.cmml" xref="S4.E5.m1.1.28.1">𝑑</ci></apply><ci id="S4.E5.m1.1.30.cmml" xref="S4.E5.m1.1.30">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.E5.m1.1c">italic-I POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:) RELOP:equals render OPEN:( italic-rho POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:) PUNCT:, italic-F PUNCT:, italic-theta POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end CLOSE:) ADDOP:plus italic-I POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end OPEN:( italic-x CLOSE:) PUNCT:,</annotation><annotation encoding="application/x-tex" id="S4.E5.m1.1d">I^{(n)}(x)=\mathrm{render}(\rho^{(n)}(x),F,\theta^{(n)})+I^{(n)}_{d}(x),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr>
</table>
<p id="S4.p1.2" class="ltx_p">where <math id="S4.p1.2.m1.1" class="ltx_Math" alttext="\theta^{(n)}" display="inline"><semantics id="S4.p1.2.m1.1a"><msup id="S4.p1.2.m1.1.3" xref="S4.p1.2.m1.1.3.cmml"><mi id="S4.p1.2.m1.1.1" xref="S4.p1.2.m1.1.1.cmml">θ</mi><mrow id="S4.p1.2.m1.1.2.1" xref="S4.p1.2.m1.1.3.cmml"><mo stretchy="false" id="S4.p1.2.m1.1.2.1.1" xref="S4.p1.2.m1.1.3.cmml">(</mo><mi id="S4.p1.2.m1.1.2.1.2" xref="S4.p1.2.m1.1.2.1.2.cmml">n</mi><mo stretchy="false" id="S4.p1.2.m1.1.2.1.3" xref="S4.p1.2.m1.1.3.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p1.2.m1.1b"><apply id="S4.p1.2.m1.1.3.cmml" xref="S4.p1.2.m1.1.3"><csymbol cd="ambiguous" id="S4.p1.2.m1.1.3.1.cmml" xref="S4.p1.2.m1.1.3">superscript</csymbol><ci id="S4.p1.2.m1.1.1.cmml" xref="S4.p1.2.m1.1.1">𝜃</ci><ci id="S4.p1.2.m1.1.2.1.2.cmml" xref="S4.p1.2.m1.1.2.1.2">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.p1.2.m1.1c">italic-theta POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.p1.2.m1.1d">\theta^{(n)}</annotation></semantics></math> represents the new illumination, <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="I^{(n)}_{d}(x)" display="inline"><semantics id="S4.p1.2.m2.1a"><mrow id="S4.p1.2.m2.1.7" xref="S4.p1.2.m2.1.7.cmml"><msubsup id="S4.p1.2.m2.1.7.2" xref="S4.p1.2.m2.1.7.2.cmml"><mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">I</mi><mi id="S4.p1.2.m2.1.3.1" xref="S4.p1.2.m2.1.3.1.cmml">d</mi><mrow id="S4.p1.2.m2.1.2.1" xref="S4.p1.2.m2.1.7.2.cmml"><mo stretchy="false" id="S4.p1.2.m2.1.2.1.1" xref="S4.p1.2.m2.1.7.2.cmml">(</mo><mi id="S4.p1.2.m2.1.2.1.2" xref="S4.p1.2.m2.1.2.1.2.cmml">n</mi><mo stretchy="false" id="S4.p1.2.m2.1.2.1.3" xref="S4.p1.2.m2.1.7.2.cmml">)</mo></mrow></msubsup><mo id="S4.p1.2.m2.1.7.1" xref="S4.p1.2.m2.1.7.1.cmml">⁢</mo><mrow id="S4.p1.2.m2.1.7.3" xref="S4.p1.2.m2.1.7.cmml"><mo stretchy="false" id="S4.p1.2.m2.1.4" xref="S4.p1.2.m2.1.7.cmml">(</mo><mi id="S4.p1.2.m2.1.5" xref="S4.p1.2.m2.1.5.cmml">x</mi><mo stretchy="false" id="S4.p1.2.m2.1.6" xref="S4.p1.2.m2.1.7.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.7.cmml" xref="S4.p1.2.m2.1.7"><times id="S4.p1.2.m2.1.7.1.cmml" xref="S4.p1.2.m2.1.7.1"></times><apply id="S4.p1.2.m2.1.7.2.cmml" xref="S4.p1.2.m2.1.7.2"><csymbol cd="ambiguous" id="S4.p1.2.m2.1.7.2.1.cmml" xref="S4.p1.2.m2.1.7.2">subscript</csymbol><apply id="S4.p1.2.m2.1.7.2.2.cmml" xref="S4.p1.2.m2.1.7.2"><csymbol cd="ambiguous" id="S4.p1.2.m2.1.7.2.2.1.cmml" xref="S4.p1.2.m2.1.7.2">superscript</csymbol><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">𝐼</ci><ci id="S4.p1.2.m2.1.2.1.2.cmml" xref="S4.p1.2.m2.1.2.1.2">𝑛</ci></apply><ci id="S4.p1.2.m2.1.3.1.cmml" xref="S4.p1.2.m2.1.3.1">𝑑</ci></apply><ci id="S4.p1.2.m2.1.5.cmml" xref="S4.p1.2.m2.1.5">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.p1.2.m2.1c">italic-I POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.p1.2.m2.1d">I^{(n)}_{d}(x)</annotation></semantics></math> is a (potentially) new detail map, and <math id="S4.p1.2.m3.1" class="ltx_Math" alttext="\rho^{(n)}(x)" display="inline"><semantics id="S4.p1.2.m3.1a"><mrow id="S4.p1.2.m3.1.6" xref="S4.p1.2.m3.1.6.cmml"><msup id="S4.p1.2.m3.1.6.2" xref="S4.p1.2.m3.1.6.2.cmml"><mi id="S4.p1.2.m3.1.1" xref="S4.p1.2.m3.1.1.cmml">ρ</mi><mrow id="S4.p1.2.m3.1.2.1" xref="S4.p1.2.m3.1.6.2.cmml"><mo stretchy="false" id="S4.p1.2.m3.1.2.1.1" xref="S4.p1.2.m3.1.6.2.cmml">(</mo><mi id="S4.p1.2.m3.1.2.1.2" xref="S4.p1.2.m3.1.2.1.2.cmml">n</mi><mo stretchy="false" id="S4.p1.2.m3.1.2.1.3" xref="S4.p1.2.m3.1.6.2.cmml">)</mo></mrow></msup><mo id="S4.p1.2.m3.1.6.1" xref="S4.p1.2.m3.1.6.1.cmml">⁢</mo><mrow id="S4.p1.2.m3.1.6.3" xref="S4.p1.2.m3.1.6.cmml"><mo stretchy="false" id="S4.p1.2.m3.1.3" xref="S4.p1.2.m3.1.6.cmml">(</mo><mi id="S4.p1.2.m3.1.4" xref="S4.p1.2.m3.1.4.cmml">x</mi><mo stretchy="false" id="S4.p1.2.m3.1.5" xref="S4.p1.2.m3.1.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m3.1b"><apply id="S4.p1.2.m3.1.6.cmml" xref="S4.p1.2.m3.1.6"><times id="S4.p1.2.m3.1.6.1.cmml" xref="S4.p1.2.m3.1.6.1"></times><apply id="S4.p1.2.m3.1.6.2.cmml" xref="S4.p1.2.m3.1.6.2"><csymbol cd="ambiguous" id="S4.p1.2.m3.1.6.2.1.cmml" xref="S4.p1.2.m3.1.6.2">superscript</csymbol><ci id="S4.p1.2.m3.1.1.cmml" xref="S4.p1.2.m3.1.1">𝜌</ci><ci id="S4.p1.2.m3.1.2.1.2.cmml" xref="S4.p1.2.m3.1.2.1.2">𝑛</ci></apply><ci id="S4.p1.2.m3.1.4.cmml" xref="S4.p1.2.m3.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.p1.2.m3.1c">italic-rho POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.p1.2.m3.1d">\rho^{(n)}(x)</annotation></semantics></math> represents new albedo.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Face Relighting</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">Since we have already reconstructed the face albedo and geometry, we can render the face with different lighting effects. Our current implementation supports three distinct types of lights: SH lighting, directional lights, and colored spot lights. SH lighting is our primary source of light, and it enables soft lighting effects <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. For other light types (i.e., directional and spotlight) we support casting shadows by leveraging the geometry stored in a depth buffer. For colored spot lights, we separate shading into three distinct channels to allow for finer grain control of light color.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para ltx_noindent">
<p id="S4.SS1.p2.1" class="ltx_p"><span id="S4.SS1.p2.1.1" class="ltx_text ltx_font_bold">Rendering and compositing non-face pixels:</span>
While we estimate the albedo at every pixel of the image, we reconstruct geometry only on face pixels. This means that we can only render new shading inside face region, and we must extend this information to cover other regions of the image such as neck, ears and background. We assign each pixel outside the face mask to its nearest shading value inside the face mask, and then smooth the shading.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">This gives us the new shading field <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="s^{(n)}(x)" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mrow id="S4.SS1.p3.1.m1.1.6" xref="S4.SS1.p3.1.m1.1.6.cmml"><msup id="S4.SS1.p3.1.m1.1.6.2" xref="S4.SS1.p3.1.m1.1.6.2.cmml"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">s</mi><mrow id="S4.SS1.p3.1.m1.1.2.1" xref="S4.SS1.p3.1.m1.1.6.2.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.1.2.1.1" xref="S4.SS1.p3.1.m1.1.6.2.cmml">(</mo><mi id="S4.SS1.p3.1.m1.1.2.1.2" xref="S4.SS1.p3.1.m1.1.2.1.2.cmml">n</mi><mo stretchy="false" id="S4.SS1.p3.1.m1.1.2.1.3" xref="S4.SS1.p3.1.m1.1.6.2.cmml">)</mo></mrow></msup><mo id="S4.SS1.p3.1.m1.1.6.1" xref="S4.SS1.p3.1.m1.1.6.1.cmml">⁢</mo><mrow id="S4.SS1.p3.1.m1.1.6.3" xref="S4.SS1.p3.1.m1.1.6.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m1.1.3" xref="S4.SS1.p3.1.m1.1.6.cmml">(</mo><mi id="S4.SS1.p3.1.m1.1.4" xref="S4.SS1.p3.1.m1.1.4.cmml">x</mi><mo stretchy="false" id="S4.SS1.p3.1.m1.1.5" xref="S4.SS1.p3.1.m1.1.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><apply id="S4.SS1.p3.1.m1.1.6.cmml" xref="S4.SS1.p3.1.m1.1.6"><times id="S4.SS1.p3.1.m1.1.6.1.cmml" xref="S4.SS1.p3.1.m1.1.6.1"></times><apply id="S4.SS1.p3.1.m1.1.6.2.cmml" xref="S4.SS1.p3.1.m1.1.6.2"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.6.2.1.cmml" xref="S4.SS1.p3.1.m1.1.6.2">superscript</csymbol><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝑠</ci><ci id="S4.SS1.p3.1.m1.1.2.1.2.cmml" xref="S4.SS1.p3.1.m1.1.2.1.2">𝑛</ci></apply><ci id="S4.SS1.p3.1.m1.1.4.cmml" xref="S4.SS1.p3.1.m1.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1c">italic-s POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1d">s^{(n)}(x)</annotation></semantics></math> across the full image. In addition, we also have the original reconstructed shading, <math id="S4.SS1.p3.1.m2.1" class="ltx_Math" alttext="s(x)" display="inline"><semantics id="S4.SS1.p3.1.m2.1a"><mrow id="S4.SS1.p3.1.m2.1.5" xref="S4.SS1.p3.1.m2.1.5.cmml"><mi id="S4.SS1.p3.1.m2.1.1" xref="S4.SS1.p3.1.m2.1.1.cmml">s</mi><mo id="S4.SS1.p3.1.m2.1.5.1" xref="S4.SS1.p3.1.m2.1.5.1.cmml">⁢</mo><mrow id="S4.SS1.p3.1.m2.1.5.2" xref="S4.SS1.p3.1.m2.1.5.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m2.1.2" xref="S4.SS1.p3.1.m2.1.5.cmml">(</mo><mi id="S4.SS1.p3.1.m2.1.3" xref="S4.SS1.p3.1.m2.1.3.cmml">x</mi><mo stretchy="false" id="S4.SS1.p3.1.m2.1.4" xref="S4.SS1.p3.1.m2.1.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m2.1b"><apply id="S4.SS1.p3.1.m2.1.5.cmml" xref="S4.SS1.p3.1.m2.1.5"><times id="S4.SS1.p3.1.m2.1.5.1.cmml" xref="S4.SS1.p3.1.m2.1.5.1"></times><ci id="S4.SS1.p3.1.m2.1.1.cmml" xref="S4.SS1.p3.1.m2.1.1">𝑠</ci><ci id="S4.SS1.p3.1.m2.1.3.cmml" xref="S4.SS1.p3.1.m2.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m2.1c">italic-s OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m2.1d">s(x)</annotation></semantics></math>. We blend the two shading fields
differently according to different labels. For face region, new shading <math id="S4.SS1.p3.1.m3.1" class="ltx_Math" alttext="s^{(n)}(x)" display="inline"><semantics id="S4.SS1.p3.1.m3.1a"><mrow id="S4.SS1.p3.1.m3.1.6" xref="S4.SS1.p3.1.m3.1.6.cmml"><msup id="S4.SS1.p3.1.m3.1.6.2" xref="S4.SS1.p3.1.m3.1.6.2.cmml"><mi id="S4.SS1.p3.1.m3.1.1" xref="S4.SS1.p3.1.m3.1.1.cmml">s</mi><mrow id="S4.SS1.p3.1.m3.1.2.1" xref="S4.SS1.p3.1.m3.1.6.2.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m3.1.2.1.1" xref="S4.SS1.p3.1.m3.1.6.2.cmml">(</mo><mi id="S4.SS1.p3.1.m3.1.2.1.2" xref="S4.SS1.p3.1.m3.1.2.1.2.cmml">n</mi><mo stretchy="false" id="S4.SS1.p3.1.m3.1.2.1.3" xref="S4.SS1.p3.1.m3.1.6.2.cmml">)</mo></mrow></msup><mo id="S4.SS1.p3.1.m3.1.6.1" xref="S4.SS1.p3.1.m3.1.6.1.cmml">⁢</mo><mrow id="S4.SS1.p3.1.m3.1.6.3" xref="S4.SS1.p3.1.m3.1.6.cmml"><mo stretchy="false" id="S4.SS1.p3.1.m3.1.3" xref="S4.SS1.p3.1.m3.1.6.cmml">(</mo><mi id="S4.SS1.p3.1.m3.1.4" xref="S4.SS1.p3.1.m3.1.4.cmml">x</mi><mo stretchy="false" id="S4.SS1.p3.1.m3.1.5" xref="S4.SS1.p3.1.m3.1.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m3.1b"><apply id="S4.SS1.p3.1.m3.1.6.cmml" xref="S4.SS1.p3.1.m3.1.6"><times id="S4.SS1.p3.1.m3.1.6.1.cmml" xref="S4.SS1.p3.1.m3.1.6.1"></times><apply id="S4.SS1.p3.1.m3.1.6.2.cmml" xref="S4.SS1.p3.1.m3.1.6.2"><csymbol cd="ambiguous" id="S4.SS1.p3.1.m3.1.6.2.1.cmml" xref="S4.SS1.p3.1.m3.1.6.2">superscript</csymbol><ci id="S4.SS1.p3.1.m3.1.1.cmml" xref="S4.SS1.p3.1.m3.1.1">𝑠</ci><ci id="S4.SS1.p3.1.m3.1.2.1.2.cmml" xref="S4.SS1.p3.1.m3.1.2.1.2">𝑛</ci></apply><ci id="S4.SS1.p3.1.m3.1.4.cmml" xref="S4.SS1.p3.1.m3.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m3.1c">italic-s POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m3.1d">s^{(n)}(x)</annotation></semantics></math> is used. Hair has a characteristic specular appearance, and in order to preserve it, we retains
more of the original shading at bright pixels (which are more likely to be specular highlights). The shading for the background is a constant mixture. The final shading is smoothly blended
from the three areas.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para ltx_noindent">
<p id="S4.SS1.p4.1" class="ltx_p"><span id="S4.SS1.p4.1.1" class="ltx_text ltx_font_bold">Scattering:</span>
There are subsurface scattering effects <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> on human faces, but this is expensive to simulate exactly. We simulate this effect by
smoothing the rendered shading field. Comparison figures both with and without smoothing is provided in the supplementary materials.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Makeup Transfer</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We transfer makeup effects from a reference face to an input face. We want our results to meet these important qualitative criteria:
<span id="S4.SS2.p1.1.1" class="ltx_text ltx_font_bold">Faithfulness:</span> result images should preserve the input’s distinctive facial features, particularly around the eyes, nose, and lips.
<span id="S4.SS2.p1.1.2" class="ltx_text ltx_font_bold">Realism:</span> the transferred makeup should look like real makeup, so that caking, finger smears, powder texture and so on should be preserved;
and relit images should look like pictures taken under a real illumination field.
<span id="S4.SS2.p1.1.3" class="ltx_text ltx_font_bold">Predictability:</span> the pattern, color and qualitative appearance of the transferred makeup should look like the reference.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">To transfer colored patterns, we need to replace input image albedo <math id="S4.SS2.p2.1.m1.1" class="ltx_Math" alttext="\rho^{(i)}(x)" display="inline"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.6" xref="S4.SS2.p2.1.m1.1.6.cmml"><msup id="S4.SS2.p2.1.m1.1.6.2" xref="S4.SS2.p2.1.m1.1.6.2.cmml"><mi id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml">ρ</mi><mrow id="S4.SS2.p2.1.m1.1.2.1" xref="S4.SS2.p2.1.m1.1.6.2.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m1.1.2.1.1" xref="S4.SS2.p2.1.m1.1.6.2.cmml">(</mo><mi id="S4.SS2.p2.1.m1.1.2.1.2" xref="S4.SS2.p2.1.m1.1.2.1.2.cmml">i</mi><mo stretchy="false" id="S4.SS2.p2.1.m1.1.2.1.3" xref="S4.SS2.p2.1.m1.1.6.2.cmml">)</mo></mrow></msup><mo id="S4.SS2.p2.1.m1.1.6.1" xref="S4.SS2.p2.1.m1.1.6.1.cmml">⁢</mo><mrow id="S4.SS2.p2.1.m1.1.6.3" xref="S4.SS2.p2.1.m1.1.6.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m1.1.3" xref="S4.SS2.p2.1.m1.1.6.cmml">(</mo><mi id="S4.SS2.p2.1.m1.1.4" xref="S4.SS2.p2.1.m1.1.4.cmml">x</mi><mo stretchy="false" id="S4.SS2.p2.1.m1.1.5" xref="S4.SS2.p2.1.m1.1.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.6.cmml" xref="S4.SS2.p2.1.m1.1.6"><times id="S4.SS2.p2.1.m1.1.6.1.cmml" xref="S4.SS2.p2.1.m1.1.6.1"></times><apply id="S4.SS2.p2.1.m1.1.6.2.cmml" xref="S4.SS2.p2.1.m1.1.6.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.6.2.1.cmml" xref="S4.SS2.p2.1.m1.1.6.2">superscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1">𝜌</ci><ci id="S4.SS2.p2.1.m1.1.2.1.2.cmml" xref="S4.SS2.p2.1.m1.1.2.1.2">𝑖</ci></apply><ci id="S4.SS2.p2.1.m1.1.4.cmml" xref="S4.SS2.p2.1.m1.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1c">italic-rho POSTSUPERSCRIPT:start OPEN:( italic-i CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1d">\rho^{(i)}(x)</annotation></semantics></math> with reference albedo
<math id="S4.SS2.p2.1.m2.1" class="ltx_Math" alttext="\rho^{(r)}(x)" display="inline"><semantics id="S4.SS2.p2.1.m2.1a"><mrow id="S4.SS2.p2.1.m2.1.6" xref="S4.SS2.p2.1.m2.1.6.cmml"><msup id="S4.SS2.p2.1.m2.1.6.2" xref="S4.SS2.p2.1.m2.1.6.2.cmml"><mi id="S4.SS2.p2.1.m2.1.1" xref="S4.SS2.p2.1.m2.1.1.cmml">ρ</mi><mrow id="S4.SS2.p2.1.m2.1.2.1" xref="S4.SS2.p2.1.m2.1.6.2.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m2.1.2.1.1" xref="S4.SS2.p2.1.m2.1.6.2.cmml">(</mo><mi id="S4.SS2.p2.1.m2.1.2.1.2" xref="S4.SS2.p2.1.m2.1.2.1.2.cmml">r</mi><mo stretchy="false" id="S4.SS2.p2.1.m2.1.2.1.3" xref="S4.SS2.p2.1.m2.1.6.2.cmml">)</mo></mrow></msup><mo id="S4.SS2.p2.1.m2.1.6.1" xref="S4.SS2.p2.1.m2.1.6.1.cmml">⁢</mo><mrow id="S4.SS2.p2.1.m2.1.6.3" xref="S4.SS2.p2.1.m2.1.6.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m2.1.3" xref="S4.SS2.p2.1.m2.1.6.cmml">(</mo><mi id="S4.SS2.p2.1.m2.1.4" xref="S4.SS2.p2.1.m2.1.4.cmml">x</mi><mo stretchy="false" id="S4.SS2.p2.1.m2.1.5" xref="S4.SS2.p2.1.m2.1.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m2.1b"><apply id="S4.SS2.p2.1.m2.1.6.cmml" xref="S4.SS2.p2.1.m2.1.6"><times id="S4.SS2.p2.1.m2.1.6.1.cmml" xref="S4.SS2.p2.1.m2.1.6.1"></times><apply id="S4.SS2.p2.1.m2.1.6.2.cmml" xref="S4.SS2.p2.1.m2.1.6.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m2.1.6.2.1.cmml" xref="S4.SS2.p2.1.m2.1.6.2">superscript</csymbol><ci id="S4.SS2.p2.1.m2.1.1.cmml" xref="S4.SS2.p2.1.m2.1.1">𝜌</ci><ci id="S4.SS2.p2.1.m2.1.2.1.2.cmml" xref="S4.SS2.p2.1.m2.1.2.1.2">𝑟</ci></apply><ci id="S4.SS2.p2.1.m2.1.4.cmml" xref="S4.SS2.p2.1.m2.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m2.1c">italic-rho POSTSUPERSCRIPT:start OPEN:( italic-r CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m2.1d">\rho^{(r)}(x)</annotation></semantics></math> for most regions of the face. Define <math id="S4.SS2.p2.1.m3.1" class="ltx_Math" alttext="I_{d}^{b(i,r)}" display="inline"><semantics id="S4.SS2.p2.1.m3.1a"><msubsup id="S4.SS2.p2.1.m3.1.4" xref="S4.SS2.p2.1.m3.1.4.cmml"><mi id="S4.SS2.p2.1.m3.1.1" xref="S4.SS2.p2.1.m3.1.1.cmml">I</mi><mi id="S4.SS2.p2.1.m3.1.2.1" xref="S4.SS2.p2.1.m3.1.2.1.cmml">d</mi><mrow id="S4.SS2.p2.1.m3.1.3.1" xref="S4.SS2.p2.1.m3.1.3.1.cmml"><mi id="S4.SS2.p2.1.m3.1.3.1.1" xref="S4.SS2.p2.1.m3.1.3.1.1.cmml">b</mi><mo id="S4.SS2.p2.1.m3.1.3.1.7" xref="S4.SS2.p2.1.m3.1.3.1.7.cmml">⁢</mo><mrow id="S4.SS2.p2.1.m3.1.3.1.8" xref="S4.SS2.p2.1.m3.1.3.1.8.1.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m3.1.3.1.2" xref="S4.SS2.p2.1.m3.1.3.1.8.1.cmml">(</mo><mi id="S4.SS2.p2.1.m3.1.3.1.3" xref="S4.SS2.p2.1.m3.1.3.1.3.cmml">i</mi><mo id="S4.SS2.p2.1.m3.1.3.1.4" xref="S4.SS2.p2.1.m3.1.3.1.8.1.cmml">,</mo><mi id="S4.SS2.p2.1.m3.1.3.1.5" xref="S4.SS2.p2.1.m3.1.3.1.5.cmml">r</mi><mo stretchy="false" id="S4.SS2.p2.1.m3.1.3.1.6" xref="S4.SS2.p2.1.m3.1.3.1.8.1.cmml">)</mo></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m3.1b"><apply id="S4.SS2.p2.1.m3.1.4.cmml" xref="S4.SS2.p2.1.m3.1.4"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m3.1.4.1.cmml" xref="S4.SS2.p2.1.m3.1.4">superscript</csymbol><apply id="S4.SS2.p2.1.m3.1.4.2.cmml" xref="S4.SS2.p2.1.m3.1.4"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m3.1.4.2.1.cmml" xref="S4.SS2.p2.1.m3.1.4">subscript</csymbol><ci id="S4.SS2.p2.1.m3.1.1.cmml" xref="S4.SS2.p2.1.m3.1.1">𝐼</ci><ci id="S4.SS2.p2.1.m3.1.2.1.cmml" xref="S4.SS2.p2.1.m3.1.2.1">𝑑</ci></apply><apply id="S4.SS2.p2.1.m3.1.3.1.cmml" xref="S4.SS2.p2.1.m3.1.3.1"><times id="S4.SS2.p2.1.m3.1.3.1.7.cmml" xref="S4.SS2.p2.1.m3.1.3.1.7"></times><ci id="S4.SS2.p2.1.m3.1.3.1.1.cmml" xref="S4.SS2.p2.1.m3.1.3.1.1">𝑏</ci><interval closure="open" id="S4.SS2.p2.1.m3.1.3.1.8.1.cmml" xref="S4.SS2.p2.1.m3.1.3.1.8"><ci id="S4.SS2.p2.1.m3.1.3.1.3.cmml" xref="S4.SS2.p2.1.m3.1.3.1.3">𝑖</ci><ci id="S4.SS2.p2.1.m3.1.3.1.5.cmml" xref="S4.SS2.p2.1.m3.1.3.1.5">𝑟</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m3.1c">italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end POSTSUPERSCRIPT:start italic-b OPEN:( italic-i PUNCT:, italic-r CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m3.1d">I_{d}^{b(i,r)}</annotation></semantics></math> as a detail map somehow blended by input face detail map <math id="S4.SS2.p2.1.m4.1" class="ltx_Math" alttext="I_{d}^{(i)}(x)" display="inline"><semantics id="S4.SS2.p2.1.m4.1a"><mrow id="S4.SS2.p2.1.m4.1.7" xref="S4.SS2.p2.1.m4.1.7.cmml"><msubsup id="S4.SS2.p2.1.m4.1.7.2" xref="S4.SS2.p2.1.m4.1.7.2.cmml"><mi id="S4.SS2.p2.1.m4.1.1" xref="S4.SS2.p2.1.m4.1.1.cmml">I</mi><mi id="S4.SS2.p2.1.m4.1.2.1" xref="S4.SS2.p2.1.m4.1.2.1.cmml">d</mi><mrow id="S4.SS2.p2.1.m4.1.3.1" xref="S4.SS2.p2.1.m4.1.7.2.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m4.1.3.1.1" xref="S4.SS2.p2.1.m4.1.7.2.cmml">(</mo><mi id="S4.SS2.p2.1.m4.1.3.1.2" xref="S4.SS2.p2.1.m4.1.3.1.2.cmml">i</mi><mo stretchy="false" id="S4.SS2.p2.1.m4.1.3.1.3" xref="S4.SS2.p2.1.m4.1.7.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.p2.1.m4.1.7.1" xref="S4.SS2.p2.1.m4.1.7.1.cmml">⁢</mo><mrow id="S4.SS2.p2.1.m4.1.7.3" xref="S4.SS2.p2.1.m4.1.7.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m4.1.4" xref="S4.SS2.p2.1.m4.1.7.cmml">(</mo><mi id="S4.SS2.p2.1.m4.1.5" xref="S4.SS2.p2.1.m4.1.5.cmml">x</mi><mo stretchy="false" id="S4.SS2.p2.1.m4.1.6" xref="S4.SS2.p2.1.m4.1.7.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m4.1b"><apply id="S4.SS2.p2.1.m4.1.7.cmml" xref="S4.SS2.p2.1.m4.1.7"><times id="S4.SS2.p2.1.m4.1.7.1.cmml" xref="S4.SS2.p2.1.m4.1.7.1"></times><apply id="S4.SS2.p2.1.m4.1.7.2.cmml" xref="S4.SS2.p2.1.m4.1.7.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m4.1.7.2.1.cmml" xref="S4.SS2.p2.1.m4.1.7.2">superscript</csymbol><apply id="S4.SS2.p2.1.m4.1.7.2.2.cmml" xref="S4.SS2.p2.1.m4.1.7.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m4.1.7.2.2.1.cmml" xref="S4.SS2.p2.1.m4.1.7.2">subscript</csymbol><ci id="S4.SS2.p2.1.m4.1.1.cmml" xref="S4.SS2.p2.1.m4.1.1">𝐼</ci><ci id="S4.SS2.p2.1.m4.1.2.1.cmml" xref="S4.SS2.p2.1.m4.1.2.1">𝑑</ci></apply><ci id="S4.SS2.p2.1.m4.1.3.1.2.cmml" xref="S4.SS2.p2.1.m4.1.3.1.2">𝑖</ci></apply><ci id="S4.SS2.p2.1.m4.1.5.cmml" xref="S4.SS2.p2.1.m4.1.5">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m4.1c">italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end POSTSUPERSCRIPT:start OPEN:( italic-i CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m4.1d">I_{d}^{(i)}(x)</annotation></semantics></math> and reference detail map
<math id="S4.SS2.p2.1.m5.1" class="ltx_Math" alttext="I_{d}^{(r)}(x)" display="inline"><semantics id="S4.SS2.p2.1.m5.1a"><mrow id="S4.SS2.p2.1.m5.1.7" xref="S4.SS2.p2.1.m5.1.7.cmml"><msubsup id="S4.SS2.p2.1.m5.1.7.2" xref="S4.SS2.p2.1.m5.1.7.2.cmml"><mi id="S4.SS2.p2.1.m5.1.1" xref="S4.SS2.p2.1.m5.1.1.cmml">I</mi><mi id="S4.SS2.p2.1.m5.1.2.1" xref="S4.SS2.p2.1.m5.1.2.1.cmml">d</mi><mrow id="S4.SS2.p2.1.m5.1.3.1" xref="S4.SS2.p2.1.m5.1.7.2.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m5.1.3.1.1" xref="S4.SS2.p2.1.m5.1.7.2.cmml">(</mo><mi id="S4.SS2.p2.1.m5.1.3.1.2" xref="S4.SS2.p2.1.m5.1.3.1.2.cmml">r</mi><mo stretchy="false" id="S4.SS2.p2.1.m5.1.3.1.3" xref="S4.SS2.p2.1.m5.1.7.2.cmml">)</mo></mrow></msubsup><mo id="S4.SS2.p2.1.m5.1.7.1" xref="S4.SS2.p2.1.m5.1.7.1.cmml">⁢</mo><mrow id="S4.SS2.p2.1.m5.1.7.3" xref="S4.SS2.p2.1.m5.1.7.cmml"><mo stretchy="false" id="S4.SS2.p2.1.m5.1.4" xref="S4.SS2.p2.1.m5.1.7.cmml">(</mo><mi id="S4.SS2.p2.1.m5.1.5" xref="S4.SS2.p2.1.m5.1.5.cmml">x</mi><mo stretchy="false" id="S4.SS2.p2.1.m5.1.6" xref="S4.SS2.p2.1.m5.1.7.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m5.1b"><apply id="S4.SS2.p2.1.m5.1.7.cmml" xref="S4.SS2.p2.1.m5.1.7"><times id="S4.SS2.p2.1.m5.1.7.1.cmml" xref="S4.SS2.p2.1.m5.1.7.1"></times><apply id="S4.SS2.p2.1.m5.1.7.2.cmml" xref="S4.SS2.p2.1.m5.1.7.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m5.1.7.2.1.cmml" xref="S4.SS2.p2.1.m5.1.7.2">superscript</csymbol><apply id="S4.SS2.p2.1.m5.1.7.2.2.cmml" xref="S4.SS2.p2.1.m5.1.7.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m5.1.7.2.2.1.cmml" xref="S4.SS2.p2.1.m5.1.7.2">subscript</csymbol><ci id="S4.SS2.p2.1.m5.1.1.cmml" xref="S4.SS2.p2.1.m5.1.1">𝐼</ci><ci id="S4.SS2.p2.1.m5.1.2.1.cmml" xref="S4.SS2.p2.1.m5.1.2.1">𝑑</ci></apply><ci id="S4.SS2.p2.1.m5.1.3.1.2.cmml" xref="S4.SS2.p2.1.m5.1.3.1.2">𝑟</ci></apply><ci id="S4.SS2.p2.1.m5.1.5.cmml" xref="S4.SS2.p2.1.m5.1.5">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m5.1c">italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end POSTSUPERSCRIPT:start OPEN:( italic-r CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m5.1d">I_{d}^{(r)}(x)</annotation></semantics></math>. Our transfer process is represented as</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.1" class="ltx_Math" alttext="I^{(n)}(x)=\mathrm{render}(\rho^{(r)}(x),F^{(i)},\theta^{(n)})+I_{d}^{b(i,r)}(x)" display="block"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.33" xref="S4.E6.m1.1.33.cmml"><mrow id="S4.E6.m1.1.33.1" xref="S4.E6.m1.1.33.1.cmml"><msup id="S4.E6.m1.1.33.1.2" xref="S4.E6.m1.1.33.1.2.cmml"><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">I</mi><mrow id="S4.E6.m1.1.2.1" xref="S4.E6.m1.1.33.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.1.2.1.1" xref="S4.E6.m1.1.33.1.2.cmml">(</mo><mi id="S4.E6.m1.1.2.1.2" xref="S4.E6.m1.1.2.1.2.cmml">n</mi><mo stretchy="false" id="S4.E6.m1.1.2.1.3" xref="S4.E6.m1.1.33.1.2.cmml">)</mo></mrow></msup><mo id="S4.E6.m1.1.33.1.1" xref="S4.E6.m1.1.33.1.1.cmml">⁢</mo><mrow id="S4.E6.m1.1.33.1.3" xref="S4.E6.m1.1.33.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.3" xref="S4.E6.m1.1.33.1.cmml">(</mo><mi id="S4.E6.m1.1.4" xref="S4.E6.m1.1.4.cmml">x</mi><mo stretchy="false" id="S4.E6.m1.1.5" xref="S4.E6.m1.1.33.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.1.6" xref="S4.E6.m1.1.6.cmml">=</mo><mrow id="S4.E6.m1.1.33.2" xref="S4.E6.m1.1.33.2.cmml"><mrow id="S4.E6.m1.1.33.2.1" xref="S4.E6.m1.1.33.2.1.cmml"><mi id="S4.E6.m1.1.12" xref="S4.E6.m1.1.12.cmml">render</mi><mo id="S4.E6.m1.1.33.2.1.1" xref="S4.E6.m1.1.33.2.1.1.cmml">⁢</mo><mrow id="S4.E6.m1.1.33.2.1.2" xref="S4.E6.m1.1.33.2.1.2.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.13" xref="S4.E6.m1.1.33.2.1.2.1.cmml">(</mo><mrow id="S4.E6.m1.1.33.2.1.2.2" xref="S4.E6.m1.1.33.2.1.2.2.cmml"><msup id="S4.E6.m1.1.33.2.1.2.2.2" xref="S4.E6.m1.1.33.2.1.2.2.2.cmml"><mi id="S4.E6.m1.1.14" xref="S4.E6.m1.1.14.cmml">ρ</mi><mrow id="S4.E6.m1.1.15.1" xref="S4.E6.m1.1.33.2.1.2.2.2.cmml"><mo stretchy="false" id="S4.E6.m1.1.15.1.1" xref="S4.E6.m1.1.33.2.1.2.2.2.cmml">(</mo><mi id="S4.E6.m1.1.15.1.2" xref="S4.E6.m1.1.15.1.2.cmml">r</mi><mo stretchy="false" id="S4.E6.m1.1.15.1.3" xref="S4.E6.m1.1.33.2.1.2.2.2.cmml">)</mo></mrow></msup><mo id="S4.E6.m1.1.33.2.1.2.2.1" xref="S4.E6.m1.1.33.2.1.2.2.1.cmml">⁢</mo><mrow id="S4.E6.m1.1.33.2.1.2.2.3" xref="S4.E6.m1.1.33.2.1.2.2.cmml"><mo stretchy="false" id="S4.E6.m1.1.16" xref="S4.E6.m1.1.33.2.1.2.2.cmml">(</mo><mi id="S4.E6.m1.1.17" xref="S4.E6.m1.1.17.cmml">x</mi><mo stretchy="false" id="S4.E6.m1.1.18" xref="S4.E6.m1.1.33.2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.1.19" xref="S4.E6.m1.1.33.2.1.2.1.cmml">,</mo><msup id="S4.E6.m1.1.33.2.1.2.3" xref="S4.E6.m1.1.33.2.1.2.3.cmml"><mi id="S4.E6.m1.1.20" xref="S4.E6.m1.1.20.cmml">F</mi><mrow id="S4.E6.m1.1.21.1" xref="S4.E6.m1.1.33.2.1.2.3.cmml"><mo stretchy="false" id="S4.E6.m1.1.21.1.1" xref="S4.E6.m1.1.33.2.1.2.3.cmml">(</mo><mi id="S4.E6.m1.1.21.1.2" xref="S4.E6.m1.1.21.1.2.cmml">i</mi><mo stretchy="false" id="S4.E6.m1.1.21.1.3" xref="S4.E6.m1.1.33.2.1.2.3.cmml">)</mo></mrow></msup><mo id="S4.E6.m1.1.22" xref="S4.E6.m1.1.33.2.1.2.1.cmml">,</mo><msup id="S4.E6.m1.1.33.2.1.2.4" xref="S4.E6.m1.1.33.2.1.2.4.cmml"><mi id="S4.E6.m1.1.23" xref="S4.E6.m1.1.23.cmml">θ</mi><mrow id="S4.E6.m1.1.24.1" xref="S4.E6.m1.1.33.2.1.2.4.cmml"><mo stretchy="false" id="S4.E6.m1.1.24.1.1" xref="S4.E6.m1.1.33.2.1.2.4.cmml">(</mo><mi id="S4.E6.m1.1.24.1.2" xref="S4.E6.m1.1.24.1.2.cmml">n</mi><mo stretchy="false" id="S4.E6.m1.1.24.1.3" xref="S4.E6.m1.1.33.2.1.2.4.cmml">)</mo></mrow></msup><mo stretchy="false" id="S4.E6.m1.1.25" xref="S4.E6.m1.1.33.2.1.2.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.1.26" xref="S4.E6.m1.1.26.cmml">+</mo><mrow id="S4.E6.m1.1.33.2.2" xref="S4.E6.m1.1.33.2.2.cmml"><msubsup id="S4.E6.m1.1.33.2.2.2" xref="S4.E6.m1.1.33.2.2.2.cmml"><mi id="S4.E6.m1.1.27" xref="S4.E6.m1.1.27.cmml">I</mi><mi id="S4.E6.m1.1.28.1" xref="S4.E6.m1.1.28.1.cmml">d</mi><mrow id="S4.E6.m1.1.29.1" xref="S4.E6.m1.1.29.1.cmml"><mi id="S4.E6.m1.1.29.1.1" xref="S4.E6.m1.1.29.1.1.cmml">b</mi><mo id="S4.E6.m1.1.29.1.7" xref="S4.E6.m1.1.29.1.7.cmml">⁢</mo><mrow id="S4.E6.m1.1.29.1.8" xref="S4.E6.m1.1.29.1.8.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.29.1.2" xref="S4.E6.m1.1.29.1.8.1.cmml">(</mo><mi id="S4.E6.m1.1.29.1.3" xref="S4.E6.m1.1.29.1.3.cmml">i</mi><mo id="S4.E6.m1.1.29.1.4" xref="S4.E6.m1.1.29.1.8.1.cmml">,</mo><mi id="S4.E6.m1.1.29.1.5" xref="S4.E6.m1.1.29.1.5.cmml">r</mi><mo stretchy="false" id="S4.E6.m1.1.29.1.6" xref="S4.E6.m1.1.29.1.8.1.cmml">)</mo></mrow></mrow></msubsup><mo id="S4.E6.m1.1.33.2.2.1" xref="S4.E6.m1.1.33.2.2.1.cmml">⁢</mo><mrow id="S4.E6.m1.1.33.2.2.3" xref="S4.E6.m1.1.33.2.2.cmml"><mo stretchy="false" id="S4.E6.m1.1.30" xref="S4.E6.m1.1.33.2.2.cmml">(</mo><mi id="S4.E6.m1.1.31" xref="S4.E6.m1.1.31.cmml">x</mi><mo stretchy="false" id="S4.E6.m1.1.32" xref="S4.E6.m1.1.33.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.33.cmml" xref="S4.E6.m1.1.33"><eq id="S4.E6.m1.1.6.cmml" xref="S4.E6.m1.1.6"></eq><apply id="S4.E6.m1.1.33.1.cmml" xref="S4.E6.m1.1.33.1"><times id="S4.E6.m1.1.33.1.1.cmml" xref="S4.E6.m1.1.33.1.1"></times><apply id="S4.E6.m1.1.33.1.2.cmml" xref="S4.E6.m1.1.33.1.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.33.1.2.1.cmml" xref="S4.E6.m1.1.33.1.2">superscript</csymbol><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝐼</ci><ci id="S4.E6.m1.1.2.1.2.cmml" xref="S4.E6.m1.1.2.1.2">𝑛</ci></apply><ci id="S4.E6.m1.1.4.cmml" xref="S4.E6.m1.1.4">𝑥</ci></apply><apply id="S4.E6.m1.1.33.2.cmml" xref="S4.E6.m1.1.33.2"><plus id="S4.E6.m1.1.26.cmml" xref="S4.E6.m1.1.26"></plus><apply id="S4.E6.m1.1.33.2.1.cmml" xref="S4.E6.m1.1.33.2.1"><times id="S4.E6.m1.1.33.2.1.1.cmml" xref="S4.E6.m1.1.33.2.1.1"></times><ci id="S4.E6.m1.1.12.cmml" xref="S4.E6.m1.1.12">render</ci><vector id="S4.E6.m1.1.33.2.1.2.1.cmml" xref="S4.E6.m1.1.33.2.1.2"><apply id="S4.E6.m1.1.33.2.1.2.2.cmml" xref="S4.E6.m1.1.33.2.1.2.2"><times id="S4.E6.m1.1.33.2.1.2.2.1.cmml" xref="S4.E6.m1.1.33.2.1.2.2.1"></times><apply id="S4.E6.m1.1.33.2.1.2.2.2.cmml" xref="S4.E6.m1.1.33.2.1.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.33.2.1.2.2.2.1.cmml" xref="S4.E6.m1.1.33.2.1.2.2.2">superscript</csymbol><ci id="S4.E6.m1.1.14.cmml" xref="S4.E6.m1.1.14">𝜌</ci><ci id="S4.E6.m1.1.15.1.2.cmml" xref="S4.E6.m1.1.15.1.2">𝑟</ci></apply><ci id="S4.E6.m1.1.17.cmml" xref="S4.E6.m1.1.17">𝑥</ci></apply><apply id="S4.E6.m1.1.33.2.1.2.3.cmml" xref="S4.E6.m1.1.33.2.1.2.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.33.2.1.2.3.1.cmml" xref="S4.E6.m1.1.33.2.1.2.3">superscript</csymbol><ci id="S4.E6.m1.1.20.cmml" xref="S4.E6.m1.1.20">𝐹</ci><ci id="S4.E6.m1.1.21.1.2.cmml" xref="S4.E6.m1.1.21.1.2">𝑖</ci></apply><apply id="S4.E6.m1.1.33.2.1.2.4.cmml" xref="S4.E6.m1.1.33.2.1.2.4"><csymbol cd="ambiguous" id="S4.E6.m1.1.33.2.1.2.4.1.cmml" xref="S4.E6.m1.1.33.2.1.2.4">superscript</csymbol><ci id="S4.E6.m1.1.23.cmml" xref="S4.E6.m1.1.23">𝜃</ci><ci id="S4.E6.m1.1.24.1.2.cmml" xref="S4.E6.m1.1.24.1.2">𝑛</ci></apply></vector></apply><apply id="S4.E6.m1.1.33.2.2.cmml" xref="S4.E6.m1.1.33.2.2"><times id="S4.E6.m1.1.33.2.2.1.cmml" xref="S4.E6.m1.1.33.2.2.1"></times><apply id="S4.E6.m1.1.33.2.2.2.cmml" xref="S4.E6.m1.1.33.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.33.2.2.2.1.cmml" xref="S4.E6.m1.1.33.2.2.2">superscript</csymbol><apply id="S4.E6.m1.1.33.2.2.2.2.cmml" xref="S4.E6.m1.1.33.2.2.2"><csymbol cd="ambiguous" id="S4.E6.m1.1.33.2.2.2.2.1.cmml" xref="S4.E6.m1.1.33.2.2.2">subscript</csymbol><ci id="S4.E6.m1.1.27.cmml" xref="S4.E6.m1.1.27">𝐼</ci><ci id="S4.E6.m1.1.28.1.cmml" xref="S4.E6.m1.1.28.1">𝑑</ci></apply><apply id="S4.E6.m1.1.29.1.cmml" xref="S4.E6.m1.1.29.1"><times id="S4.E6.m1.1.29.1.7.cmml" xref="S4.E6.m1.1.29.1.7"></times><ci id="S4.E6.m1.1.29.1.1.cmml" xref="S4.E6.m1.1.29.1.1">𝑏</ci><interval closure="open" id="S4.E6.m1.1.29.1.8.1.cmml" xref="S4.E6.m1.1.29.1.8"><ci id="S4.E6.m1.1.29.1.3.cmml" xref="S4.E6.m1.1.29.1.3">𝑖</ci><ci id="S4.E6.m1.1.29.1.5.cmml" xref="S4.E6.m1.1.29.1.5">𝑟</ci></interval></apply></apply><ci id="S4.E6.m1.1.31.cmml" xref="S4.E6.m1.1.31">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.E6.m1.1c">italic-I POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:) RELOP:equals render OPEN:( italic-rho POSTSUPERSCRIPT:start OPEN:( italic-r CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:) PUNCT:, italic-F POSTSUPERSCRIPT:start OPEN:( italic-i CLOSE:) POSTSUPERSCRIPT:end PUNCT:, italic-theta POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end CLOSE:) ADDOP:plus italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end POSTSUPERSCRIPT:start italic-b OPEN:( italic-i PUNCT:, italic-r CLOSE:) POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.E6.m1.1d">I^{(n)}(x)=\mathrm{render}(\rho^{(r)}(x),F^{(i)},\theta^{(n)})+I_{d}^{b(i,r)}(x)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr>
</table>
<p id="S4.SS2.p2.2" class="ltx_p">where <math id="S4.SS2.p2.2.m1.1" class="ltx_Math" alttext="\theta^{(n)}" display="inline"><semantics id="S4.SS2.p2.2.m1.1a"><msup id="S4.SS2.p2.2.m1.1.3" xref="S4.SS2.p2.2.m1.1.3.cmml"><mi id="S4.SS2.p2.2.m1.1.1" xref="S4.SS2.p2.2.m1.1.1.cmml">θ</mi><mrow id="S4.SS2.p2.2.m1.1.2.1" xref="S4.SS2.p2.2.m1.1.3.cmml"><mo stretchy="false" id="S4.SS2.p2.2.m1.1.2.1.1" xref="S4.SS2.p2.2.m1.1.3.cmml">(</mo><mi id="S4.SS2.p2.2.m1.1.2.1.2" xref="S4.SS2.p2.2.m1.1.2.1.2.cmml">n</mi><mo stretchy="false" id="S4.SS2.p2.2.m1.1.2.1.3" xref="S4.SS2.p2.2.m1.1.3.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m1.1b"><apply id="S4.SS2.p2.2.m1.1.3.cmml" xref="S4.SS2.p2.2.m1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m1.1.3.1.cmml" xref="S4.SS2.p2.2.m1.1.3">superscript</csymbol><ci id="S4.SS2.p2.2.m1.1.1.cmml" xref="S4.SS2.p2.2.m1.1.1">𝜃</ci><ci id="S4.SS2.p2.2.m1.1.2.1.2.cmml" xref="S4.SS2.p2.2.m1.1.2.1.2">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m1.1c">italic-theta POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m1.1d">\theta^{(n)}</annotation></semantics></math> could be either <math id="S4.SS2.p2.2.m2.1" class="ltx_Math" alttext="\theta^{(i)}" display="inline"><semantics id="S4.SS2.p2.2.m2.1a"><msup id="S4.SS2.p2.2.m2.1.3" xref="S4.SS2.p2.2.m2.1.3.cmml"><mi id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml">θ</mi><mrow id="S4.SS2.p2.2.m2.1.2.1" xref="S4.SS2.p2.2.m2.1.3.cmml"><mo stretchy="false" id="S4.SS2.p2.2.m2.1.2.1.1" xref="S4.SS2.p2.2.m2.1.3.cmml">(</mo><mi id="S4.SS2.p2.2.m2.1.2.1.2" xref="S4.SS2.p2.2.m2.1.2.1.2.cmml">i</mi><mo stretchy="false" id="S4.SS2.p2.2.m2.1.2.1.3" xref="S4.SS2.p2.2.m2.1.3.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.3.cmml" xref="S4.SS2.p2.2.m2.1.3"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.3.1.cmml" xref="S4.SS2.p2.2.m2.1.3">superscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1">𝜃</ci><ci id="S4.SS2.p2.2.m2.1.2.1.2.cmml" xref="S4.SS2.p2.2.m2.1.2.1.2">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1c">italic-theta POSTSUPERSCRIPT:start OPEN:( italic-i CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1d">\theta^{(i)}</annotation></semantics></math> or some new illumination (for relighting).</p>
</div>
<figure id="S4.F3" class="ltx_figure"><img src="x3.png" id="S4.F3.g1" class="ltx_graphics ltx_centering" width="664" height="127" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span> A makeup transfer example, which includes albedo <math id="S4.F3.m4.1" class="ltx_Math" alttext="\rho(x)" display="inline"><semantics id="S4.F3.m4.1b"><mrow id="S4.F3.m4.1.5" xref="S4.F3.m4.1.5.cmml"><mi id="S4.F3.m4.1.1" xref="S4.F3.m4.1.1.cmml">ρ</mi><mo id="S4.F3.m4.1.5.1" xref="S4.F3.m4.1.5.1.cmml">⁢</mo><mrow id="S4.F3.m4.1.5.2" xref="S4.F3.m4.1.5.cmml"><mo stretchy="false" id="S4.F3.m4.1.2" xref="S4.F3.m4.1.5.cmml">(</mo><mi id="S4.F3.m4.1.3" xref="S4.F3.m4.1.3.cmml">x</mi><mo stretchy="false" id="S4.F3.m4.1.4" xref="S4.F3.m4.1.5.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.m4.1c"><apply id="S4.F3.m4.1.5.cmml" xref="S4.F3.m4.1.5"><times id="S4.F3.m4.1.5.1.cmml" xref="S4.F3.m4.1.5.1"></times><ci id="S4.F3.m4.1.1.cmml" xref="S4.F3.m4.1.1">𝜌</ci><ci id="S4.F3.m4.1.3.cmml" xref="S4.F3.m4.1.3">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.F3.m4.1d">italic-rho OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.F3.m4.1e">\rho(x)</annotation></semantics></math> , rendered shading <math id="S4.F3.m5.1" class="ltx_Math" alttext="\mathrm{render}(\rho(x),F,\theta)" display="inline"><semantics id="S4.F3.m5.1b"><mrow id="S4.F3.m5.1.17" xref="S4.F3.m5.1.17.cmml"><mi id="S4.F3.m5.1.6" xref="S4.F3.m5.1.6.cmml">render</mi><mo id="S4.F3.m5.1.17.1" xref="S4.F3.m5.1.17.1.cmml">⁢</mo><mrow id="S4.F3.m5.1.17.2" xref="S4.F3.m5.1.17.2.1.cmml"><mo stretchy="false" id="S4.F3.m5.1.7" xref="S4.F3.m5.1.17.2.1.cmml">(</mo><mrow id="S4.F3.m5.1.17.2.2" xref="S4.F3.m5.1.17.2.2.cmml"><mi id="S4.F3.m5.1.8" xref="S4.F3.m5.1.8.cmml">ρ</mi><mo id="S4.F3.m5.1.17.2.2.1" xref="S4.F3.m5.1.17.2.2.1.cmml">⁢</mo><mrow id="S4.F3.m5.1.17.2.2.2" xref="S4.F3.m5.1.17.2.2.cmml"><mo stretchy="false" id="S4.F3.m5.1.9" xref="S4.F3.m5.1.17.2.2.cmml">(</mo><mi id="S4.F3.m5.1.10" xref="S4.F3.m5.1.10.cmml">x</mi><mo stretchy="false" id="S4.F3.m5.1.11" xref="S4.F3.m5.1.17.2.2.cmml">)</mo></mrow></mrow><mo id="S4.F3.m5.1.12" xref="S4.F3.m5.1.17.2.1.cmml">,</mo><mi id="S4.F3.m5.1.13" xref="S4.F3.m5.1.13.cmml">F</mi><mo id="S4.F3.m5.1.14" xref="S4.F3.m5.1.17.2.1.cmml">,</mo><mi id="S4.F3.m5.1.15" xref="S4.F3.m5.1.15.cmml">θ</mi><mo stretchy="false" id="S4.F3.m5.1.16" xref="S4.F3.m5.1.17.2.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.m5.1c"><apply id="S4.F3.m5.1.17.cmml" xref="S4.F3.m5.1.17"><times id="S4.F3.m5.1.17.1.cmml" xref="S4.F3.m5.1.17.1"></times><ci id="S4.F3.m5.1.6.cmml" xref="S4.F3.m5.1.6">render</ci><vector id="S4.F3.m5.1.17.2.1.cmml" xref="S4.F3.m5.1.17.2"><apply id="S4.F3.m5.1.17.2.2.cmml" xref="S4.F3.m5.1.17.2.2"><times id="S4.F3.m5.1.17.2.2.1.cmml" xref="S4.F3.m5.1.17.2.2.1"></times><ci id="S4.F3.m5.1.8.cmml" xref="S4.F3.m5.1.8">𝜌</ci><ci id="S4.F3.m5.1.10.cmml" xref="S4.F3.m5.1.10">𝑥</ci></apply><ci id="S4.F3.m5.1.13.cmml" xref="S4.F3.m5.1.13">𝐹</ci><ci id="S4.F3.m5.1.15.cmml" xref="S4.F3.m5.1.15">𝜃</ci></vector></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.F3.m5.1d">render OPEN:( italic-rho OPEN:( italic-x CLOSE:) PUNCT:, italic-F PUNCT:, italic-theta CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.F3.m5.1e">\mathrm{render}(\rho(x),F,\theta)</annotation></semantics></math>, detail map <math id="S4.F3.m6.1" class="ltx_Math" alttext="I_{d}(x)" display="inline"><semantics id="S4.F3.m6.1b"><mrow id="S4.F3.m6.1.6" xref="S4.F3.m6.1.6.cmml"><msub id="S4.F3.m6.1.6.2" xref="S4.F3.m6.1.6.2.cmml"><mi id="S4.F3.m6.1.1" xref="S4.F3.m6.1.1.cmml">I</mi><mi id="S4.F3.m6.1.2.1" xref="S4.F3.m6.1.2.1.cmml">d</mi></msub><mo id="S4.F3.m6.1.6.1" xref="S4.F3.m6.1.6.1.cmml">⁢</mo><mrow id="S4.F3.m6.1.6.3" xref="S4.F3.m6.1.6.cmml"><mo stretchy="false" id="S4.F3.m6.1.3" xref="S4.F3.m6.1.6.cmml">(</mo><mi id="S4.F3.m6.1.4" xref="S4.F3.m6.1.4.cmml">x</mi><mo stretchy="false" id="S4.F3.m6.1.5" xref="S4.F3.m6.1.6.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.F3.m6.1c"><apply id="S4.F3.m6.1.6.cmml" xref="S4.F3.m6.1.6"><times id="S4.F3.m6.1.6.1.cmml" xref="S4.F3.m6.1.6.1"></times><apply id="S4.F3.m6.1.6.2.cmml" xref="S4.F3.m6.1.6.2"><csymbol cd="ambiguous" id="S4.F3.m6.1.6.2.1.cmml" xref="S4.F3.m6.1.6.2">subscript</csymbol><ci id="S4.F3.m6.1.1.cmml" xref="S4.F3.m6.1.1">𝐼</ci><ci id="S4.F3.m6.1.2.1.cmml" xref="S4.F3.m6.1.2.1">𝑑</ci></apply><ci id="S4.F3.m6.1.4.cmml" xref="S4.F3.m6.1.4">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.F3.m6.1d">italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end OPEN:( italic-x CLOSE:)</annotation><annotation encoding="application/x-tex" id="S4.F3.m6.1e">I_{d}(x)</annotation></semantics></math>, the masks used to blend detail maps, and results.
</figcaption>
</figure>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">Our algorithm proceeds as follows. We transfer the whole albedo layer from reference to input face. We construct a new detail map <math id="S4.SS2.p3.1.m1.1" class="ltx_Math" alttext="I_{d}^{b(i,r)}" display="inline"><semantics id="S4.SS2.p3.1.m1.1a"><msubsup id="S4.SS2.p3.1.m1.1.4" xref="S4.SS2.p3.1.m1.1.4.cmml"><mi id="S4.SS2.p3.1.m1.1.1" xref="S4.SS2.p3.1.m1.1.1.cmml">I</mi><mi id="S4.SS2.p3.1.m1.1.2.1" xref="S4.SS2.p3.1.m1.1.2.1.cmml">d</mi><mrow id="S4.SS2.p3.1.m1.1.3.1" xref="S4.SS2.p3.1.m1.1.3.1.cmml"><mi id="S4.SS2.p3.1.m1.1.3.1.1" xref="S4.SS2.p3.1.m1.1.3.1.1.cmml">b</mi><mo id="S4.SS2.p3.1.m1.1.3.1.7" xref="S4.SS2.p3.1.m1.1.3.1.7.cmml">⁢</mo><mrow id="S4.SS2.p3.1.m1.1.3.1.8" xref="S4.SS2.p3.1.m1.1.3.1.8.1.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m1.1.3.1.2" xref="S4.SS2.p3.1.m1.1.3.1.8.1.cmml">(</mo><mi id="S4.SS2.p3.1.m1.1.3.1.3" xref="S4.SS2.p3.1.m1.1.3.1.3.cmml">i</mi><mo id="S4.SS2.p3.1.m1.1.3.1.4" xref="S4.SS2.p3.1.m1.1.3.1.8.1.cmml">,</mo><mi id="S4.SS2.p3.1.m1.1.3.1.5" xref="S4.SS2.p3.1.m1.1.3.1.5.cmml">r</mi><mo stretchy="false" id="S4.SS2.p3.1.m1.1.3.1.6" xref="S4.SS2.p3.1.m1.1.3.1.8.1.cmml">)</mo></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m1.1b"><apply id="S4.SS2.p3.1.m1.1.4.cmml" xref="S4.SS2.p3.1.m1.1.4"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.4.1.cmml" xref="S4.SS2.p3.1.m1.1.4">superscript</csymbol><apply id="S4.SS2.p3.1.m1.1.4.2.cmml" xref="S4.SS2.p3.1.m1.1.4"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m1.1.4.2.1.cmml" xref="S4.SS2.p3.1.m1.1.4">subscript</csymbol><ci id="S4.SS2.p3.1.m1.1.1.cmml" xref="S4.SS2.p3.1.m1.1.1">𝐼</ci><ci id="S4.SS2.p3.1.m1.1.2.1.cmml" xref="S4.SS2.p3.1.m1.1.2.1">𝑑</ci></apply><apply id="S4.SS2.p3.1.m1.1.3.1.cmml" xref="S4.SS2.p3.1.m1.1.3.1"><times id="S4.SS2.p3.1.m1.1.3.1.7.cmml" xref="S4.SS2.p3.1.m1.1.3.1.7"></times><ci id="S4.SS2.p3.1.m1.1.3.1.1.cmml" xref="S4.SS2.p3.1.m1.1.3.1.1">𝑏</ci><interval closure="open" id="S4.SS2.p3.1.m1.1.3.1.8.1.cmml" xref="S4.SS2.p3.1.m1.1.3.1.8"><ci id="S4.SS2.p3.1.m1.1.3.1.3.cmml" xref="S4.SS2.p3.1.m1.1.3.1.3">𝑖</ci><ci id="S4.SS2.p3.1.m1.1.3.1.5.cmml" xref="S4.SS2.p3.1.m1.1.3.1.5">𝑟</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m1.1c">italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end POSTSUPERSCRIPT:start italic-b OPEN:( italic-i PUNCT:, italic-r CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m1.1d">I_{d}^{b(i,r)}</annotation></semantics></math>, which is a blending of reference and input detail maps. The blending preserves the input detail map around eyes, nose and mouth, and reference details elsewhere (Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.2 Makeup Transfer ‣ 4 Face Editing ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows our detail transfer process, and
examples of intermediate results). We then choose some illumination <math id="S4.SS2.p3.1.m2.1" class="ltx_Math" alttext="\theta^{(n)}" display="inline"><semantics id="S4.SS2.p3.1.m2.1a"><msup id="S4.SS2.p3.1.m2.1.3" xref="S4.SS2.p3.1.m2.1.3.cmml"><mi id="S4.SS2.p3.1.m2.1.1" xref="S4.SS2.p3.1.m2.1.1.cmml">θ</mi><mrow id="S4.SS2.p3.1.m2.1.2.1" xref="S4.SS2.p3.1.m2.1.3.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m2.1.2.1.1" xref="S4.SS2.p3.1.m2.1.3.cmml">(</mo><mi id="S4.SS2.p3.1.m2.1.2.1.2" xref="S4.SS2.p3.1.m2.1.2.1.2.cmml">n</mi><mo stretchy="false" id="S4.SS2.p3.1.m2.1.2.1.3" xref="S4.SS2.p3.1.m2.1.3.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m2.1b"><apply id="S4.SS2.p3.1.m2.1.3.cmml" xref="S4.SS2.p3.1.m2.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m2.1.3.1.cmml" xref="S4.SS2.p3.1.m2.1.3">superscript</csymbol><ci id="S4.SS2.p3.1.m2.1.1.cmml" xref="S4.SS2.p3.1.m2.1.1">𝜃</ci><ci id="S4.SS2.p3.1.m2.1.2.1.2.cmml" xref="S4.SS2.p3.1.m2.1.2.1.2">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m2.1c">italic-theta POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m2.1d">\theta^{(n)}</annotation></semantics></math> (which might be just the input illumination <math id="S4.SS2.p3.1.m3.1" class="ltx_Math" alttext="\theta_{s}" display="inline"><semantics id="S4.SS2.p3.1.m3.1a"><msub id="S4.SS2.p3.1.m3.1.3" xref="S4.SS2.p3.1.m3.1.3.cmml"><mi id="S4.SS2.p3.1.m3.1.1" xref="S4.SS2.p3.1.m3.1.1.cmml">θ</mi><mi id="S4.SS2.p3.1.m3.1.2.1" xref="S4.SS2.p3.1.m3.1.2.1.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m3.1b"><apply id="S4.SS2.p3.1.m3.1.3.cmml" xref="S4.SS2.p3.1.m3.1.3"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m3.1.3.1.cmml" xref="S4.SS2.p3.1.m3.1.3">subscript</csymbol><ci id="S4.SS2.p3.1.m3.1.1.cmml" xref="S4.SS2.p3.1.m3.1.1">𝜃</ci><ci id="S4.SS2.p3.1.m3.1.2.1.cmml" xref="S4.SS2.p3.1.m3.1.2.1">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m3.1c">italic-theta POSTSUBSCRIPT:start italic-s POSTSUBSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m3.1d">\theta_{s}</annotation></semantics></math>) and use Eqn. <a href="#S4.E6" title="(6) ‣ 4.2 Makeup Transfer ‣ 4 Face Editing ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> to composite. Experiment shows <math id="S4.SS2.p3.1.m4.1" class="ltx_Math" alttext="I_{d}^{b(i,r)}" display="inline"><semantics id="S4.SS2.p3.1.m4.1a"><msubsup id="S4.SS2.p3.1.m4.1.4" xref="S4.SS2.p3.1.m4.1.4.cmml"><mi id="S4.SS2.p3.1.m4.1.1" xref="S4.SS2.p3.1.m4.1.1.cmml">I</mi><mi id="S4.SS2.p3.1.m4.1.2.1" xref="S4.SS2.p3.1.m4.1.2.1.cmml">d</mi><mrow id="S4.SS2.p3.1.m4.1.3.1" xref="S4.SS2.p3.1.m4.1.3.1.cmml"><mi id="S4.SS2.p3.1.m4.1.3.1.1" xref="S4.SS2.p3.1.m4.1.3.1.1.cmml">b</mi><mo id="S4.SS2.p3.1.m4.1.3.1.7" xref="S4.SS2.p3.1.m4.1.3.1.7.cmml">⁢</mo><mrow id="S4.SS2.p3.1.m4.1.3.1.8" xref="S4.SS2.p3.1.m4.1.3.1.8.1.cmml"><mo stretchy="false" id="S4.SS2.p3.1.m4.1.3.1.2" xref="S4.SS2.p3.1.m4.1.3.1.8.1.cmml">(</mo><mi id="S4.SS2.p3.1.m4.1.3.1.3" xref="S4.SS2.p3.1.m4.1.3.1.3.cmml">i</mi><mo id="S4.SS2.p3.1.m4.1.3.1.4" xref="S4.SS2.p3.1.m4.1.3.1.8.1.cmml">,</mo><mi id="S4.SS2.p3.1.m4.1.3.1.5" xref="S4.SS2.p3.1.m4.1.3.1.5.cmml">r</mi><mo stretchy="false" id="S4.SS2.p3.1.m4.1.3.1.6" xref="S4.SS2.p3.1.m4.1.3.1.8.1.cmml">)</mo></mrow></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p3.1.m4.1b"><apply id="S4.SS2.p3.1.m4.1.4.cmml" xref="S4.SS2.p3.1.m4.1.4"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m4.1.4.1.cmml" xref="S4.SS2.p3.1.m4.1.4">superscript</csymbol><apply id="S4.SS2.p3.1.m4.1.4.2.cmml" xref="S4.SS2.p3.1.m4.1.4"><csymbol cd="ambiguous" id="S4.SS2.p3.1.m4.1.4.2.1.cmml" xref="S4.SS2.p3.1.m4.1.4">subscript</csymbol><ci id="S4.SS2.p3.1.m4.1.1.cmml" xref="S4.SS2.p3.1.m4.1.1">𝐼</ci><ci id="S4.SS2.p3.1.m4.1.2.1.cmml" xref="S4.SS2.p3.1.m4.1.2.1">𝑑</ci></apply><apply id="S4.SS2.p3.1.m4.1.3.1.cmml" xref="S4.SS2.p3.1.m4.1.3.1"><times id="S4.SS2.p3.1.m4.1.3.1.7.cmml" xref="S4.SS2.p3.1.m4.1.3.1.7"></times><ci id="S4.SS2.p3.1.m4.1.3.1.1.cmml" xref="S4.SS2.p3.1.m4.1.3.1.1">𝑏</ci><interval closure="open" id="S4.SS2.p3.1.m4.1.3.1.8.1.cmml" xref="S4.SS2.p3.1.m4.1.3.1.8"><ci id="S4.SS2.p3.1.m4.1.3.1.3.cmml" xref="S4.SS2.p3.1.m4.1.3.1.3">𝑖</ci><ci id="S4.SS2.p3.1.m4.1.3.1.5.cmml" xref="S4.SS2.p3.1.m4.1.3.1.5">𝑟</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS2.p3.1.m4.1c">italic-I POSTSUBSCRIPT:start italic-d POSTSUBSCRIPT:end POSTSUPERSCRIPT:start italic-b OPEN:( italic-i PUNCT:, italic-r CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS2.p3.1.m4.1d">I_{d}^{b(i,r)}</annotation></semantics></math> is crucial to the success of our approach. If other intrinsic image methods are used (such as Bell et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>), facial shadows
etc. will mix into albedo (rather than only in detail map), and when transfer is performed, the input face appears to have lost distrinctive facial features (Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.2 Makeup Transfer ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>) .</p>
</div>
<div id="S4.SS2.p4" class="ltx_para ltx_noindent">
<p id="S4.SS2.p4.1" class="ltx_p"><span id="S4.SS2.p4.1.1" class="ltx_text ltx_font_bold">Boundary processing:</span> Boundaries need to be processed more carefully for makeup transfer because portraits have a variety of face shapes, face sizes and hairlines,
and misclassifying hair as face will create problems. We shrink the face boundary to remove
potential hair pixels, then use mirror mapping along the boundary to expand the image (we copy a 30 pixel width ring back and forth).
Our approach is fully automatic, however, some level of user interaction could produce even better results.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Face Detail Transfer</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">This section focuses on transferring face details from a reference image <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="I^{(r)}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><msup id="S4.SS3.p1.1.m1.1.3" xref="S4.SS3.p1.1.m1.1.3.cmml"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">I</mi><mrow id="S4.SS3.p1.1.m1.1.2.1" xref="S4.SS3.p1.1.m1.1.3.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m1.1.2.1.1" xref="S4.SS3.p1.1.m1.1.3.cmml">(</mo><mi id="S4.SS3.p1.1.m1.1.2.1.2" xref="S4.SS3.p1.1.m1.1.2.1.2.cmml">r</mi><mo stretchy="false" id="S4.SS3.p1.1.m1.1.2.1.3" xref="S4.SS3.p1.1.m1.1.3.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><apply id="S4.SS3.p1.1.m1.1.3.cmml" xref="S4.SS3.p1.1.m1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m1.1.3.1.cmml" xref="S4.SS3.p1.1.m1.1.3">superscript</csymbol><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝐼</ci><ci id="S4.SS3.p1.1.m1.1.2.1.2.cmml" xref="S4.SS3.p1.1.m1.1.2.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1c">italic-I POSTSUPERSCRIPT:start OPEN:( italic-r CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1d">I^{(r)}</annotation></semantics></math> to an input image <math id="S4.SS3.p1.1.m2.1" class="ltx_Math" alttext="I^{(i)}" display="inline"><semantics id="S4.SS3.p1.1.m2.1a"><msup id="S4.SS3.p1.1.m2.1.3" xref="S4.SS3.p1.1.m2.1.3.cmml"><mi id="S4.SS3.p1.1.m2.1.1" xref="S4.SS3.p1.1.m2.1.1.cmml">I</mi><mrow id="S4.SS3.p1.1.m2.1.2.1" xref="S4.SS3.p1.1.m2.1.3.cmml"><mo stretchy="false" id="S4.SS3.p1.1.m2.1.2.1.1" xref="S4.SS3.p1.1.m2.1.3.cmml">(</mo><mi id="S4.SS3.p1.1.m2.1.2.1.2" xref="S4.SS3.p1.1.m2.1.2.1.2.cmml">i</mi><mo stretchy="false" id="S4.SS3.p1.1.m2.1.2.1.3" xref="S4.SS3.p1.1.m2.1.3.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m2.1b"><apply id="S4.SS3.p1.1.m2.1.3.cmml" xref="S4.SS3.p1.1.m2.1.3"><csymbol cd="ambiguous" id="S4.SS3.p1.1.m2.1.3.1.cmml" xref="S4.SS3.p1.1.m2.1.3">superscript</csymbol><ci id="S4.SS3.p1.1.m2.1.1.cmml" xref="S4.SS3.p1.1.m2.1.1">𝐼</ci><ci id="S4.SS3.p1.1.m2.1.2.1.2.cmml" xref="S4.SS3.p1.1.m2.1.2.1.2">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m2.1c">italic-I POSTSUPERSCRIPT:start OPEN:( italic-i CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m2.1d">I^{(i)}</annotation></semantics></math>, while preserving the general lighting of the input photograph. Different parts of the face have different material properties and fine-scale geometric variation. We account for this by transferring the detail map in nine standard components: left eyebrow, right eyebrow, left eye, right eye, forehead, nose, mouth, left cheek and right cheek. We can preserve the base face shape, and edit face details by transfering one component to all components.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.1" class="ltx_p">In order to transfer detail maps between <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="I^{(r)}" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><msup id="S4.SS3.p2.1.m1.1.3" xref="S4.SS3.p2.1.m1.1.3.cmml"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">I</mi><mrow id="S4.SS3.p2.1.m1.1.2.1" xref="S4.SS3.p2.1.m1.1.3.cmml"><mo stretchy="false" id="S4.SS3.p2.1.m1.1.2.1.1" xref="S4.SS3.p2.1.m1.1.3.cmml">(</mo><mi id="S4.SS3.p2.1.m1.1.2.1.2" xref="S4.SS3.p2.1.m1.1.2.1.2.cmml">r</mi><mo stretchy="false" id="S4.SS3.p2.1.m1.1.2.1.3" xref="S4.SS3.p2.1.m1.1.3.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><apply id="S4.SS3.p2.1.m1.1.3.cmml" xref="S4.SS3.p2.1.m1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m1.1.3.1.cmml" xref="S4.SS3.p2.1.m1.1.3">superscript</csymbol><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝐼</ci><ci id="S4.SS3.p2.1.m1.1.2.1.2.cmml" xref="S4.SS3.p2.1.m1.1.2.1.2">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m1.1c">italic-I POSTSUPERSCRIPT:start OPEN:( italic-r CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1d">I^{(r)}</annotation></semantics></math> and <math id="S4.SS3.p2.1.m2.1" class="ltx_Math" alttext="I^{(i)}" display="inline"><semantics id="S4.SS3.p2.1.m2.1a"><msup id="S4.SS3.p2.1.m2.1.3" xref="S4.SS3.p2.1.m2.1.3.cmml"><mi id="S4.SS3.p2.1.m2.1.1" xref="S4.SS3.p2.1.m2.1.1.cmml">I</mi><mrow id="S4.SS3.p2.1.m2.1.2.1" xref="S4.SS3.p2.1.m2.1.3.cmml"><mo stretchy="false" id="S4.SS3.p2.1.m2.1.2.1.1" xref="S4.SS3.p2.1.m2.1.3.cmml">(</mo><mi id="S4.SS3.p2.1.m2.1.2.1.2" xref="S4.SS3.p2.1.m2.1.2.1.2.cmml">i</mi><mo stretchy="false" id="S4.SS3.p2.1.m2.1.2.1.3" xref="S4.SS3.p2.1.m2.1.3.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m2.1b"><apply id="S4.SS3.p2.1.m2.1.3.cmml" xref="S4.SS3.p2.1.m2.1.3"><csymbol cd="ambiguous" id="S4.SS3.p2.1.m2.1.3.1.cmml" xref="S4.SS3.p2.1.m2.1.3">superscript</csymbol><ci id="S4.SS3.p2.1.m2.1.1.cmml" xref="S4.SS3.p2.1.m2.1.1">𝐼</ci><ci id="S4.SS3.p2.1.m2.1.2.1.2.cmml" xref="S4.SS3.p2.1.m2.1.2.1.2">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S4.SS3.p2.1.m2.1c">italic-I POSTSUPERSCRIPT:start OPEN:( italic-i CLOSE:) POSTSUPERSCRIPT:end</annotation><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m2.1d">I^{(i)}</annotation></semantics></math>, we need pixel-accurate alignment between two images. We already have an initial alignment in the form of the aligned morphable face model. In some cases, there might still be some small misalignments, and we fine tune the detail map alignment with optical flow based warping <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>.
Makeup transfer also takes this approach to improve correspondence.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para">
<p id="S4.SS3.p3.1" class="ltx_p">A Figure in the supplementary materials shows an example of a shiny nose (caused by specular highlights) being transferred from one source image to a variety of target faces. The alignment and warping ensure that this transfer produces reasonably realistic results.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering" width="674" height="193" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S4.F4.3" class="ltx_text ltx_font_bold">First Row:</span> Baseline rendering methods compared to ours. Removing detail maps produces overly smooth faces, and using multiplicative details loses
detail in dark or bright areas. <span id="S4.F4.4" class="ltx_text ltx_font_bold">Second Row:</span> This figure compares harsh light relighting and detail transfer results for the average face and our methods. The
average face leads to obvious failures especially when lighting is harsh or the face has a strong expression.</figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Results</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">For all face edits, we evaluate our methods qualitatively by direct image comparisons.
Previous work has mostly evaluated qualitatively, but Wang et al. report face recognition rates for face relighting <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. These do
not directly evaluate whether our results convince humans. We therefore evaluate quantitatively with a user study for face relighting
and detail transfer. For makeup transfer, we use an online attractiveness evaluation system to quantitatively evaluate how much we can make people look more attractive.
All the results in this paper are best viewed at high resolution. Please refer to the supplementary materials for more examples and comparisons.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Relighting</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We compare our method to various baselines in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.3 Face Detail Transfer ‣ 4 Face Editing ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and in the supplementary materials.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para ltx_noindent">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">Average Face: </span> We register the average face mesh to the image, but all other steps in our system
remain unchanged, allowing us to evaluate the importance of our morphable face model. This baseline performs
poorly, because not morphing the geometry leads to poor registration of nose and mouth (Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.3 Face Detail Transfer ‣ 4 Face Editing ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>).</p>
</div>
<div id="S5.SS1.p3" class="ltx_para ltx_noindent">
<p id="S5.SS1.p3.1" class="ltx_p"><span id="S5.SS1.p3.1.1" class="ltx_text ltx_font_bold">No Detail Map: </span> When the detail map is not applied, the results have too little spatial detail. This is due to
our approximate (and overly smooth) geometry, albedo, and shading estimates.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para ltx_noindent">
<p id="S5.SS1.p4.1" class="ltx_p"><span id="S5.SS1.p4.1.1" class="ltx_text ltx_font_bold">Multiplicative Detail (Shading Ratio): </span> A natural variant of our method is to compute a
multiplicative detail map, rendering the new image as</p>
<table id="S5.E7" class="ltx_equation ltx_eqn_table">

<tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S5.E7.m1.1" class="ltx_Math" alttext="I^{n}(x)=I(x)\frac{\mathrm{render}(\rho(x),F,\theta^{(n)})}{\mathrm{render}(%
\rho(x),F,\theta_{s})}" display="block"><semantics id="S5.E7.m1.1a"><mrow id="S5.E7.m1.1.12" xref="S5.E7.m1.1.12.cmml"><mrow id="S5.E7.m1.1.12.1" xref="S5.E7.m1.1.12.1.cmml"><msup id="S5.E7.m1.1.12.1.2" xref="S5.E7.m1.1.12.1.2.cmml"><mi id="S5.E7.m1.1.1" xref="S5.E7.m1.1.1.cmml">I</mi><mi id="S5.E7.m1.1.2.1" xref="S5.E7.m1.1.2.1.cmml">n</mi></msup><mo id="S5.E7.m1.1.12.1.1" xref="S5.E7.m1.1.12.1.1.cmml">⁢</mo><mrow id="S5.E7.m1.1.12.1.3" xref="S5.E7.m1.1.12.1.cmml"><mo stretchy="false" id="S5.E7.m1.1.3" xref="S5.E7.m1.1.12.1.cmml">(</mo><mi id="S5.E7.m1.1.4" xref="S5.E7.m1.1.4.cmml">x</mi><mo stretchy="false" id="S5.E7.m1.1.5" xref="S5.E7.m1.1.12.1.cmml">)</mo></mrow></mrow><mo id="S5.E7.m1.1.6" xref="S5.E7.m1.1.6.cmml">=</mo><mrow id="S5.E7.m1.1.12.2" xref="S5.E7.m1.1.12.2.cmml"><mi id="S5.E7.m1.1.7" xref="S5.E7.m1.1.7.cmml">I</mi><mo id="S5.E7.m1.1.12.2.1" xref="S5.E7.m1.1.12.2.1.cmml">⁢</mo><mrow id="S5.E7.m1.1.12.2.2" xref="S5.E7.m1.1.12.2.cmml"><mo stretchy="false" id="S5.E7.m1.1.8" xref="S5.E7.m1.1.12.2.cmml">(</mo><mi id="S5.E7.m1.1.9" xref="S5.E7.m1.1.9.cmml">x</mi><mo stretchy="false" id="S5.E7.m1.1.10" xref="S5.E7.m1.1.12.2.cmml">)</mo></mrow><mo id="S5.E7.m1.1.12.2.1a" xref="S5.E7.m1.1.12.2.1.cmml">⁢</mo><mfrac id="S5.E7.m1.1.11" xref="S5.E7.m1.1.11.cmml"><mrow id="S5.E7.m1.1.11.2" xref="S5.E7.m1.1.11.2.cmml"><mi id="S5.E7.m1.1.11.2.6" xref="S5.E7.m1.1.11.2.6.cmml">render</mi><mo id="S5.E7.m1.1.11.2.18" xref="S5.E7.m1.1.11.2.18.cmml">⁢</mo><mrow id="S5.E7.m1.1.11.2.19" xref="S5.E7.m1.1.11.2.19.1.cmml"><mo stretchy="false" id="S5.E7.m1.1.11.2.7" xref="S5.E7.m1.1.11.2.19.1.cmml">(</mo><mrow id="S5.E7.m1.1.11.2.19.2" xref="S5.E7.m1.1.11.2.19.2.cmml"><mi id="S5.E7.m1.1.11.2.8" xref="S5.E7.m1.1.11.2.8.cmml">ρ</mi><mo id="S5.E7.m1.1.11.2.19.2.1" xref="S5.E7.m1.1.11.2.19.2.1.cmml">⁢</mo><mrow id="S5.E7.m1.1.11.2.19.2.2" xref="S5.E7.m1.1.11.2.19.2.cmml"><mo stretchy="false" id="S5.E7.m1.1.11.2.9" xref="S5.E7.m1.1.11.2.19.2.cmml">(</mo><mi id="S5.E7.m1.1.11.2.10" xref="S5.E7.m1.1.11.2.10.cmml">x</mi><mo stretchy="false" id="S5.E7.m1.1.11.2.11" xref="S5.E7.m1.1.11.2.19.2.cmml">)</mo></mrow></mrow><mo id="S5.E7.m1.1.11.2.12" xref="S5.E7.m1.1.11.2.19.1.cmml">,</mo><mi id="S5.E7.m1.1.11.2.13" xref="S5.E7.m1.1.11.2.13.cmml">F</mi><mo id="S5.E7.m1.1.11.2.14" xref="S5.E7.m1.1.11.2.19.1.cmml">,</mo><msup id="S5.E7.m1.1.11.2.19.3" xref="S5.E7.m1.1.11.2.19.3.cmml"><mi id="S5.E7.m1.1.11.2.15" xref="S5.E7.m1.1.11.2.15.cmml">θ</mi><mrow id="S5.E7.m1.1.11.2.16.1" xref="S5.E7.m1.1.11.2.19.3.cmml"><mo stretchy="false" id="S5.E7.m1.1.11.2.16.1.1" xref="S5.E7.m1.1.11.2.19.3.cmml">(</mo><mi id="S5.E7.m1.1.11.2.16.1.2" xref="S5.E7.m1.1.11.2.16.1.2.cmml">n</mi><mo stretchy="false" id="S5.E7.m1.1.11.2.16.1.3" xref="S5.E7.m1.1.11.2.19.3.cmml">)</mo></mrow></msup><mo stretchy="false" id="S5.E7.m1.1.11.2.17" xref="S5.E7.m1.1.11.2.19.1.cmml">)</mo></mrow></mrow><mrow id="S5.E7.m1.1.11.3" xref="S5.E7.m1.1.11.3.cmml"><mi id="S5.E7.m1.1.11.3.6" xref="S5.E7.m1.1.11.3.6.cmml">render</mi><mo id="S5.E7.m1.1.11.3.18" xref="S5.E7.m1.1.11.3.18.cmml">⁢</mo><mrow id="S5.E7.m1.1.11.3.19" xref="S5.E7.m1.1.11.3.19.1.cmml"><mo stretchy="false" id="S5.E7.m1.1.11.3.7" xref="S5.E7.m1.1.11.3.19.1.cmml">(</mo><mrow id="S5.E7.m1.1.11.3.19.2" xref="S5.E7.m1.1.11.3.19.2.cmml"><mi id="S5.E7.m1.1.11.3.8" xref="S5.E7.m1.1.11.3.8.cmml">ρ</mi><mo id="S5.E7.m1.1.11.3.19.2.1" xref="S5.E7.m1.1.11.3.19.2.1.cmml">⁢</mo><mrow id="S5.E7.m1.1.11.3.19.2.2" xref="S5.E7.m1.1.11.3.19.2.cmml"><mo stretchy="false" id="S5.E7.m1.1.11.3.9" xref="S5.E7.m1.1.11.3.19.2.cmml">(</mo><mi id="S5.E7.m1.1.11.3.10" xref="S5.E7.m1.1.11.3.10.cmml">x</mi><mo stretchy="false" id="S5.E7.m1.1.11.3.11" xref="S5.E7.m1.1.11.3.19.2.cmml">)</mo></mrow></mrow><mo id="S5.E7.m1.1.11.3.12" xref="S5.E7.m1.1.11.3.19.1.cmml">,</mo><mi id="S5.E7.m1.1.11.3.13" xref="S5.E7.m1.1.11.3.13.cmml">F</mi><mo id="S5.E7.m1.1.11.3.14" xref="S5.E7.m1.1.11.3.19.1.cmml">,</mo><msub id="S5.E7.m1.1.11.3.19.3" xref="S5.E7.m1.1.11.3.19.3.cmml"><mi id="S5.E7.m1.1.11.3.15" xref="S5.E7.m1.1.11.3.15.cmml">θ</mi><mi id="S5.E7.m1.1.11.3.16.1" xref="S5.E7.m1.1.11.3.16.1.cmml">s</mi></msub><mo stretchy="false" id="S5.E7.m1.1.11.3.17" xref="S5.E7.m1.1.11.3.19.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.E7.m1.1b"><apply id="S5.E7.m1.1.12.cmml" xref="S5.E7.m1.1.12"><eq id="S5.E7.m1.1.6.cmml" xref="S5.E7.m1.1.6"></eq><apply id="S5.E7.m1.1.12.1.cmml" xref="S5.E7.m1.1.12.1"><times id="S5.E7.m1.1.12.1.1.cmml" xref="S5.E7.m1.1.12.1.1"></times><apply id="S5.E7.m1.1.12.1.2.cmml" xref="S5.E7.m1.1.12.1.2"><csymbol cd="ambiguous" id="S5.E7.m1.1.12.1.2.1.cmml" xref="S5.E7.m1.1.12.1.2">superscript</csymbol><ci id="S5.E7.m1.1.1.cmml" xref="S5.E7.m1.1.1">𝐼</ci><ci id="S5.E7.m1.1.2.1.cmml" xref="S5.E7.m1.1.2.1">𝑛</ci></apply><ci id="S5.E7.m1.1.4.cmml" xref="S5.E7.m1.1.4">𝑥</ci></apply><apply id="S5.E7.m1.1.12.2.cmml" xref="S5.E7.m1.1.12.2"><times id="S5.E7.m1.1.12.2.1.cmml" xref="S5.E7.m1.1.12.2.1"></times><ci id="S5.E7.m1.1.7.cmml" xref="S5.E7.m1.1.7">𝐼</ci><ci id="S5.E7.m1.1.9.cmml" xref="S5.E7.m1.1.9">𝑥</ci><apply id="S5.E7.m1.1.11.cmml" xref="S5.E7.m1.1.11"><divide id="S5.E7.m1.1.11.1.cmml" xref="S5.E7.m1.1.11"></divide><apply id="S5.E7.m1.1.11.2.cmml" xref="S5.E7.m1.1.11.2"><times id="S5.E7.m1.1.11.2.18.cmml" xref="S5.E7.m1.1.11.2.18"></times><ci id="S5.E7.m1.1.11.2.6.cmml" xref="S5.E7.m1.1.11.2.6">render</ci><vector id="S5.E7.m1.1.11.2.19.1.cmml" xref="S5.E7.m1.1.11.2.19"><apply id="S5.E7.m1.1.11.2.19.2.cmml" xref="S5.E7.m1.1.11.2.19.2"><times id="S5.E7.m1.1.11.2.19.2.1.cmml" xref="S5.E7.m1.1.11.2.19.2.1"></times><ci id="S5.E7.m1.1.11.2.8.cmml" xref="S5.E7.m1.1.11.2.8">𝜌</ci><ci id="S5.E7.m1.1.11.2.10.cmml" xref="S5.E7.m1.1.11.2.10">𝑥</ci></apply><ci id="S5.E7.m1.1.11.2.13.cmml" xref="S5.E7.m1.1.11.2.13">𝐹</ci><apply id="S5.E7.m1.1.11.2.19.3.cmml" xref="S5.E7.m1.1.11.2.19.3"><csymbol cd="ambiguous" id="S5.E7.m1.1.11.2.19.3.1.cmml" xref="S5.E7.m1.1.11.2.19.3">superscript</csymbol><ci id="S5.E7.m1.1.11.2.15.cmml" xref="S5.E7.m1.1.11.2.15">𝜃</ci><ci id="S5.E7.m1.1.11.2.16.1.2.cmml" xref="S5.E7.m1.1.11.2.16.1.2">𝑛</ci></apply></vector></apply><apply id="S5.E7.m1.1.11.3.cmml" xref="S5.E7.m1.1.11.3"><times id="S5.E7.m1.1.11.3.18.cmml" xref="S5.E7.m1.1.11.3.18"></times><ci id="S5.E7.m1.1.11.3.6.cmml" xref="S5.E7.m1.1.11.3.6">render</ci><vector id="S5.E7.m1.1.11.3.19.1.cmml" xref="S5.E7.m1.1.11.3.19"><apply id="S5.E7.m1.1.11.3.19.2.cmml" xref="S5.E7.m1.1.11.3.19.2"><times id="S5.E7.m1.1.11.3.19.2.1.cmml" xref="S5.E7.m1.1.11.3.19.2.1"></times><ci id="S5.E7.m1.1.11.3.8.cmml" xref="S5.E7.m1.1.11.3.8">𝜌</ci><ci id="S5.E7.m1.1.11.3.10.cmml" xref="S5.E7.m1.1.11.3.10">𝑥</ci></apply><ci id="S5.E7.m1.1.11.3.13.cmml" xref="S5.E7.m1.1.11.3.13">𝐹</ci><apply id="S5.E7.m1.1.11.3.19.3.cmml" xref="S5.E7.m1.1.11.3.19.3"><csymbol cd="ambiguous" id="S5.E7.m1.1.11.3.19.3.1.cmml" xref="S5.E7.m1.1.11.3.19.3">subscript</csymbol><ci id="S5.E7.m1.1.11.3.15.cmml" xref="S5.E7.m1.1.11.3.15">𝜃</ci><ci id="S5.E7.m1.1.11.3.16.1.cmml" xref="S5.E7.m1.1.11.3.16.1">𝑠</ci></apply></vector></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S5.E7.m1.1c">italic-I POSTSUPERSCRIPT:start italic-n POSTSUPERSCRIPT:end OPEN:( italic-x CLOSE:) RELOP:equals italic-I OPEN:( italic-x CLOSE:) FRACOP:italic-divide ARG:start render OPEN:( italic-rho OPEN:( italic-x CLOSE:) PUNCT:, italic-F PUNCT:, italic-theta POSTSUPERSCRIPT:start OPEN:( italic-n CLOSE:) POSTSUPERSCRIPT:end CLOSE:) ARG:end ARG:start render OPEN:( italic-rho OPEN:( italic-x CLOSE:) PUNCT:, italic-F PUNCT:, italic-theta POSTSUBSCRIPT:start italic-s POSTSUBSCRIPT:end CLOSE:) ARG:end</annotation><annotation encoding="application/x-tex" id="S5.E7.m1.1d">I^{n}(x)=I(x)\frac{\mathrm{render}(\rho(x),F,\theta^{(n)})}{\mathrm{render}(%
\rho(x),F,\theta_{s})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr>
</table>
<p id="S5.SS1.p4.2" class="ltx_p">and so allowing a comparison with a form of ratio image construction. As Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.3 Face Detail Transfer ‣ 4 Face Editing ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows,
this approach creates odd-looking materials and fails frequently, especially in areas where the ratio is large or small.</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="x5.png" id="S5.F5.g1" class="ltx_graphics ltx_centering" width="467" height="183" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>A qualitative relighting comparison between our method and Chen et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> for one source image and two different targets. In each case,
A comes from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> (lighting transfer). B is our result with a
manual choice of spherical harmonic light to match target lighting, and C is our method with manually choice of directional light to match target lighting.</figcaption>
</figure>
<figure id="S5.F6" class="ltx_figure"><img src="x6.png" id="S5.F6.g1" class="ltx_graphics ltx_centering" width="676" height="171" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Face relighting. Each example shows the original image, our results with minor/major changes to lighting, a result from Portrait Pro 15, and our addition of spot lights. Best viewed at high resolution in color.</figcaption>
</figure>
<div id="S5.SS1.p5" class="ltx_para ltx_noindent">
<p id="S5.SS1.p5.1" class="ltx_p"><span id="S5.SS1.p5.1.1" class="ltx_text ltx_font_bold">Portrait Pro 15: </span> It is the best available software for face relighting, but allows only minor
changes in lighting before suffering from significant artifacts.</p>
</div>
<div id="S5.SS1.p6" class="ltx_para ltx_noindent">
<p id="S5.SS1.p6.1" class="ltx_p"><span id="S5.SS1.p6.1.1" class="ltx_text ltx_font_bold">Our relighting</span>
We have designed an interface to interactively edit spherical harmonics lights, directional lights and spot lights. We
relight images using: (a) minor changes to spherical harmonic lighting; (b) significant changes to spherical harmonic
lighting; and (c) introducing spotlights. In Fig. <a href="#S5.F6" title="Figure 6 ‣ 5.1 Relighting ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, we compare our results with the commercial software Portrait Pro 15.
Even small lighting changes can cause the Portrait Pro 15 results to have noticeable artifacts; facial skin often
appears unnatural. In contrast, even complex lighting edits produced with our method still look natural. This is because our detail map preserves
perceived material properties of skin. We also compare qualitatively with a recent lighting transfer
method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, see Fig. <a href="#S5.F5" title="Figure 5 ‣ 5.1 Relighting ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>. Quantitative comparisons show in the user study.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Makeup Transfer</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">Our makeup transfer is fully automatic, and works well on both normal makeup and unusual (wild) makeup. We evaluate results qualitatively by
faithfulness (does the input face still look like themself?), realism (does the input face look like they are wearing real makeup?) and predictability
(does the makeup on the input look like the makeup on the reference?).
For normal makeup, we can compare with previous methods qualitatively; for wild makeup, there are no previous methods.
We evaluate quantitatively by investigating the effect of makeup on online services that predict age and attractiveness from face images.
Fig. <a href="#S5.F7" title="Figure 7 ‣ 5.2 Makeup Transfer ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> shows makeup transfer of one reference to multiple inputs (to evaluate predictability) and
from multiple references to one input (to evaluate faithfulness). It also shows we can transfer makeup across gender.</p>
</div>
<figure id="S5.F7" class="ltx_figure"><img src="x7.png" id="S5.F7.g1" class="ltx_graphics ltx_centering" width="632" height="314" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Our makeup transfer results for various situations: same gender, across gender, from multiple references to one input,
and from one reference to multiple inputs. </figcaption>
</figure>
<div id="S5.SS2.p2" class="ltx_para ltx_noindent">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">Different intrinsic images:</span> Fig. <a href="#S5.F8" title="Figure 8 ‣ 5.2 Makeup Transfer ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> shows the effect of using a different intrinsic image method
(a state-of-the-art method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>). Bell et al.’s method allocates small shadows to the albedo map, resulting in dark lips and nose
region in both reference and input’s albedo map. As a result, these shadows are missing from the detail map, so the transferred image result
from Bell’s method keeps some of the reference’s facial structure (the shape of the input’s mouth, the shadows in the input’s nostrils,
and the shape at the end of the input’s nose). Video contains more intrinsic image comparisons.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para ltx_noindent">
<p id="S5.SS2.p3.1" class="ltx_p"><span id="S5.SS2.p3.1.1" class="ltx_text ltx_font_bold">Comparisons:</span> Fig. <a href="#S5.F9" title="Figure 9 ‣ 5.2 Makeup Transfer ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> shows a comparison to recent methods with normal light makeup.
Shih et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> is generally successful, but loses eye makeup, and the skin around cheek is a little unnatural.
Their result also suffers ringing artifacts at nostrils, chin and around the eyes. Earlier methods (Tong et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> and Guo et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>)
are less successful. These methods are not likely to work with stronger makeup and wild makeup, and they also don’t support multiple face editing operations.
The supplementary material contains more results and further comparisons with other methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, etc.</p>
</div>
<figure id="S5.F8" class="ltx_figure"><img src="x8.png" id="S5.F8.g1" class="ltx_graphics ltx_centering" width="668" height="136" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>The albedo produced by Bell et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> method, compared with that produced by our
method. Their method retains some face detail in the
albedo map (small shadows around nostril and lips); as a result, in
the transferred image, the shape of the input’s nostrils and mouth in the
transfer “look like” those features in the
reference. The effect is further explored in the video submission.</figcaption>
</figure>
<figure id="S5.F9" class="ltx_figure"><img src="x9.png" id="S5.F9.g1" class="ltx_graphics ltx_centering" width="664" height="127" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>A comparison to the methods of Shih et al., Tong et al., and Guo et al. Our face
reference points were adjusted by hand to give the best results (Shih et al. allow manual
adjustment of reference points and masks). Results of Tong et al. and Guo et al. are far
behind and even don’t get the makeup color right. The skin of Shih et al’s result looks fake, especially around cheek.
There are ringing artifacts at chin, left eyelid and nose in their result, and their eye makeup
is lost during transfer. Our results looks more natural, eye makeup is preserved, and our method is numerically stable, so
does not have numerical artifacts. <span id="S5.F9.2" class="ltx_text ltx_font_italic">Best viewed at high resolution, in color.</span>
</figcaption>
</figure>
<figure id="S5.T1" class="ltx_table">
<div id="S5.T1.1" class="ltx_block ltx_align_center" style="width:281.9pt;vertical-align:-0.0pt;">
<table id="S5.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.1.1" class="ltx_td ltx_align_justify ltx_th ltx_th_column ltx_border_l ltx_border_r ltx_border_t" style="width:42.7pt;"></th>
<th id="S5.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">Normal Makeup</th>
<th id="S5.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="2">Wild Makeup</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.1" class="ltx_td ltx_align_justify ltx_border_l ltx_border_r ltx_border_t" style="width:42.7pt;"></td>
<td id="S5.T1.1.1.2.2" class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" style="width:56.9pt;"> Age (year)</td>
<td id="S5.T1.1.1.2.3" class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" style="width:71.1pt;">Attractive (1-6)</td>
<td id="S5.T1.1.1.2.4" class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" style="width:56.9pt;"> Age (year)</td>
<td id="S5.T1.1.1.2.5" class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" style="width:71.1pt;">Attractive (1-6)</td>
</tr>
<tr id="S5.T1.1.1.3" class="ltx_tr">
<td id="S5.T1.1.1.3.1" class="ltx_td ltx_align_justify ltx_border_l ltx_border_r ltx_border_t" style="width:42.7pt;">Men</td>
<td id="S5.T1.1.1.3.2" class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" style="width:56.9pt;">  -3.8</td>
<td id="S5.T1.1.1.3.3" class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" style="width:71.1pt;">  0.6</td>
<td id="S5.T1.1.1.3.4" class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" style="width:56.9pt;">  -1.6</td>
<td id="S5.T1.1.1.3.5" class="ltx_td ltx_align_justify ltx_border_r ltx_border_t" style="width:71.1pt;">  -0.2</td>
</tr>
<tr id="S5.T1.1.1.4" class="ltx_tr">
<td id="S5.T1.1.1.4.1" class="ltx_td ltx_align_justify ltx_border_b ltx_border_l ltx_border_r ltx_border_t" style="width:42.7pt;">Women</td>
<td id="S5.T1.1.1.4.2" class="ltx_td ltx_align_justify ltx_border_b ltx_border_r ltx_border_t" style="width:56.9pt;">  -2.3</td>
<td id="S5.T1.1.1.4.3" class="ltx_td ltx_align_justify ltx_border_b ltx_border_r ltx_border_t" style="width:71.1pt;">  1.5</td>
<td id="S5.T1.1.1.4.4" class="ltx_td ltx_align_justify ltx_border_b ltx_border_r ltx_border_t" style="width:56.9pt;">  -1.6</td>
<td id="S5.T1.1.1.4.5" class="ltx_td ltx_align_justify ltx_border_b ltx_border_r ltx_border_t" style="width:71.1pt;">  0</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Age and attractive score change after applying our makeup transfer algorithm. Age change is in years, men with normal makeup looks 3.8 years younger;
attractiveness has discrete values range from 1 (least) to 6 (most), women with normal makeup look 1.5 levels more attractive. We care about the best improvement
for each person using a small number of references. The number in the table is the average of the best
improvement. Detailed table see supplementary materials.</figcaption>
</figure>
<div id="S5.SS2.p4" class="ltx_para ltx_noindent">
<p id="S5.SS2.p4.1" class="ltx_p"><span id="S5.SS2.p4.1.1" class="ltx_text ltx_font_bold">Makeup and attractiveness:</span>
Several websites predict age and attractiveness for a face image; we use http://howhot.io, which predicts age and evaluates attractiveness
from 1 (least) to 6 (most). Table <a href="#S5.T1" title="Table 1 ‣ 5.2 Makeup Transfer ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the results, and detailed table
is in supplementary materials. Transfer of naturalistic makeup tends to make a person look younger and more attractive; while wild makeup’s effects depend
on images, and on average lower the attractiveness score. Our approach quite reliably yields a substantial, automatic improvement in attractiveness score
by allowing an input to search a small set of references for the transfer that yields the best improvement.
We anticipate building a simple app that allows users to manipulate their photo profiles.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Detail Transfer</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">Our method can transfer face details like skin material attributes, wrinkles, scars, small facial expressions and even the shape of nose and mouth, while
retaining the original geometric model of the face. Fig. <a href="#S5.F10" title="Figure 10 ‣ 5.3 Detail Transfer ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> shows detail transfer for areas of the face, and entire faces.
By grouping and using attributes of source images, we can reasonably control the detail transfer process, see supplementary materials. In comparison
to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, which offers users the ability to interactively edit face material attributes, our method offers a non-parametric transfer of
a face region or whole face, see Fig. <a href="#S5.F11" title="Figure 11 ‣ 5.3 Detail Transfer ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a>.</p>
</div>
<figure id="S5.F10" class="ltx_figure"><img src="x10.png" id="S5.F10.g1" class="ltx_graphics ltx_centering" width="672" height="170" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>We show results of combining relighting with detail transfer either in one of nine regions or the entire face, more examples and marked transfer regions are available
in supplementary materials. </figcaption>
</figure>
<figure id="S5.F11" class="ltx_figure"><img src="x11.png" id="S5.F11.g1" class="ltx_graphics ltx_centering" width="675" height="91" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span> Each example shows a series of detail map transfers using our methods, illustrating how these
transfers change the material attributes of skin. The original image in the second example
comes from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, who also edits material attributes by per image interaction (rather than
non-parametric transfer). Comparable images appear in that paper, and are duplicated in the supplementary
materials. Supplementary materials also contain our reference images and more examples. </figcaption>
</figure>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>User Study</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">Relighting methods do not admit comparisons with ground truth images (we do not have ground truth; the model is never
physically correct; and the key issue is whether the error is discernible to users). We
performed a user study to see how natural our results are. Users are presented with two images, and
must decide which of two images has not been edited. We use the error rate in this task
to judge the method; a <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><mrow id="S5.SS4.p1.1.m1.1.4" xref="S5.SS4.p1.1.m1.1.4.cmml"><mn id="S5.SS4.p1.1.m1.1.2" xref="S5.SS4.p1.1.m1.1.2.cmml">50</mn><mo id="S5.SS4.p1.1.m1.1.3" xref="S5.SS4.p1.1.m1.1.3.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><apply id="S5.SS4.p1.1.m1.1.4.cmml" xref="S5.SS4.p1.1.m1.1.4"><csymbol cd="latexml" id="S5.SS4.p1.1.m1.1.3.cmml" xref="S5.SS4.p1.1.m1.1.3">percent</csymbol><cn type="integer" id="S5.SS4.p1.1.m1.1.2.cmml" xref="S5.SS4.p1.1.m1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-llamapun" id="S5.SS4.p1.1.m1.1c">NUMBER:50 POSTFIX:percent</annotation><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1d">50\%</annotation></semantics></math> error rate means the method fools users perfectly.
To make our comparison fair, we mask the unedited image when the edited image is masked.
This likely confuses users and somewhat overestimates the effectiveness of these methods.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<div id="S5.T2.1" class="ltx_block ltx_align_center" style="width:216.8pt;vertical-align:-0.0pt;">
<table id="S5.T2.1.1" class="ltx_tabular ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.1.1.1" class="ltx_tr">
<td id="S5.T2.1.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Group</td>
<td id="S5.T2.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Methods</td>
<td id="S5.T2.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Skilled</td>
<td id="S5.T2.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Crowd Source</td>
</tr>
<tr id="S5.T2.1.1.2" class="ltx_tr">
<td id="S5.T2.1.1.2.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S5.T2.1.1.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Our Minor Light</td>
<td id="S5.T2.1.1.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">39.3%</td>
<td id="S5.T2.1.1.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">48.9 %</td>
</tr>
<tr id="S5.T2.1.1.3" class="ltx_tr">
<td id="S5.T2.1.1.3.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S5.T2.1.1.3.2" class="ltx_td ltx_align_center ltx_border_r">Our Major Light</td>
<td id="S5.T2.1.1.3.3" class="ltx_td ltx_align_center ltx_border_r">26.2%</td>
<td id="S5.T2.1.1.3.4" class="ltx_td ltx_align_center ltx_border_r">44.1%</td>
</tr>
<tr id="S5.T2.1.1.4" class="ltx_tr">
<td id="S5.T2.1.1.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">Main</td>
<td id="S5.T2.1.1.4.2" class="ltx_td ltx_align_center ltx_border_r">Our Transfer</td>
<td id="S5.T2.1.1.4.3" class="ltx_td ltx_align_center ltx_border_r">46.9%</td>
<td id="S5.T2.1.1.4.4" class="ltx_td ltx_align_center ltx_border_r">47.1%</td>
</tr>
<tr id="S5.T2.1.1.5" class="ltx_tr">
<td id="S5.T2.1.1.5.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S5.T2.1.1.5.2" class="ltx_td ltx_align_center ltx_border_r">Our Light + Detail</td>
<td id="S5.T2.1.1.5.3" class="ltx_td ltx_align_center ltx_border_r">33.1%</td>
<td id="S5.T2.1.1.5.4" class="ltx_td ltx_align_center ltx_border_r">37.6%</td>
</tr>
<tr id="S5.T2.1.1.6" class="ltx_tr">
<td id="S5.T2.1.1.6.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S5.T2.1.1.6.2" class="ltx_td ltx_align_center ltx_border_r">Our Average</td>
<td id="S5.T2.1.1.6.3" class="ltx_td ltx_align_center ltx_border_r">36.4%</td>
<td id="S5.T2.1.1.6.4" class="ltx_td ltx_align_center ltx_border_r">44.4%</td>
</tr>
<tr id="S5.T2.1.1.7" class="ltx_tr">
<td id="S5.T2.1.1.7.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S5.T2.1.1.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Average Face Relight</td>
<td id="S5.T2.1.1.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">13.8%</td>
<td id="S5.T2.1.1.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">43.7%</td>
</tr>
<tr id="S5.T2.1.1.8" class="ltx_tr">
<td id="S5.T2.1.1.8.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">Ablation</td>
<td id="S5.T2.1.1.8.2" class="ltx_td ltx_align_center ltx_border_r">Average Face Transfer</td>
<td id="S5.T2.1.1.8.3" class="ltx_td ltx_align_center ltx_border_r">13.8%</td>
<td id="S5.T2.1.1.8.4" class="ltx_td ltx_align_center ltx_border_r">8.0%</td>
</tr>
<tr id="S5.T2.1.1.9" class="ltx_tr">
<td id="S5.T2.1.1.9.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S5.T2.1.1.9.2" class="ltx_td ltx_align_center ltx_border_r">No Detail Map</td>
<td id="S5.T2.1.1.9.3" class="ltx_td ltx_align_center ltx_border_r">3.5%</td>
<td id="S5.T2.1.1.9.4" class="ltx_td ltx_align_center ltx_border_r">9.7%</td>
</tr>
<tr id="S5.T2.1.1.10" class="ltx_tr">
<td id="S5.T2.1.1.10.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S5.T2.1.1.10.2" class="ltx_td ltx_align_center ltx_border_r">Multiplicative Detail</td>
<td id="S5.T2.1.1.10.3" class="ltx_td ltx_align_center ltx_border_r">3.5%</td>
<td id="S5.T2.1.1.10.4" class="ltx_td ltx_align_center ltx_border_r">10.5%</td>
</tr>
<tr id="S5.T2.1.1.11" class="ltx_tr">
<td id="S5.T2.1.1.11.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S5.T2.1.1.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Chen 11 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>
</td>
<td id="S5.T2.1.1.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">19.0%</td>
<td id="S5.T2.1.1.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">20.0%</td>
</tr>
<tr id="S5.T2.1.1.12" class="ltx_tr">
<td id="S5.T2.1.1.12.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">Baseline</td>
<td id="S5.T2.1.1.12.2" class="ltx_td ltx_align_center ltx_border_r">Wang 09 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>
</td>
<td id="S5.T2.1.1.12.3" class="ltx_td ltx_align_center ltx_border_r">22.4%</td>
<td id="S5.T2.1.1.12.4" class="ltx_td ltx_align_center ltx_border_r">14.7%</td>
</tr>
<tr id="S5.T2.1.1.13" class="ltx_tr">
<td id="S5.T2.1.1.13.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S5.T2.1.1.13.2" class="ltx_td ltx_align_center ltx_border_r">Chen 10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>
</td>
<td id="S5.T2.1.1.13.3" class="ltx_td ltx_align_center ltx_border_r">19.0%</td>
<td id="S5.T2.1.1.13.4" class="ltx_td ltx_align_center ltx_border_r">10.6%</td>
</tr>
<tr id="S5.T2.1.1.14" class="ltx_tr">
<td id="S5.T2.1.1.14.1" class="ltx_td ltx_border_l ltx_border_r"></td>
<td id="S5.T2.1.1.14.2" class="ltx_td ltx_align_center ltx_border_r">Portrait Pro 15</td>
<td id="S5.T2.1.1.14.3" class="ltx_td ltx_align_center ltx_border_r">25.9%</td>
<td id="S5.T2.1.1.14.4" class="ltx_td ltx_align_center ltx_border_r">32.3%</td>
</tr>
<tr id="S5.T2.1.1.15" class="ltx_tr">
<td id="S5.T2.1.1.15.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">Objects(graphics)</td>
<td id="S5.T2.1.1.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Karsch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>
</td>
<td id="S5.T2.1.1.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2">35.5%</td>
</tr>
<tr id="S5.T2.1.1.16" class="ltx_tr">
<td id="S5.T2.1.1.16.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t">Objects(real)</td>
<td id="S5.T2.1.1.16.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t">Liao <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>
</td>
<td id="S5.T2.1.1.16.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" colspan="2">44.0%</td>
</tr>
</tbody>
</table>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Error rates for our user study, higher is better, see Sec. <a href="#S5.SS4" title="5.4 User Study ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a>.</figcaption>
</figure>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">There are two groups of users. Group 1 has 29 people with some image editing background, and each finished all tasks.
Group 2 has around 100 people and is crowdsourced (CrowdFlower); we assume these are naive users.
The error rates are listed in Table <a href="#S5.T2" title="Table 2 ‣ 5.4 User Study ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. In each case of:
minor change; major change; detail transfer; relight and detail transfer, we have five image pairs and we average the
error rate over image pairs and users. For the comparison
methods (listed in Sec. <a href="#S5.SS1" title="5.1 Relighting ‣ 5 Results ‣ A Visual Representation for Editing Face Images" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.1</span></a>), we have two image pairs for each task. Tasks are presented in random
order. For all the image pairs in the user
study, refer to our supplementary materials. For reference, we supply error rates for object relighting methods
of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Despite reasonable concerns about uncanny valley effects, our methods can produce error rates
that match or exceed theirs.</p>
</div>
<div id="S5.SS4.p3" class="ltx_para">
<p id="S5.SS4.p3.1" class="ltx_p">Our study supports the conclusions: 1) users attended to tasks, because the error rate for some tasks is low; 2) both our detail transfer and
relighting methods have high error rates, meaning our method produces results people can not distinguish from natural
images; 3) it’s important to use morphable models and detail maps, because the error rate drops in the absence of either
strategy; 4) the multiplicative detail map (or shading ratio) works poorly; 5) methods that mask faces solve an easier task
(because they need not relight hair, ears, neck and background) but still fool users less often than our method; 6) Portrait Pro 15 is
relatively effective, but cannot change lighting much (supplementary materials); 7) unlike the experience
of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, skilled users significantly outperform naive users, but can still be fooled by our method at
useful rates.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We propose a visual representation for face editing that combines an approximate shading model based on coarse estimates of geometry, albedo, and lighting, with a non-parametric face detail map that captures deviations like non-Lambertian reflectance, complex shading, fine-scale albedo and geometry variations. Our model can be used to solve multiple tasks: relight faces by changing the lighting parameters, transfer makeup by transferring albedo and blending detail maps, and edit face details by only transferring detail maps.
We present a quantitative evaluation of makeup transfer by tracking the age and attractiveness from an online evaluation system. Results show that we can reasonably make people look
younger and more attractive by our makeup transfer.
We also present the first quantitative perceptual evaluation of face relighting and detail editing via a user study; this study shows that, to a large extent, our method produces results that users are unable to distinguish from real images. Our approach creates state of the art results on multiple face editing tasks, and in the future, we
would like to model the face detail map more thoroughly and extend this work to more face editing applications and also applications in other fields, such as building appearance editing, etc.</p>
</div>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Appendix</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.1" class="ltx_p">Refer to our support materials on project website for additional results and explanations.</p>
</div>
<figure id="S7.F12" class="ltx_figure"><img src="x12.png" id="S7.F12.g1" class="ltx_graphics ltx_centering" width="472" height="729" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12: </span>Relighting Table. Relighting the image according to several lighting conditions. Each row is one subject, each column is one lighting condition. </figcaption>
</figure>
<figure id="S7.F13" class="ltx_figure"><img src="x13.png" id="S7.F13.g1" class="ltx_graphics ltx_centering" width="671" height="235" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13: </span>Relighted makeup transfers from reference (lower right inset)
image to input (lower left inset) image, for both genders
<span id="S7.F13.2" class="ltx_text ltx_font_italic">Best viewed at high resolution, in color.</span> Further examples.
</figcaption>
</figure>
<figure id="S7.F14" class="ltx_figure"><img src="x14.png" id="S7.F14.g1" class="ltx_graphics ltx_centering" width="664" height="216" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14: </span> Across gender transfers are usually successful.
<span id="S7.F14.2" class="ltx_text ltx_font_italic">Best viewed at high resolution, in color.</span> Further examples.
</figcaption>
</figure>
<figure id="S7.F15" class="ltx_figure"><img src="x15.png" id="S7.F15.g1" class="ltx_graphics ltx_centering" width="667" height="133" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15: </span> One reference transferred to multiple inputs. The
input retains their face shape, but appears to wear the reference’s
makeup.
<span id="S7.F15.2" class="ltx_text ltx_font_italic">Best viewed at high resolution, in color.</span> Further examples.
</figcaption>
</figure>
<figure id="S7.F16" class="ltx_figure"><img src="x16.png" id="S7.F16.g1" class="ltx_graphics ltx_centering" width="669" height="141" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16: </span> Multiple references transferred to one input. The
input retains their face shape, but appears to wear the reference’s
makeup.
<span id="S7.F16.2" class="ltx_text ltx_font_italic">Best viewed at high resolution, in color.</span> Further examples. </figcaption>
</figure>
<figure id="S7.F17" class="ltx_figure"><img src="x17.png" id="S7.F17.g1" class="ltx_graphics ltx_centering" width="664" height="377" alt="">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 17: </span>Transfer Table. We transfer all of the nine parts of the face detail map (full transfer) from the subjects in the detail source row (first row) to the subjects in the orginal
column (first column). Each row is one subject, and each column shares the same face detail map from the detail source person in that column. We grouped the transfer effects into
skin property change, shininess change, geometry change and combined change. </figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Bell, S., Bala, K., Snavely, N.: Intrinsic images in the wild. ACM Trans. on
Graphics (SIGGRAPH) 33(4) (2014)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Bitouk, D., Kumar, N., Dhillon, S., Belhumeur, P., Nayar, S.K.: Face swapping:
automatically replacing faces in photographs. TOG 27(3),  39 (2008)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Blanz, V., Vetter, T.: A morphable model for the synthesis of 3D faces. In:
SIGGRAPH. pp. 187–194. ACM (1999)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Boyadzhiev, I., Bala, K., Paris, S., Adelson, E.: Band-sifting decomposition
for image-based material editing. ACM Trans. Graph. (2015)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Cao, C., Weng, Y., Zhou, S., Tong, Y., Zhou, K.: Facewarehouse: A 3d facial
expression database for visual computing. IEEE Transactions on Visualization
and Computer Graphics 20(3), 413–425 (Mar 2014),
<a href="http://dx.doi.org/10.1109/TVCG.2013.249" title="" class="ltx_ref">http://dx.doi.org/10.1109/TVCG.2013.249</a>

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Chai, M., Luo, L., Sunkavalli, K., Carr, N., Hadap, S., Zhou, K.: High-quality
hair modeling from a single portrait photo. ACM Trans. Graph. 34(6),
204:1–204:10 (Oct 2015)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Chen, J., Su, G., He, J., Ben, S.: Face image relighting using locally
constrained global optimization. In: ECCV, pp. 44–57. Springer (2010)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Chen, X., Chen, M., Jin, X., Zha, Q.: Face illumination transfer through
edge-preserving filters. CVPR, IEEE Computer Society pp. 281–287 (2011)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Guo, D., Sim, T.: Digital face makeup by example. In: CVPR 2009

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Jimenez, J., Sundstedt, V., Gutierrez, D.: Screen-space perceptual rendering of
human skin. ACM Transactions on Applied Perception 6(4), 23:1–23:15 (2009)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Karsch, K., Sunkavalli, K., Hadap, S., Carr, N., Jin, H., Fonte, R., Sittig,
M., Forsyth, D.: Automatic scene inference for 3d object compositing. ACM
Trans. Graph. 33(3) (June 2014)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Kemelmacher-Shlizerman, I., Suwajanakorn, S., Seitz, S.M.: Illumination-aware
age progression. CVPR (2014)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Land, E.H., John, Mccann, J.: Lightness and retinex theory. Journal of the
Optical Society of America pp. 1–11 (1971)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Levin, A., Lischinski, D., Weiss, Y.: A closed-form solution to natural image
matting. TPAMI 30(2) (2008)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Li, C., Zhou, K., Lin, S.: Simulating makeup through physics-based manipulation
of intrinsic image layers. CVPR (2015)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Li, Q., Yin, W., Deng, Z.: Image-based face illumination transferring using
logarithmic total variation models. The visual computer 26(1), 41–49
(2010)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Liang, L., Jin, L., Li, X.: Facial skin beautification using adaptive
region-aware masks. Cybernetics, IEEE Transactions on 44(12), 2600–2612
(2014)

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Liao, Z., Karsch, K., Forsyth, D.: An approximate shading model for object
relighting. CVPR (2015)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Liao, Z., Rock, J., Wang, Y., Forsyth, D.: Non-parametric filtering for
geometric detail extraction and material representation. In: CVPR. pp.
963–970. IEEE (2013)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Liu, C.: Beyond pixels: Exploring new representations and applications for
motion analysis. Doctoral Thesis. Massachusetts Institute of Technology (May
2009)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Liu, L., Xing, J., Liu, S., Xu, H., Zhou, X., Yan, S.: Wow! you are so
beautiful today! TOMM 11(1s),  20 (2014)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Liu, S., Liu, L., Yan, S.: Fashion analysis: Current techniques and future
directions. MultiMedia, IEEE 21(2), 72–79 (2014)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Liu, Z., Shan, Y., Zhang, Z.: Expressive expression mapping with ratio images.
In: Proceedings of the 28th annual conference on Computer graphics and
interactive techniques. pp. 271–276. ACM (2001)

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Marschner, S.R., Greenberg, D.P.: Inverse lighting for photography. In: Color
and Imaging Conference. vol. 1997, pp. 262–265. Society for Imaging Science
and Technology (1997)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Peers, P., Tamura, N., Matusik, W., Debevec, P.: Post-production facial
performance relighting using reflectance transfer. ACM Transactions on
Graphics (TOG) 26(3),  52 (2007)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Pont, S.C.: Material–illumination ambiguities and the perception of solid
objects. Perception 35(10), 1331 (2006)

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Ramamoorthi, R., Hanrahan, P.: An efficient representation for irradiance
environment maps. SIGGRAPH 2001

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Saragih, J., McDonald, K.: Facetracker.
<a href="https://github.com/kylemcdonald/FaceTracker" title="" class="ltx_ref">https://github.com/kylemcdonald/FaceTracker</a>

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Scherbaum, K., Ritschel, T., Hullin, M., Thormählen, T., Blanz, V., Seidel,
H.P.: Computer-suggested facial makeup. In: CGF. vol. 30, pp. 485–492. Wiley
Online Library (2011)

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Shashua, A., Riklin-Raviv, T.: The quotient image: Class-based re-rendering and
recognition with varying illuminations. Pattern Analysis and Machine
Intelligence, IEEE Transactions on 23(2), 129–139 (2001)

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Shih, Y., Paris, S., Barnes, C., Freeman, W.T., Durand, F.: Style transfer for
headshot portraits. ACM Trans. Graph. (2014)

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Stoschek, A.: Image-based re-rendering of faces for continuous pose and
illumination directions. In: Computer Vision and Pattern Recognition, 2000.
Proceedings. IEEE Conference on. vol. 1, pp. 582–587. IEEE (2000)

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Tong, W.S., Tang, C.K., Brown, M.S., Xu, Y.Q.: Example-based cosmetic transfer.
In: PG’07. pp. 211–218. IEEE (2007)

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Wang, Y., Liu, Z., Hua, G., Wen, Z., Zhang, Z., Samaras, D.: Face re-lighting
from a single image under harsh lighting conditions. In: CVPR. pp. 1–8. IEEE
(2007)

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Wang, Y., Zhang, L., Liu, Z., Hua, G., Wen, Z., Zhang, Z., Samaras, D.: Face
relighting from a single image under arbitrary unknown lighting conditions.
Pattern Analysis and Machine Intelligence, IEEE Transactions on 31(11),
1968–1984 (2009)

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Wen, Z., Liu, Z., Huang, T.S.: Face relighting with radiance environment maps.
In: CVPR 2003. vol. 2, pp. II–158. IEEE (2003)

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Yang, F., Wang, J., Shechtman, E., Bourdev, L., Metaxas, D.: Expression flow
for 3d-aware face component transfer. TOG 30(4),  60 (2011)

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Jul  1 18:52:39 2019 by <a href="http://dlmf.nist.gov/LaTeXML/">LaTeXML <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="[LOGO]"></a>
</div></footer>
</div>
</body>
</html>
